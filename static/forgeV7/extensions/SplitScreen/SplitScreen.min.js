/*!
 * LMV v7.1.1
 * 
 * Copyright 2019 Autodesk, Inc.
 * All rights reserved.
 * 
 * This computer source code and related instructions and comments are the
 * unpublished confidential and proprietary information of Autodesk, Inc.
 * and are protected under Federal copyright and state trade secret law.
 * They may not be disclosed to, copied or used by any third party without
 * the prior written consent of Autodesk, Inc.
 * 
 * Autodesk Forge Viewer Usage Limitations:
 * 
 * The Autodesk Forge viewer can only be used to view files generated by
 * Autodesk Forge services. The Autodesk Forge Viewer JavaScript must be
 * delivered from an Autodesk hosted URL.
 */
Autodesk.Extensions.SplitScreen=function(e){var t={};function i(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,o){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(o,r,function(t){return e[t]}.bind(null,r));return o},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=372)}({372:function(e,t,i){"use strict";i.r(t);var o="SplitScreen_RightGroundShadowMaterial";i.d(t,"SplitScreenExtension",function(){return r});AutodeskNamespace("Autodesk.Extensions.SplitScreen");function r(e,t){Autodesk.Viewing.Extension.call(this,e,t),this.options=t||{}}var n=r.prototype;function s(e,t,i){Math.abs(i-t);return Math.abs(e-t)>Math.abs(e-i)&&(e-=(i-t)/2),e=2*e-t}n.load=function(){var e=this;this.enabled=!0;var t=this.viewer.impl.renderer();if(this.context=new function(e,t){var i=function(){return!0},o=this,r=(new THREE.Color).setRGB(0,0,0);this.context=e,this.settings=this.context.settings,this._viewports=[i,i],Object.defineProperty(this,"modelFilterLeft",{enumerable:!0,get:function(){return this._viewports[0]},set:function(e){this._viewports[0]=e||i}}),Object.defineProperty(this,"modelFilterRight",{enumerable:!0,get:function(){return this._viewports[1]},set:function(e){this._viewports[1]=e||i}}),this.width=t.impl.canvas.clientWidth,this.height=t.impl.canvas.clientHeight,this.renderer=t.impl.glrenderer(),function(e){function t(t){return function(){return e[t].apply(e,arguments)}}for(var i in e)"function"==typeof e[i]&&(o[i]=t(i))}(this.context),this.renderScenePart=function(e){this.renderer.enableViewportOnOffscreenTargets(!0);var t=this.width/2,i=o._viewports.length>2?this.height/2:this.height,r=o._viewports.length>2?i:0,n=o._viewports.map(function(t){return t(e.modelId)});n[0]&&(this.renderer.setViewport(0,r,t,i),this.context.renderScenePart.apply(this.context,arguments)),n[1]&&(this.renderer.setViewport(t,r,t,i),this.context.renderScenePart.apply(this.context,arguments)),n[2]&&(this.renderer.setViewport(0,0,t,i),this.context.renderScenePart.apply(this.context,arguments)),n[3]&&(this.renderer.setViewport(t,0,t,i),this.context.renderScenePart.apply(this.context,arguments)),this.renderer.setViewport(0,0,this.width,this.height),this.renderer.enableViewportOnOffscreenTargets(!1)},this.isolateSelectionMeshes=function(e,t){var i=e.selection,o=i&&i.scene;if(!o)return[];for(var r=[],n=0;n<o.children.length;n++){var s=o.children[n];s instanceof THREE.Mesh&&s.visible&&t&&s.model&&!t(s.model.id)&&(s.visible=!1,r.push(s))}return r},this.setMeshesVisible=function(e){for(var t=0;t<e.length;t++)e[t].visible=!0},this.renderOverlays=function(e,t){var i,n=this.width/2,s=o._viewports.length>2?this.height/2:this.height,h=o._viewports.length>2?s:0,l=this.context.getNamedTarget("overlay"),a=!1;for(var d in e)if(e[d].scene.children.length){a=!0;break}a&&(this.renderer.setClearColor(r,0),this.renderer.clearTarget(l,!0,!1,!1)),this.renderer.enableViewportOnOffscreenTargets(!0),i=this.isolateSelectionMeshes(e,o._viewports[0]),this.renderer.setViewport(0,h,n,s),this.context.renderOverlays(e,t,!0),this.setMeshesVisible(i),i=this.isolateSelectionMeshes(e,o._viewports[1]),this.renderer.setViewport(n,h,n,s),this.context.renderOverlays(e,t,!0),this.setMeshesVisible(i),o._viewports.length>=3&&(i=this.isolateSelectionMeshes(e,o._viewports[2]),this.renderer.setViewport(0,0,n,s),this.context.renderOverlays(e,t,!0),this.setMeshesVisible(i)),o._viewports.length>=4&&(i=this.isolateSelectionMeshes(e,o._viewports[3]),this.renderer.setViewport(n,0,n,s),this.context.renderOverlays(e,t,!0),this.setMeshesVisible(i)),this.renderer.setViewport(0,0,this.width,this.height),this.renderer.enableViewportOnOffscreenTargets(!1)},this.setSize=function(e,t,i){this.width=e,this.height=t,this.context.setSize(e,t,i)},this.setViewports=function(e){if((e=e.slice(0,4).map(function(e){return e||i})).length<2){var o=e.length;e.length=2,e.fill(i,o)}this._viewports=e,t.resize()},this.addViewport=function(e){e=e||i,this._viewports.length<4&&(this._viewports.push(e),t.resize())},this.removeViewport=function(e){this._viewports.length<=2||e>=this._viewports.length||e<0||(this._viewports.splice(e,1),t.resize())},this.getViewports=function(){return this._viewports.slice(0)},this.getNumberOfViewports=function(){return this._viewports.length}}(t,this.viewer),this.viewer.impl.setUserRenderContext(this.context,!0),this.groundShadow=new function(){this.attach=function(e){this.renderer=e.impl.glrenderer(),this.leftShadow=e.impl.setUserGroundShadow(this),this.rightShadow=new Autodesk.Viewing.Private.GroundShadow(this.renderer),e.impl.getMaterials().addMaterialNonHDR(o,this.rightShadow.getDepthMaterial()),this.rightShadow.enabled=this.leftShadow.enabled,this.rightShadow.setColor(this.leftShadow.getColor()),this.rightShadow.setAlpha(this.leftShadow.getAlpha()),e.impl.sceneUpdated()},this.detach=function(e){e.impl.getMaterials().removeNonHDRMaterial(o),e.impl.setUserGroundShadow(this.leftShadow),e.impl.sceneUpdated()},this.createForward=function(e){this[e]=function(){return this.leftShadow[e].apply(this.leftShadow,arguments),this.rightShadow[e].apply(this.rightShadow,arguments)}.bind(this)};var e=["setTransform","setDirty","prepareGroundShadow","getStatus","clear","setColor","setAlpha"];for(var t in e)this.createForward(e[t]);Object.defineProperty(this,"enabled",{get:function(){return this.leftShadow.enabled},set:function(e){this.leftShadow.enabled=e,this.rightShadow.enabled=e}}),Object.defineProperty(this,"rendered",{get:function(){return this.leftShadow.rendered},set:function(e){this.leftShadow.rendered=e,this.rightShadow.rendered=e}}),this.renderShadow=function(e,t){var i=e.clientWidth,o=e.clientHeight;this.renderer.setViewport(0,0,i,o),this.leftShadow.renderShadow(e,t),this.renderer.setViewport(i,0,i,o),this.rightShadow.renderShadow(e,t)}},this.groundShadow.attach(this.viewer),this.patchRayCast(),this.patchCoordinateConversions(),this.viewer.getExtension("Autodesk.DefaultTools.NavTools"))this.patchWorldUp();else{this.viewer.addEventListener(Autodesk.Viewing.EXTENSION_LOADED_EVENT,function t(i){"Autodesk.DefaultTools.NavTools"===i.extensionId&&(e.patchWorldUp(),e.viewer.removeEventListener(Autodesk.Viewing.EXTENSION_LOADED_EVENT,t))})}return this.collectControlsToHide(),this.onToolbarButtonsUpdated=function(){e.hideIncompatibleControls(!0)},this.viewer.addEventListener(Autodesk.Viewing.NAVIGATION_MODE_CHANGED_EVENT,this.onToolbarButtonsUpdated),this.handleResize=function(){var t=e.viewer.canvas.clientWidth,i=e.viewer.canvas.clientHeight,o=e.viewer.impl.camera;o.clientWidth=t,o.clientHeight=i,o.aspect=t/i,e.enabled&&(o.clientWidth/=2,e.context.getNumberOfViewports()>2?o.clientHeight/=2:o.aspect/=2),e.onToolbarButtonsUpdated()},this.viewer.addEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT,this.handleResize),this.handleResize(),this.options.viewports?this.context.setViewports(this.options.viewports):(this.options.modelFilterLeft||this.options.modelFilterRight)&&(this.context.modelFilterLeft=this.options.modelFilterLeft,this.context.modelFilterRight=this.options.modelFilterRight),!0},n.mapCoords=function(e,t,i,o,r,n){var h=0,l=this.context.getNumberOfViewports();return l>=2&&(h=Math.abs(e-i)<Math.abs(e-o)?0:1,e=s(e,i,o)),l>=3&&(h+=Math.abs(t-r)<Math.abs(t-n)?0:2,t=s(t,n,r)),{x:e,y:t,viewportId:h}},n.hideIncompatibleControls=function(e){for(var t=0;t<this.controlsToHide.length;t++){var i=this.controlsToHide[t],o=e?"none":i.originalValue;i.control.setDisplay(o)}},n.collectControl=function(e){e&&this.controlsToHide.push({control:e,originalValue:e.container.style.display})},n.collectControlsToHide=function(){this.controlsToHide=[];var e=this.viewer.modelTools;this.collectControl(e.measurementToolbarButton),this.collectControl(e.getControl("toolbar-sectionTool")),this.collectControl(this.viewer.navTools.getControl("toolbar-zoomTools"))},n.patchRayCast=function(){this.castRayViewport=this.viewer.impl.castRayViewport.bind(this.viewer.impl);var e=function(){return!1},t=this;new THREE.Vector3;this.viewer.impl.castRayViewport=function(i,o,r,n,s){var h=t.viewer.impl.modelQueue().getModels().map(function(e){return e.id}),l=t.context.getViewports()[i.viewportId||0];return h=h.filter(l||e),t.castRayViewport(i,o,r,h,s)}},n.unpatchRayCast=function(){this.viewer.impl.castRayViewport=this.castRayViewport},n.patchCoordinateConversions=function(){var e=this;this.clientToViewport=this.viewer.impl.clientToViewport.bind(this.viewer.impl),this.screenToViewport=this.viewer.navigation.screenToViewport.bind(this.viewer.navigation),this.viewportToScreen=this.viewer.navigation.viewportToScreen.bind(this.viewer.navigation),this.rolloverObjectViewport=this.viewer.impl.rolloverObjectViewport.bind(this.viewer.impl),this.viewer.impl.clientToViewport=function(t,i){var o=e.clientToViewport(t,i),r=e.mapCoords(o.x,o.y,-1,1,1,-1);return o.x=r.x,o.y=r.y,o.viewportId=r.viewportId,o},this.viewer.navigation.screenToViewport=function(t,i){var o=e.mapCoords(t,i,0,1,0,1),r=e.screenToViewport(o.x,o.y);return r.viewportId=o.viewportId,r},this.viewer.navigation.viewportToScreen=function(t,i){var o=e.viewportToScreen(t,i);return o.x/=2,e.context.getNumberOfViewports()>2&&(o.y/=2),o},this.viewer.impl.rolloverObjectViewport=function(t){var i=new THREE.Vector3;return i.copy(t),i.x+=1,i.x/=2,i.x-=t.viewportId%2==0?1:0,e.context.getNumberOfViewports()>2&&(i.y+=1,i.y/=2,i.y-=t.viewportId>1?1:0),e.rolloverObjectViewport(i)}},n.unpatchCoordinateConversions=function(){this.viewer.impl.clientToViewport=this.clientToViewport,this.viewer.navigation.screenToViewport=this.screenToViewport,this.viewer.navigation.viewportToScreen=this.viewportToScreen,this.viewer.impl.rolloverObjectViewport=this.rolloverObjectViewport},n.patchWorldUp=function(){if(this.worldUpTool=this.viewer.toolController.getTool("worldup"),this.worldUpTool){this.worldUpHandleMouseMove=this.worldUpTool.handleMouseMove.bind(this.worldUpTool),this.worldUpHandleButtonDown=this.worldUpTool.handleButtonDown.bind(this.worldUpTool),this.worldUpHandleButtonUp=this.worldUpTool.handleButtonUp.bind(this.worldUpTool);var e=this,t=null;this.worldUpTool.handleButtonDown=function(i){var o=i.normalizedX,r=i.normalizedY,n=e.mapCoords(o,r,-1,1,1,-1);i.normalizedX=n.x,i.normalizedY=n.y,t=n.viewportId;n=e.worldUpHandleButtonDown(i);return i.normalizedX=o,i.normalizedY=r,n},this.worldUpTool.handleMouseMove=i(this.worldUpHandleMouseMove),this.worldUpTool.handleButtonUp=i(this.worldUpHandleButtonUp)}else console.warn("Failed to patch the world up tool");function i(i){return function(o){var r=o.normalizedX,n=o.normalizedY,s=e.mapCoords(r,n,-1,1,1,-1);t%2!=s.viewportId%2&&(s.x+=2*(s.viewportId%2-t%2)),t>1!=s.viewportId>1&&(s.y+=s.viewportId>1?-2:2),o.normalizedX=s.x,o.normalizedY=s.y;s=i(o);return o.normalizedX=r,o.normalizedY=n,s}}},n.unpatchWorldUp=function(){this.worldUpHandleMouseMove&&(this.worldUpTool.handleMouseMove=this.worldUpHandleMouseMove,this.worldUpHandleMouseMove=null),this.worldUpHandleButtonDown&&(this.worldUpTool.handleButtonDown=this.worldUpHandleButtonDown,this.worldUpHandleButtonDown=null),this.worldUpHandleButtonUp&&(this.worldUpTool.handleButtonUp=this.worldUpHandleButtonUp,this.worldUpHandleButtonUp=null)},n.unload=function(){this.viewer.impl.setUserRenderContext(this.context.context,!0),this.groundShadow.detach(this.viewer),this.unpatchRayCast(),this.unpatchCoordinateConversions(),this.unpatchWorldUp(),this.enabled=!1,this.handleResize(),this.viewer.removeEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT,this.handleResize),this.hideIncompatibleControls(!1),this.viewer.removeEventListener(Autodesk.Viewing.NAVIGATION_MODE_CHANGED_EVENT,this.onToolbarButtonsUpdated)},Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.SplitScreen",r)}});
//# sourceMappingURL=SplitScreen.min.js.map