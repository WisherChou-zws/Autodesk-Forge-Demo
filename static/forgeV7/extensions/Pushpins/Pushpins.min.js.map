{"version":3,"sources":["webpack://Autodesk.Extensions.[name]/webpack/bootstrap","webpack://Autodesk.Extensions.[name]/./node_modules/css-loader/lib/css-base.js","webpack://Autodesk.Extensions.[name]/./node_modules/style-loader/lib/addStyles.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPinExtension.css?a0cb","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPinExtension.css","webpack://Autodesk.Extensions.[name]/./node_modules/style-loader/lib/urls.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPinEvents.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPins3D/PushPinViewerState.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPinConstants.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPinItem.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPinUtils.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPinManager.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPinLabel/HTMLPushPinLabel.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPinLabel/PushPinBillboardLabel.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPins2D/PushPinBillboardTool2D.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPinInputHandler.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPins2D/RenderHandler2D.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPins3D/PushPinBillboardTool3D.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPins3D/RenderHandler3D.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPinTools.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPinUi/PushPinVisButtonBase.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPinUi/IssuePushPinVisButton.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPinUi/RfiPushPinVisButton.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPinUi/QualityIssuePushPinVisButton.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPinObserver.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPinLegacyFallback.js","webpack://Autodesk.Extensions.[name]/./extensions/Pushpins/PushPinExtension.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","useSourceMap","list","toString","this","map","item","content","cssMapping","btoa","sourceMapping","sourceMap","unescape","encodeURIComponent","JSON","stringify","toComment","sourceURLs","sources","source","sourceRoot","concat","join","cssWithMappingToString","mediaQuery","alreadyImportedModules","length","id","push","stylesInDom","isOldIE","fn","memo","apply","arguments","memoize","window","document","all","atob","getElement","target","parent","styleTarget","querySelector","HTMLIFrameElement","contentDocument","head","e","singleton","singletonCounter","stylesInsertedAtTop","fixUrls","addStylesToDom","styles","options","domStyle","refs","j","parts","addStyle","listToStyles","newStyles","base","part","css","media","insertStyleElement","style","insertInto","Error","lastStyleElementInsertedAtTop","insertAt","nextSibling","insertBefore","appendChild","firstChild","before","removeStyleElement","parentNode","removeChild","idx","indexOf","splice","createStyleElement","createElement","undefined","attrs","type","nonce","nc","getNonce","addAttrs","el","keys","forEach","setAttribute","obj","update","remove","result","transform","styleIndex","applyToSingletonTag","URL","createObjectURL","revokeObjectURL","Blob","link","rel","createLinkElement","autoFixUrls","convertToAbsoluteUrls","blob","oldSrc","href","styleSheet","cssText","createTextNode","newObj","DEBUG","newList","mayRemove","replaceText","textStore","index","replacement","filter","Boolean","cssNode","childNodes","hmr","locals","location","baseUrl","protocol","host","currentDir","pathname","replace","fullMatch","origUrl","newUrl","unquotedOrigUrl","trim","$1","test","PUSHPIN_EVENTS","PUSH_PIN_CREATION_START_EVENT","PUSH_PIN_CREATION_END_EVENT","PUSH_PIN_PREPARING_THUMBNAIL","PUSH_PIN_CREATED_EVENT","PUSH_PIN_SELECTED_EVENT","PUSH_PIN_REMOVED_EVENT","PUSH_PIN_REMOVE_ALL_EVENT","PUSH_PIN_MODIFY_EVENT","PUSH_PIN_UPDATE_EVENT","PUSH_PIN_VISIBILITY_EVENT","PUSH_PIN_ITEMS_LOADED","PUSH_PIN_CLICKED_EVENT","PUSH_PIN_SELECT_NONE","applyOffsetToCamera","viewport","offset","eye","Number","x","y","z","pivotPoint","applyOffsetToCutplanes","cutplanes","normal","THREE","Vector3","cutplane","toVector","dot","restoreViewState","viewer","data","viewerState","model","amendedData","globalOffset","state","parse","invGlobalOffset","attributesVersion","amendViewportIfNeeded","getData","restoreState","navapi","navigation","updateCamera","camera","getCamera","updateMatrixWorld","matrixWorldInverse","getInverse","matrixWorld","src","dst","transformPoint","v","values","tf","applyMatrix4","toArray","transformNormal","normalMatrix","Matrix3","getNormalMatrix","applyMatrix3","normalize","transformViewerState","up","worldUpVector","plane","Plane","constant","set","statusHexValues","issues-draft","issues-draft-selected","issues-draft-movable","issues-open","issues-open-selected","issues-open-movable","issues-answered","issues-answered-selected","issues-answered-movable","issues-closed","issues-closed-selected","issues-closed-movable","rfis-draft","rfis-draft-selected","rfis-draft-movable","rfis-submitted","rfis-submitted-selected","rfis-submitted-movable","rfis-open","rfis-open-selected","rfis-open-movable","rfis-answered","rfis-answered-selected","rfis-answered-movable","rfis-rejected","rfis-rejected-selected","rfis-rejected-movable","rfis-closed","rfis-closed-selected","rfis-closed-movable","rfis-void","rfis-void-selected","rfis-void-movable","quality_issues-draft","quality_issues-draft-selected","quality_issues-draft-movable","quality_issues-not_approved","quality_issues-not_approved-selected","quality_issues-not_approved-movable","quality_issues-open","quality_issues-open-selected","quality_issues-open-movable","quality_issues-ready_to_inspect","quality_issues-ready_to_inspect-selected","quality_issues-ready_to_inspect-movable","quality_issues-void","quality_issues-void-selected","quality_issues-void-movable","quality_issues-work_completed","quality_issues-work_completed-selected","quality_issues-work_completed-movable","quality_issues-in_dispute","quality_issues-in_dispute-selected","quality_issues-in_dispute-movable","quality_issues-closed","quality_issues-closed-selected","quality_issues-closed-movable","quality_issues-answered","quality_issues-answered-selected","quality_issues-answered-movable","moveableIcon","cursorIcon","markerOffsets","ATTRIBUTES_VERSION","namespace","AutodeskNamespace","getLineageId","encodedUrn","decoded","urn","decodeUrn","start","end","substring","findMatchingModel","seedUrn","issueLineageId","models","getVisibleModels","myData","console","error","_nextPushPinId","PushPinItem","_classCallCheck","itemData","label","status","position","objectId","externalId","objectData","selected","isVisible","draggable","selectable","normalSize","selectedSize","draggableStatus","selectedStatus","assign","correctDataFormat","findModel","copy","modelTf","placementWithOffset","placementTf","placementTransform","localData","modelLocalToViewer","modelLocalToWorld","viewerToModelLocal","Matrix4","worldToModelLocal","dbId","res","documentNode","getDocumentNode","docNodeData","guid","viewableId","viewableID","viewName","newPos","seedURN","originalDocumentResolution","setViewerState","_this","hasPosition","computeMaxLevel","w","h","lx","Math","ceil","log2","ly","max","_clientToWorld","impl","clientToViewport","projMatrix","projectionMatrix","projMatrixIns","clientToWorld","isLeaflet","loadOptions","bounds","isPdf","Autodesk","Viewing","PDFUtils","getLeafletLoadOptions","getLeafletBoundingBox","modelData","bbox","_loadOptions","texWidth","texHeight","worldPos","worldTopLeft","min","sub","newX","size","newY","point","maxLevel","scale","pow","px","py","clientToWorldLeaflet","applyPdfWorldScaling","clientPos","worldToClient","_loadOptions2","originalDocumentWidth","dpiCorrection","wx","wy","leafletToPdfWorld","convertPdfToLeaflet","pdfToLeafletWorld","PushPinManager","PushPinManager_classCallCheck","_possibleConstructorReturn","_getPrototypeOf","pushPinList","selectedItem","PushPinTypes","ISSUES","RFIS","QUALITY_ISSUES","pushPinsVisibilityByType","getInitialPushpinVisibilityByType","pushpinsByType","getInitialPushpinsByType","Promise","resolve","EventDispatcher","_this2","cache","issueTypeKey","_this3","typeKey","generateIssueThumbnail","generateRFIThumbnail","_this4","shouldGenerateThumbnail","reject","width","height","zoomRatio","pWorld","markerPos","_item$data$position","fireEvent","canvasBounds","getCanvasBoundingClientRect","floor","is2d","thumbnailSizeWorld","zeroWorld","distanceTo","Box3","expandByPoint","expandByVector","getCropBounds","cropCenter","thumbnailSize","clientBounds","overlayRenderer","ctx","screenshotCamera","onRenderDone","canvas","targetToCanvas","multiplyScalar","ctx2d","getContext","fillStyle","beginPath","arc","PI","closePath","fill","ScreenShot","getScreenShotWithBounds","outputWidth","outputHeight","blobToImage","img","catch","_this5","isTriggeringEvent","createFromLocal","getItemById","newItem","setLocal","addItem","then","generateThumbnail","thumbnail","_newItem$data$positio","dataArray","_this6","pushPinData","_applyPdfWorldScaling","createItem","getItemIndexById","visible","unshift","_this7","pushPinTypeObject","removeItemById","_applyPdfWorldScaling2","every","oldOne","selectOne","_this8","event","func","hasEventListener","_get","HTMLPushPinLabel","HTMLPushPinLabel_classCallCheck","container","className","text","dirty","textString","innerHTML","bgWidth","clientWidth","top","left","clientHeight","PushPinBillboardLabel","marker","labelText","PushPinBillboardLabel_classCallCheck","PushPinBillboardLabel_possibleConstructorReturn","PushPinBillboardLabel_getPrototypeOf","createLabel","PushPinBillboardLabel_get","TOP_PADDING","display","PushPinBillboardTool2D","PushPinBillboardTool2D_classCallCheck","names","active","pushpins","selectedPushpin","curCameraZ","curCameraRotationZ","getName","onCameraChangeBinded","onCameraChange","handleResizeBinded","handleResize","addEventListener","CAMERA_CHANGE_EVENT","VIEWER_RESIZE_EVENT","createMarkerContainer","removeEventListener","toPrecision","rotation","updatePushpinsProjection","updateContainerProjection","pushpinContainer","appendOrderedElementToViewer","pushpin","intersectPoint","containerBounds","getScreenViewport","matrix","multiplyMatrices","applyProjection","round","unproject","convertLeafletPosition","setOriginalDocumentResolution","createMarker","enableDragging","disableDragging","showMarker","hideMarker","initNewPushpin","selectPushpin","classList","add","backgroundColor","boxShadow","setMarkerPosition","setPushpinContainerPosition","newPosX","newPosY","curPushpin","destroyMarker","removePushpin","destroyLabel","xTranslate","yTranslate","initPos","project","hex","newPosition","updatedPosition","offsetWidth","updatePushpin","redraw","xPos","yPos","deselect","clearSelection","pointerEvents","backgroundImage","button","setTimeout","PushPinInputHandler","pushpinRenderer","PushPinInputHandler_classCallCheck","mousePosition","onTouchDragBinded","onTouchDrag","onMouseMoveBinded","onMouseMove","onMouseUpBinded","onMouseUp","onMouseDownBinded","onMouseDown","onHammerInputBinded","onHammerInput","mouseEnabled","mousePrevValue","lock","clientX","clientY","detach","isTouchDevice","hammer","Hammer","Manager","recognizers","GestureRecognizers","drag","inputClass","isIE11","PointerEventInput","TouchInput","on","isMobileDevice","enableMouseButtons","setMouseDisabledWhenTouching","isFirst","isFinal","destroy","processMouseEvent","handleMouseMove","preventDefault","handleMouseDown","handleMouseUp","convertEventHammerToMouse","shiftKey","pointers","RenderHandler2D","viewerApi","pushPinManager","RenderHandler2D_classCallCheck","pushpinDirty","onSelectedChangedBind","onSelectedChanged","onRemoveBind","onRemove","onRemoveAllBind","onRemoveAll","onModifyBind","onModify","onUpdateBind","onUpdate","createBind","onVisibilityChangedBind","onVisibilityChanged","pushpinBillboardTool","toolController","registerTool","deregisterTool","isActive","activateTool","inputHandler","setCreateFunction","deactivateTool","removeCreateFunction","focusCameraOnSelectedItem","enableItemDragging","dispatchEvent","deselectItem","setPushpinDirty","removeAll","showMarkers","setDirty","getSelectedItem","disableItemDragging","attachTo","createRenderItem","isIOSDevice","reselect","promise","isLoaded","loadPushpin","createPushpin","updateStyle","modelBounds","utilities","getBoundingBox","modelWidth","modelHeight","fitBounds","items","reverse","mouseX","mouseY","hitItem","some","bb","getBoundingClientRect","startDragging","mousePos","ev","pageX","pageY","body","scrollLeft","clientLeft","scrollTop","clientTop","mouseCoords","mouseOffset","wi","hi","containerPosX","containerPosY","dragging","_this4$selectedItem$d","render","tagName","toLowerCase","offsetParent","offsetLeft","offsetTop","getOffset","PushPinBillboardTool3D","PushPinBillboardTool3D_classCallCheck","maxMsPerRayCastCycle","updateTimestamp","disableOcclusionTest","raycastThrottle","throttle","continueRayCasts","stamp","performance","now","castRay","callback","wait","context","timeout","callbackArgs","later","updatePushpins","frustum","Frustum","setFromMatrix","containsPoint","getProperties2","props","startsWith","endsWith","parsedExternalId","Array","isArray","fileExt","ifcId","properties","find","displayName","displayCategory","displayValue","parentDbId","fetchExternalId","message","Private","logger","warn","needsExternalId","generateMetadata","getState","vpVec","castRayViewport","setObjectId","setObjectData","setExternalId","parseInt","isNaN","opacity","hide","RenderHandler3D","RenderHandler3D_classCallCheck","onExplodeBind","onExplode","onSectionBind","onSection","EXPLODE_CHANGE_EVENT","CUTPLANES_CHANGE_EVENT","sectionExt","getExtension","getSectionPlanes","setSectionFromPlane","setCutPlaneSet","hideMarkers","docPos","getPosition","getMouseOffset","PushPinTool","PushPinTools_classCallCheck","priority","pushpinCursor","pushPinInitData","createMode","testId","autoCreate","is2D","modelBB","worldUp","worldUpName","isPseudo2D","auto","isHover","renderTool","register","deregister","activate","show","duringShowing","enable","controller","getActiveToolName","enablePushPinSelect","pushPin","canvasX","canvasY","intersectGround","createTwoPushPin","createThreePushPin","handleSingleClick","findIntersections","pressedItem","checkPushpinClick","triggered","triggerPushpinClick","selectNone","createPushPin","handler","stopPropagation","hoveredItem","PushPinVisButton","extension","initiallyHidePushpins","PushPinVisButtonBase_classCallCheck","pushpinVisBtn","setButtonConstants","buttonConstants","btnClass","btnLabel","noPushpinLabel","hidePushpinLabel","showPushpinLabel","pushpinNormalIcon","pushpinHideIcon","btn","UI","Button","setToolTip","i18n","translate","setIcon","onClick","DISABLED","setState","INACTIVE","ACTIVE","showAll","tool","showByType","hideByType","getToolbar","toolbar","modelTools","getControl","TOOLBAR","MODELTOOLSID","navigationBar","NAVTOOLSID","toolbarOptions","ControlGroup","addControl","createButton","Event","STATE_CHANGED","onPushpinVisBtnStateChange","updateButtonStatus","issuePushpinCount","getItemCountByType","issueButtonDisable","removeFromParent","State","IssuePushPinVisButton","IssuePushPinVisButton_classCallCheck","IssuePushPinVisButton_possibleConstructorReturn","IssuePushPinVisButton_getPrototypeOf","RfiPushPinVisButton","RfiPushPinVisButton_classCallCheck","RfiPushPinVisButton_possibleConstructorReturn","RfiPushPinVisButton_getPrototypeOf","QualityIssuePushPinVisButton","QualityIssuePushPinVisButton_classCallCheck","QualityIssuePushPinVisButton_possibleConstructorReturn","QualityIssuePushPinVisButton_getPrototypeOf","PushPinMobileObserver","pushpinExtension","PushPinObserver_classCallCheck","addListeners","BIM360","Extension","PushPin","postMessage","messageName","pushPinItem","metadata","webkit","messageHandlers","callbackHandler","command","JSINTERFACE","isOldDCPushPin","boxData","box","fromArray","minXYZ","maxXYZ","getModelLocalBox","distanceToPoint","getUnitScale","viewerBox","applyLegacyFallback","fixOldDCPushPin","PushPinExtension","PushPinExtension_classCallCheck","PushPinExtension_possibleConstructorReturn","PushPinExtension_getPrototypeOf","observer","createUI","destroyUI","removeAllItems","startCreateItem","updateButtonsStatus","endCreateItem","updatePattern","pushPinDatas","addItems","updateItemById","isDraggable","cancelPositionChange","setPosition","origItemPosition","removeItemsByType","uiButtons","hideIssuesButton","initiallyHideIssuesPushpins","hideFieldIssuesButton","initiallyHideFieldIssuesPushpins","hideRfisButton","initiallyHideRfisPushpins","uiButton","addButton","self","MODEL_ROOT_LOADED_EVENT","enableVisButton","destroyButton","setVisibleByType","legacyToLocalPushPinData","useLegacyFallback","is3d","getLocal","pMin","pMax","getLegacyGlobalOffset","localToLegacyPushPinData","getLegacyPushPinData","PUSH_PIN_EXT_NAME","theExtensionManager","registerExtension"],"mappings":"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","file":"Pushpins/Pushpins.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 357);\n","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\nmodule.exports = function(useSourceMap) {\n\tvar list = [];\n\n\t// return the list of modules as css string\n\tlist.toString = function toString() {\n\t\treturn this.map(function (item) {\n\t\t\tvar content = cssWithMappingToString(item, useSourceMap);\n\t\t\tif(item[2]) {\n\t\t\t\treturn \"@media \" + item[2] + \"{\" + content + \"}\";\n\t\t\t} else {\n\t\t\t\treturn content;\n\t\t\t}\n\t\t}).join(\"\");\n\t};\n\n\t// import a list of modules into the list\n\tlist.i = function(modules, mediaQuery) {\n\t\tif(typeof modules === \"string\")\n\t\t\tmodules = [[null, modules, \"\"]];\n\t\tvar alreadyImportedModules = {};\n\t\tfor(var i = 0; i < this.length; i++) {\n\t\t\tvar id = this[i][0];\n\t\t\tif(typeof id === \"number\")\n\t\t\t\talreadyImportedModules[id] = true;\n\t\t}\n\t\tfor(i = 0; i < modules.length; i++) {\n\t\t\tvar item = modules[i];\n\t\t\t// skip already imported module\n\t\t\t// this implementation is not 100% perfect for weird media query combinations\n\t\t\t//  when a module is imported multiple times with different media queries.\n\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\n\t\t\tif(typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\n\t\t\t\tif(mediaQuery && !item[2]) {\n\t\t\t\t\titem[2] = mediaQuery;\n\t\t\t\t} else if(mediaQuery) {\n\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\n\t\t\t\t}\n\t\t\t\tlist.push(item);\n\t\t\t}\n\t\t}\n\t};\n\treturn list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n\tvar content = item[1] || '';\n\tvar cssMapping = item[3];\n\tif (!cssMapping) {\n\t\treturn content;\n\t}\n\n\tif (useSourceMap && typeof btoa === 'function') {\n\t\tvar sourceMapping = toComment(cssMapping);\n\t\tvar sourceURLs = cssMapping.sources.map(function (source) {\n\t\t\treturn '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */'\n\t\t});\n\n\t\treturn [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n\t}\n\n\treturn [content].join('\\n');\n}\n\n// Adapted from convert-source-map (MIT)\nfunction toComment(sourceMap) {\n\t// eslint-disable-next-line no-undef\n\tvar base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n\tvar data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;\n\n\treturn '/*# ' + data + ' */';\n}\n","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\nvar stylesInDom = {};\n\nvar\tmemoize = function (fn) {\n\tvar memo;\n\n\treturn function () {\n\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\n\t\treturn memo;\n\t};\n};\n\nvar isOldIE = memoize(function () {\n\t// Test for IE <= 9 as proposed by Browserhacks\n\t// @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n\t// Tests for existence of standard globals is to allow style-loader\n\t// to operate correctly into non-standard environments\n\t// @see https://github.com/webpack-contrib/style-loader/issues/177\n\treturn window && document && document.all && !window.atob;\n});\n\nvar getTarget = function (target, parent) {\n  if (parent){\n    return parent.querySelector(target);\n  }\n  return document.querySelector(target);\n};\n\nvar getElement = (function (fn) {\n\tvar memo = {};\n\n\treturn function(target, parent) {\n                // If passing function in options, then use it for resolve \"head\" element.\n                // Useful for Shadow Root style i.e\n                // {\n                //   insertInto: function () { return document.querySelector(\"#foo\").shadowRoot }\n                // }\n                if (typeof target === 'function') {\n                        return target();\n                }\n                if (typeof memo[target] === \"undefined\") {\n\t\t\tvar styleTarget = getTarget.call(this, target, parent);\n\t\t\t// Special case to return head of iframe instead of iframe itself\n\t\t\tif (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n\t\t\t\ttry {\n\t\t\t\t\t// This will throw an exception if access to iframe is blocked\n\t\t\t\t\t// due to cross-origin restrictions\n\t\t\t\t\tstyleTarget = styleTarget.contentDocument.head;\n\t\t\t\t} catch(e) {\n\t\t\t\t\tstyleTarget = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\tmemo[target] = styleTarget;\n\t\t}\n\t\treturn memo[target]\n\t};\n})();\n\nvar singleton = null;\nvar\tsingletonCounter = 0;\nvar\tstylesInsertedAtTop = [];\n\nvar\tfixUrls = require(\"./urls\");\n\nmodule.exports = function(list, options) {\n\tif (typeof DEBUG !== \"undefined\" && DEBUG) {\n\t\tif (typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\n\t}\n\n\toptions = options || {};\n\n\toptions.attrs = typeof options.attrs === \"object\" ? options.attrs : {};\n\n\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n\t// tags it will allow on a page\n\tif (!options.singleton && typeof options.singleton !== \"boolean\") options.singleton = isOldIE();\n\n\t// By default, add <style> tags to the <head> element\n        if (!options.insertInto) options.insertInto = \"head\";\n\n\t// By default, add <style> tags to the bottom of the target\n\tif (!options.insertAt) options.insertAt = \"bottom\";\n\n\tvar styles = listToStyles(list, options);\n\n\taddStylesToDom(styles, options);\n\n\treturn function update (newList) {\n\t\tvar mayRemove = [];\n\n\t\tfor (var i = 0; i < styles.length; i++) {\n\t\t\tvar item = styles[i];\n\t\t\tvar domStyle = stylesInDom[item.id];\n\n\t\t\tdomStyle.refs--;\n\t\t\tmayRemove.push(domStyle);\n\t\t}\n\n\t\tif(newList) {\n\t\t\tvar newStyles = listToStyles(newList, options);\n\t\t\taddStylesToDom(newStyles, options);\n\t\t}\n\n\t\tfor (var i = 0; i < mayRemove.length; i++) {\n\t\t\tvar domStyle = mayRemove[i];\n\n\t\t\tif(domStyle.refs === 0) {\n\t\t\t\tfor (var j = 0; j < domStyle.parts.length; j++) domStyle.parts[j]();\n\n\t\t\t\tdelete stylesInDom[domStyle.id];\n\t\t\t}\n\t\t}\n\t};\n};\n\nfunction addStylesToDom (styles, options) {\n\tfor (var i = 0; i < styles.length; i++) {\n\t\tvar item = styles[i];\n\t\tvar domStyle = stylesInDom[item.id];\n\n\t\tif(domStyle) {\n\t\t\tdomStyle.refs++;\n\n\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\n\t\t\t\tdomStyle.parts[j](item.parts[j]);\n\t\t\t}\n\n\t\t\tfor(; j < item.parts.length; j++) {\n\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\t\t} else {\n\t\t\tvar parts = [];\n\n\t\t\tfor(var j = 0; j < item.parts.length; j++) {\n\t\t\t\tparts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\n\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\n\t\t}\n\t}\n}\n\nfunction listToStyles (list, options) {\n\tvar styles = [];\n\tvar newStyles = {};\n\n\tfor (var i = 0; i < list.length; i++) {\n\t\tvar item = list[i];\n\t\tvar id = options.base ? item[0] + options.base : item[0];\n\t\tvar css = item[1];\n\t\tvar media = item[2];\n\t\tvar sourceMap = item[3];\n\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\n\n\t\tif(!newStyles[id]) styles.push(newStyles[id] = {id: id, parts: [part]});\n\t\telse newStyles[id].parts.push(part);\n\t}\n\n\treturn styles;\n}\n\nfunction insertStyleElement (options, style) {\n\tvar target = getElement(options.insertInto)\n\n\tif (!target) {\n\t\tthrow new Error(\"Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.\");\n\t}\n\n\tvar lastStyleElementInsertedAtTop = stylesInsertedAtTop[stylesInsertedAtTop.length - 1];\n\n\tif (options.insertAt === \"top\") {\n\t\tif (!lastStyleElementInsertedAtTop) {\n\t\t\ttarget.insertBefore(style, target.firstChild);\n\t\t} else if (lastStyleElementInsertedAtTop.nextSibling) {\n\t\t\ttarget.insertBefore(style, lastStyleElementInsertedAtTop.nextSibling);\n\t\t} else {\n\t\t\ttarget.appendChild(style);\n\t\t}\n\t\tstylesInsertedAtTop.push(style);\n\t} else if (options.insertAt === \"bottom\") {\n\t\ttarget.appendChild(style);\n\t} else if (typeof options.insertAt === \"object\" && options.insertAt.before) {\n\t\tvar nextSibling = getElement(options.insertAt.before, target);\n\t\ttarget.insertBefore(style, nextSibling);\n\t} else {\n\t\tthrow new Error(\"[Style Loader]\\n\\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\\n Must be 'top', 'bottom', or Object.\\n (https://github.com/webpack-contrib/style-loader#insertat)\\n\");\n\t}\n}\n\nfunction removeStyleElement (style) {\n\tif (style.parentNode === null) return false;\n\tstyle.parentNode.removeChild(style);\n\n\tvar idx = stylesInsertedAtTop.indexOf(style);\n\tif(idx >= 0) {\n\t\tstylesInsertedAtTop.splice(idx, 1);\n\t}\n}\n\nfunction createStyleElement (options) {\n\tvar style = document.createElement(\"style\");\n\n\tif(options.attrs.type === undefined) {\n\t\toptions.attrs.type = \"text/css\";\n\t}\n\n\tif(options.attrs.nonce === undefined) {\n\t\tvar nonce = getNonce();\n\t\tif (nonce) {\n\t\t\toptions.attrs.nonce = nonce;\n\t\t}\n\t}\n\n\taddAttrs(style, options.attrs);\n\tinsertStyleElement(options, style);\n\n\treturn style;\n}\n\nfunction createLinkElement (options) {\n\tvar link = document.createElement(\"link\");\n\n\tif(options.attrs.type === undefined) {\n\t\toptions.attrs.type = \"text/css\";\n\t}\n\toptions.attrs.rel = \"stylesheet\";\n\n\taddAttrs(link, options.attrs);\n\tinsertStyleElement(options, link);\n\n\treturn link;\n}\n\nfunction addAttrs (el, attrs) {\n\tObject.keys(attrs).forEach(function (key) {\n\t\tel.setAttribute(key, attrs[key]);\n\t});\n}\n\nfunction getNonce() {\n\tif (typeof __webpack_nonce__ === 'undefined') {\n\t\treturn null;\n\t}\n\n\treturn __webpack_nonce__;\n}\n\nfunction addStyle (obj, options) {\n\tvar style, update, remove, result;\n\n\t// If a transform function was defined, run it on the css\n\tif (options.transform && obj.css) {\n\t    result = options.transform(obj.css);\n\n\t    if (result) {\n\t    \t// If transform returns a value, use that instead of the original css.\n\t    \t// This allows running runtime transformations on the css.\n\t    \tobj.css = result;\n\t    } else {\n\t    \t// If the transform function returns a falsy value, don't add this css.\n\t    \t// This allows conditional loading of css\n\t    \treturn function() {\n\t    \t\t// noop\n\t    \t};\n\t    }\n\t}\n\n\tif (options.singleton) {\n\t\tvar styleIndex = singletonCounter++;\n\n\t\tstyle = singleton || (singleton = createStyleElement(options));\n\n\t\tupdate = applyToSingletonTag.bind(null, style, styleIndex, false);\n\t\tremove = applyToSingletonTag.bind(null, style, styleIndex, true);\n\n\t} else if (\n\t\tobj.sourceMap &&\n\t\ttypeof URL === \"function\" &&\n\t\ttypeof URL.createObjectURL === \"function\" &&\n\t\ttypeof URL.revokeObjectURL === \"function\" &&\n\t\ttypeof Blob === \"function\" &&\n\t\ttypeof btoa === \"function\"\n\t) {\n\t\tstyle = createLinkElement(options);\n\t\tupdate = updateLink.bind(null, style, options);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\n\t\t\tif(style.href) URL.revokeObjectURL(style.href);\n\t\t};\n\t} else {\n\t\tstyle = createStyleElement(options);\n\t\tupdate = applyToTag.bind(null, style);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\t\t};\n\t}\n\n\tupdate(obj);\n\n\treturn function updateStyle (newObj) {\n\t\tif (newObj) {\n\t\t\tif (\n\t\t\t\tnewObj.css === obj.css &&\n\t\t\t\tnewObj.media === obj.media &&\n\t\t\t\tnewObj.sourceMap === obj.sourceMap\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tupdate(obj = newObj);\n\t\t} else {\n\t\t\tremove();\n\t\t}\n\t};\n}\n\nvar replaceText = (function () {\n\tvar textStore = [];\n\n\treturn function (index, replacement) {\n\t\ttextStore[index] = replacement;\n\n\t\treturn textStore.filter(Boolean).join('\\n');\n\t};\n})();\n\nfunction applyToSingletonTag (style, index, remove, obj) {\n\tvar css = remove ? \"\" : obj.css;\n\n\tif (style.styleSheet) {\n\t\tstyle.styleSheet.cssText = replaceText(index, css);\n\t} else {\n\t\tvar cssNode = document.createTextNode(css);\n\t\tvar childNodes = style.childNodes;\n\n\t\tif (childNodes[index]) style.removeChild(childNodes[index]);\n\n\t\tif (childNodes.length) {\n\t\t\tstyle.insertBefore(cssNode, childNodes[index]);\n\t\t} else {\n\t\t\tstyle.appendChild(cssNode);\n\t\t}\n\t}\n}\n\nfunction applyToTag (style, obj) {\n\tvar css = obj.css;\n\tvar media = obj.media;\n\n\tif(media) {\n\t\tstyle.setAttribute(\"media\", media)\n\t}\n\n\tif(style.styleSheet) {\n\t\tstyle.styleSheet.cssText = css;\n\t} else {\n\t\twhile(style.firstChild) {\n\t\t\tstyle.removeChild(style.firstChild);\n\t\t}\n\n\t\tstyle.appendChild(document.createTextNode(css));\n\t}\n}\n\nfunction updateLink (link, options, obj) {\n\tvar css = obj.css;\n\tvar sourceMap = obj.sourceMap;\n\n\t/*\n\t\tIf convertToAbsoluteUrls isn't defined, but sourcemaps are enabled\n\t\tand there is no publicPath defined then lets turn convertToAbsoluteUrls\n\t\ton by default.  Otherwise default to the convertToAbsoluteUrls option\n\t\tdirectly\n\t*/\n\tvar autoFixUrls = options.convertToAbsoluteUrls === undefined && sourceMap;\n\n\tif (options.convertToAbsoluteUrls || autoFixUrls) {\n\t\tcss = fixUrls(css);\n\t}\n\n\tif (sourceMap) {\n\t\t// http://stackoverflow.com/a/26603875\n\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\n\t}\n\n\tvar blob = new Blob([css], { type: \"text/css\" });\n\n\tvar oldSrc = link.href;\n\n\tlink.href = URL.createObjectURL(blob);\n\n\tif(oldSrc) URL.revokeObjectURL(oldSrc);\n}\n","\nvar content = require(\"!!../../node_modules/css-loader/index.js!./PushPinExtension.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/css-loader/index.js!./PushPinExtension.css\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/css-loader/index.js!./PushPinExtension.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"/*<editor-fold desc=\\\"ISSUES\\\">*/\\n@font-face {\\n    font-family: 'issueicon';\\n    src: url(data:application/font-woff;charset=utf-8;base64,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);\\n    font-weight: normal;\\n    font-style: normal;\\n}\\n\\n[class^=\\\"issueicon-\\\"], [class*=\\\" issueicon-\\\"] {\\n    font-family: 'issueicon';\\n    font-style: normal;\\n    font-weight: normal;\\n    font-variant: normal;\\n    line-height: 1;\\n    padding-top: 2px;\\n    speak: none;\\n    text-transform: none;\\n\\n\\n    /* Better Font Rendering =========== */\\n    -webkit-font-smoothing: antialiased;\\n    -moz-osx-font-smoothing: grayscale;\\n}\\n\\n@font-face {\\n    font-family: 'rfiicon';\\n    src: url(data:application/font-woff;charset=utf-8;base64,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);\\n    font-weight: normal;\\n    font-style: normal;\\n}\\n\\n[class^=\\\"rfiicon-\\\"], [class*=\\\" rfiicon-\\\"] {\\n    font-family: 'rfiicon';\\n    font-style: normal;\\n    font-weight: normal;\\n    font-variant: normal;\\n    line-height: 1;\\n    padding-top: 2px;\\n    speak: none;\\n    text-transform: none;\\n\\n\\n    /* Better Font Rendering =========== */\\n    -webkit-font-smoothing: antialiased;\\n    -moz-osx-font-smoothing: grayscale;\\n}\\n\\n@font-face {\\n    font-family: 'fieldissueicon';\\n    src: url(data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAUAAA0AAAAAByQAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABGRlRNAAAE5AAAABwAAAAcfzoDmUdERUYAAATIAAAAGwAAAB4AJwALT1MvMgAAAZwAAABKAAAAYC+xTDxjbWFwAAAB+AAAAEQAAAFKwBQjvWdhc3AAAATAAAAACAAAAAj//wADZ2x5ZgAAAkgAAAFeAAABhPocpV5oZWFkAAABMAAAADAAAAA2DEAuiWhoZWEAAAFgAAAAHAAAACQEIwIFaG10eAAAAegAAAAQAAAAEgYAAABsb2NhAAACPAAAAAwAAAAMAFgAwm1heHAAAAF8AAAAHgAAACAATgBKbmFtZQAAA6gAAADjAAAB47FU88Bwb3N0AAAEjAAAADIAAABR2shGr3icY2BkYGAA4uk3ErPi+W2+MnAzMYDAVZ+8TjB9te4fkGJnYmAE0RwMYGkALxEKOXicY2BkYGD8wsDAoMfEAAJAkpEBFbAAACM+AS54nGNgZGBgYGVwZ2BnAAEmIGZkAIk5gPkMAApQAJkAAHicY2BmYmCcwMDKwMHow5jGwMDgDqW/MkgytDAwMDGwcjLAgQCCyRCQ5prC4PCA8QET44P/Dxj0GL/8/wIUZkRSosDACAAr1Q1fAAB4nGNigAAmKGZgAAAAVgAHeJzdisEJwDAQw+RLyRR59NlBuv8M2STxpaWQFSowRiCg8Kwhktum5QeXv/pFQI8xMujKP+PtjSqfyGXWG+L3TGW0BrEAAAAAAAAAAABYAMJ4nG2PvU7CUBiGv4+fcyhwSiH0HAg/ASptKLQ1LaVoDTHGOOjohAnizwW46AU4GBNnZx2dZfQKSJzYvQYHE1fi0dnhXZ68w/NAGgBoAvAWmmDDCLZhAhC5SSua0MAXhtlHF40O0ctchC6Gw5GkhBrC53qgG2EggdCDkMp9j+db7RSheV20Nmy/9nRRV6unuaDdiwOz0rLqdkml/kJhfCGYwh3HOUuYoVvMKKxS4kU1c8eb3bhnjdOdVLdas7okL3/LpcIG0+mV48Cvq1wev3ANJWhDD3zpuwcHAGgW0JSilAtKBPcjHKX/ZKmEDaRDUxgdK+IxRjIj4sI06D8N+K5q56PK8UO7GR8WCqRI8Flbv04GZdYgzX4jcY2e45WrOMfkbtTKcZFllTfBssLzPPzUtEt2sh8PjrQCIfiifvR3aN1ukDqtPmpu7h4JToxN5rHsapVl7mx247o/vPQ77AAAeJyVj8FKw0AURc+0aUAUiht3ltnLhGQgCAXd2U/IFzQtgZJAmv6KOz/IT/ET3HmnPhe6EDrwmDN37rvzBrjhFUdajiXeeEbOs/GcB96MM3k+jBdcu1vjnKV7ktNlV1JW567EM+WXxnMaXowzed6NF9zxaZyzcvec6JnoVAdatgR2DGctUMGpn7rp0G7DbuinIOHX7Y+4MTHtI3sFeSKFxvGsVf8/8u2J1DqliuqreFSs4jfDuG99LEq/9n+GkRLrUIdYVjJf+pFGrpGjOpLLy5PmpWnHYzf0virKizO/AEzyTYUAeJxjYGJABowM6IAVLMrEyMTIzJ+WmZqToptZXFyaqpuZnCeCzM9PSwOK5ecBAP6rDY8AAAAAAAH//wACeJxjYGRgYOABYjEgZmJgBEIWMAbxGAADygAzAAAAAAEAAAAA1BgWEQAAAADVTG6JAAAAANXVfv4=);\\n    font-weight: normal;\\n    font-style: normal;\\n}\\n\\n[class^=\\\"fieldissueicon-\\\"], [class*=\\\" fieldissueicon-\\\"] {\\n    font-family: 'fieldissueicon';\\n    font-style: normal;\\n    font-weight: normal;\\n    font-variant: normal;\\n    line-height: 1;\\n    padding-top: 2px;\\n    speak: none;\\n    text-transform: none;\\n\\n\\n    /* Better Font Rendering =========== */\\n    -webkit-font-smoothing: antialiased;\\n    -moz-osx-font-smoothing: grayscale;\\n}\\n\\n.issueicon-issue_hide:before {\\n    content: \\\"\\\\E915\\\";\\n}\\n.issueicon-issue_normal:before {\\n    content: \\\"\\\\E916\\\";\\n}\\n\\n.rfiicon-rfi_hide:before {\\n    content: \\\"\\\\E003\\\";\\n}\\n.rfiicon-rfi_normal:before {\\n    content: \\\"\\\\E002\\\";\\n}\\n\\n.fieldissueicon-issue_hide:before {\\n    content: \\\"\\\\E002\\\";\\n}\\n.fieldissueicon-issue_normal:before {\\n    content: \\\"\\\\E001\\\";\\n}\\n\\n.leaflet-text-label {\\n    display: inherit;\\n    font-family: 'HelveticaNeue-bold';\\n    font-style: normal;\\n    font-weight: normal;\\n    font-variant: normal;\\n    line-height: 0;\\n    pointer-events: none;\\n    /*margin-top: 40px;\\n    margin-left:-20px;*/\\n    text-align: center;\\n    font-size: 16px;\\n    border-radius: .5em;\\n    max-width:auto;\\n    min-width: 60px; /*real width = width + border*2*/\\n    height: 32px;    /*real height = height + border*2*/\\n    position:absolute;\\n    background-color:rgba(0,0,0,0.7);\\n    color: #FFF;\\n    border: 2px solid white;\\n}\\n\\n.leaflet-marker-icon.leaflet-pin-icon {\\n    width: 40px;\\n}\\n\\n.leaflet-text-label span {\\n    display: inline-block;\\n    vertical-align: middle;\\n    line-height:32px;\\n    white-space: pre;\\n}\\n\\n.leaflet-pushpin-hidden {\\n    visibility: hidden;\\n}\\n\\n/* disable push pin visible button's border*/\\n#toolbar-pushpinVis, #toolbar-pushpinRfisVis, #toolbar-pushpinFieldIssuesVis {\\n    border: none;\\n}\\n/*</editor-fold>*/\\n\\n/*<editor-fold desc=\\\"PUSHPIN BILLBOARD (3D)\\\">*/\\n.pushpin-billboard-marker {\\n    position: absolute;\\n    font-size: 10px;\\n    font-weight: bold;\\n    width: 22px;\\n    height: 22px;\\n\\n    left: 0;\\n    top: 0;\\n\\n    line-height: 16px;\\n    text-align: center;\\n    cursor: pointer;\\n    pointer-events: none;\\n\\n    color: rgba(23, 87, 168, 1.0);\\n    border: 4px solid rgba(255, 255, 255, 0.95);\\n    background: #4675A8 no-repeat center;\\n    background-size: 16px;\\n    border-radius: 15px;\\n\\n    opacity: 1;\\n    transition: opacity 0.4s;\\n    -webkit-transition: opacity 0.4s;\\n}\\n\\n.rfi-billboard-marker {\\n    position: absolute;\\n    font-size: 10px;\\n    font-weight: bold;\\n    width: 22px;\\n    height: 22px;\\n    line-height: 16px;\\n    text-align: center;\\n    cursor: pointer;\\n    pointer-events: none;\\n\\n    left: 0;\\n    top: 0;\\n\\n    color: rgba(23, 87, 168, 1.0);\\n    border: 4px solid rgba(255, 255, 255, 0.95);\\n    background: #4675A8 no-repeat center;\\n    background-size: 16px;\\n    border-radius: 3px;\\n\\n    opacity: 1;\\n    transition: opacity 0.4s;\\n    -webkit-transition: opacity 0.4s;\\n}\\n\\n.pushpin-billboard-marker.selected {\\n    border: 5px solid rgba(255, 255, 255, 0.95);\\n    border-radius: 20px;\\n    background-size: 20px;\\n    z-index: 1;\\n    top: -3px;\\n    width: 28px;\\n    height: 28px;\\n    left: -3px;\\n}\\n\\n\\n.rfi-billboard-marker.selected {\\n    border: 5px solid rgba(255, 255, 255, 0.95);\\n    border-radius: 4px;\\n    background-size: 20px;\\n    z-index: 1;\\n    top: -3px;\\n    width: 28px;\\n    height: 28px;\\n    left: -3px;\\n}\\n\\n.pushpin-billboard-marker.grey-out {\\n    background-color: rgb(145, 145, 145) !important;\\n    opacity: 0.5 !important;\\n    cursor: not-allowed;\\n}\\n\\n.rfi-billboard-marker.grey-out {\\n    background-color: rgb(145, 145, 145) !important;\\n    opacity: 0.5 !important;\\n    cursor: not-allowed;\\n}\\n\\n.pushpin-container {\\n    will-change: transform;\\n    transform: translateZ(0);\\n    left: 0;\\n    top: 0;\\n    position: absolute;\\n}\\n/*</editor-fold>*/\", \"\"]);\n\n// exports\n","\n/**\n * When source maps are enabled, `style-loader` uses a link element with a data-uri to\n * embed the css on the page. This breaks all relative urls because now they are relative to a\n * bundle instead of the current page.\n *\n * One solution is to only use full urls, but that may be impossible.\n *\n * Instead, this function \"fixes\" the relative urls to be absolute according to the current page location.\n *\n * A rudimentary test suite is located at `test/fixUrls.js` and can be run via the `npm test` command.\n *\n */\n\nmodule.exports = function (css) {\n  // get current location\n  var location = typeof window !== \"undefined\" && window.location;\n\n  if (!location) {\n    throw new Error(\"fixUrls requires window.location\");\n  }\n\n\t// blank or null?\n\tif (!css || typeof css !== \"string\") {\n\t  return css;\n  }\n\n  var baseUrl = location.protocol + \"//\" + location.host;\n  var currentDir = baseUrl + location.pathname.replace(/\\/[^\\/]*$/, \"/\");\n\n\t// convert each url(...)\n\t/*\n\tThis regular expression is just a way to recursively match brackets within\n\ta string.\n\n\t /url\\s*\\(  = Match on the word \"url\" with any whitespace after it and then a parens\n\t   (  = Start a capturing group\n\t     (?:  = Start a non-capturing group\n\t         [^)(]  = Match anything that isn't a parentheses\n\t         |  = OR\n\t         \\(  = Match a start parentheses\n\t             (?:  = Start another non-capturing groups\n\t                 [^)(]+  = Match anything that isn't a parentheses\n\t                 |  = OR\n\t                 \\(  = Match a start parentheses\n\t                     [^)(]*  = Match anything that isn't a parentheses\n\t                 \\)  = Match a end parentheses\n\t             )  = End Group\n              *\\) = Match anything and then a close parens\n          )  = Close non-capturing group\n          *  = Match anything\n       )  = Close capturing group\n\t \\)  = Match a close parens\n\n\t /gi  = Get all matches, not the first.  Be case insensitive.\n\t */\n\tvar fixedCss = css.replace(/url\\s*\\(((?:[^)(]|\\((?:[^)(]+|\\([^)(]*\\))*\\))*)\\)/gi, function(fullMatch, origUrl) {\n\t\t// strip quotes (if they exist)\n\t\tvar unquotedOrigUrl = origUrl\n\t\t\t.trim()\n\t\t\t.replace(/^\"(.*)\"$/, function(o, $1){ return $1; })\n\t\t\t.replace(/^'(.*)'$/, function(o, $1){ return $1; });\n\n\t\t// already a full url? no change\n\t\tif (/^(#|data:|http:\\/\\/|https:\\/\\/|file:\\/\\/\\/|\\s*$)/i.test(unquotedOrigUrl)) {\n\t\t  return fullMatch;\n\t\t}\n\n\t\t// convert the url to a full url\n\t\tvar newUrl;\n\n\t\tif (unquotedOrigUrl.indexOf(\"//\") === 0) {\n\t\t  \t//TODO: should we add protocol?\n\t\t\tnewUrl = unquotedOrigUrl;\n\t\t} else if (unquotedOrigUrl.indexOf(\"/\") === 0) {\n\t\t\t// path should be relative to the base url\n\t\t\tnewUrl = baseUrl + unquotedOrigUrl; // already starts with '/'\n\t\t} else {\n\t\t\t// path should be relative to current directory\n\t\t\tnewUrl = currentDir + unquotedOrigUrl.replace(/^\\.\\//, \"\"); // Strip leading './'\n\t\t}\n\n\t\t// send back the fixed url(...)\n\t\treturn \"url(\" + JSON.stringify(newUrl) + \")\";\n\t});\n\n\t// send back the fixed css\n\treturn fixedCss;\n};\n","export const PUSHPIN_EVENTS = {\n    PUSH_PIN_CREATION_START_EVENT: 'pushpin.creation.start',\n    PUSH_PIN_CREATION_END_EVENT: 'pushpin.creation.end',\n    PUSH_PIN_PREPARING_THUMBNAIL: 'pushpin.preparing.thumbnail',\n    PUSH_PIN_CREATED_EVENT: 'pushpin.created',\n    PUSH_PIN_SELECTED_EVENT: 'pushpin.selected',\n    PUSH_PIN_REMOVED_EVENT: 'pushpin.removed',\n    PUSH_PIN_REMOVE_ALL_EVENT: 'pushpin.remove.all',\n    PUSH_PIN_MODIFY_EVENT: 'pushpin.modified', // this will be fired on push pin position changed.\n    PUSH_PIN_UPDATE_EVENT: 'pushpin.update', // this will be fired on an explicit push pin data update.\n    PUSH_PIN_VISIBILITY_EVENT: 'pushpin.visibility.changed',\n    PUSH_PIN_ITEMS_LOADED: 'pushpin.tool.items.loaded',\n\n    // Separate events to distinguish that they are triggered from client by direct API call.\n    // This is a workaround to fix some problems on mobile client.\n    // Mobile is going to rely on this event to get push pin select status.\n    PUSH_PIN_CLICKED_EVENT: 'pushpin.clicked',\n    PUSH_PIN_SELECT_NONE: 'pushpin.select.none'\n};\n","const applyOffsetToCamera = (viewport, offset) => {\n    if (!viewport || !offset) {\n        return;\n    }\n\n    if ('eye' in viewport) {\n        viewport.eye[0] = (Number(viewport.eye[0]) + offset.x).toString();\n        viewport.eye[1] = (Number(viewport.eye[1]) + offset.y).toString();\n        viewport.eye[2] = (Number(viewport.eye[2]) + offset.z).toString();\n    }\n\n    if ('target' in viewport) {\n        viewport.target[0] = (Number(viewport.target[0]) + offset.x).toString();\n        viewport.target[1] = (Number(viewport.target[1]) + offset.y).toString();\n        viewport.target[2] = (Number(viewport.target[2]) + offset.z).toString();\n    }\n\n    if ('pivotPoint' in viewport) {\n        viewport.pivotPoint[0] = (Number(viewport.pivotPoint[0]) + offset.x).toString();\n        viewport.pivotPoint[1] = (Number(viewport.pivotPoint[1]) + offset.y).toString();\n        viewport.pivotPoint[2] = (Number(viewport.pivotPoint[2]) + offset.z).toString();\n    }\n};\n\nconst applyOffsetToCutplanes = (cutplanes, offset) => {\n    if (!cutplanes || !offset) {\n        return;\n    }\n    \n    const normal = new THREE.Vector3();\n    \n    for (let i = 0; i < cutplanes.length; i++) {\n        const cutplane = cutplanes[i];\n        // A cutplane is an array of 4 numbers. The first 3 numbers represent the plane's normal vector\n        // and the 4th number is the distance along it\n        toVector(cutplane, normal);\n        // Translating a plane by an offset vector is equivalent to adding dot(n,of) where n is the plane normal\n        // This again is equivalent to adding or subtracting dot(n, of) to the constant of the plane\n        // We have plane.constant = -plane.normal.dot(onPlane + globalOffset)\n        //                        = -plane.normal.dot(onPlane) - plane.normal.dot(globalOffset)\n        //                        = oldConstant - plane.normal.dot(globalOffset)\n        cutplane[3] = Number(cutplane[3]) - normal.dot(offset);\n    }\n};\n\nconst amendViewportIfNeeded = (item, globalOffset) => {\n    if (globalOffset) {\n        const state = JSON.parse(JSON.stringify(item.data.viewerState));\n        const invGlobalOffset = { x: -globalOffset.x, y: -globalOffset.y, z: -globalOffset.z };\n\n        applyOffsetToCamera(state.viewport, invGlobalOffset);\n\n        if (item.attributesVersion >= 2) {\n            applyOffsetToCutplanes(state.cutplanes, invGlobalOffset);\n        }\n\n        return state;\n    }\n\n    return item.data.viewerState;\n};\n\nexport const generateMetadata = (viewerState, globalOffset) => {\n    const state = JSON.parse(JSON.stringify(viewerState));\n\n    if (globalOffset) {\n        applyOffsetToCamera(state.viewport, globalOffset);\n        applyOffsetToCutplanes(state.cutplanes, globalOffset);\n\n        state.globalOffset = globalOffset;\n    }\n\n    return state;\n};\n\nexport const restoreViewState = (viewer, item) => {\n    if (item.data && item.data.viewerState) {\n        const model = viewer.model;\n        const globalOffset = model ? model.getData().globalOffset : null;\n\n        const amendedData = amendViewportIfNeeded(item, globalOffset);\n        \n        viewer.restoreState(amendedData, null, false);\n\n        // RestoreState will async to update camera's all data. Here force update camera before load pushpin.\n        const navapi = viewer.navigation;\n\n        if (navapi) {\n            navapi.updateCamera();\n            const camera = navapi.getCamera();\n\n            camera.updateMatrixWorld();\n            camera.matrixWorldInverse.getInverse(camera.matrixWorld);\n        }\n    }\n};\n\n// Convert from array of values (or number-strings) to THREE.Vector.\n// Like THREE.Vector3.fromArray(), but with string->number conversion, because some viewerState values are stored as strings.\nconst toVector = (src, dst) => {\n    dst.x = Number(src[0]);\n    dst.y = Number(src[1]);\n    dst.z = Number(src[2]);\n};\n\n// Transforms a point given as array-3 by a THREE.Matrix4\nconst transformPoint = function() {\n    const v = new THREE.Vector3();\n \n    return (values, tf) => {\n        toVector(values, v);\n        v.applyMatrix4(tf);\n        v.toArray(values);\n    };\n}();\n\n// Transforms a direction vector given as array-3 by a THREE.Matrix4\nconst transformNormal = function() {\n    const v = new THREE.Vector3();\n    const normalMatrix = new THREE.Matrix3();\n \n    return (values, tf) => {\n        toVector(values, v);\n\n        normalMatrix.getNormalMatrix(tf);\n        v.applyMatrix3(normalMatrix);\n        v.normalize(); // Re-normalize, so that scaling doesn't kill normalized directions.\n\n        v.toArray(values);\n    };\n}();\n\nexport const transformViewerState = (state, tf) => {\n\n    // Note that these values are not vectors, but arrays (in some cases even containing string-type-values). \n    transformPoint(state.viewport.eye, tf);\n    transformPoint(state.viewport.target, tf);\n    transformPoint(state.viewport.pivotPoint, tf);\n\n    transformNormal(state.viewport.up, tf); // may become relevant if tf contains a true-north rotation and the camera-up is not vertical\n    transformNormal(state.viewport.worldUpVector, tf);\n\n    if (state.cutplanes) {\n        const plane = new THREE.Plane();\n        const normal = new THREE.Vector3();\n        \n        for (let i = 0; i < state.cutplanes.length; i++) {\n            const cutplane = state.cutplanes[i];\n            \n            toVector(cutplane, normal);\n            const constant = Number(cutplane[3]);\n            plane.set(normal, constant);\n            \n            plane.applyMatrix4(tf);\n            \n            plane.normal.toArray(cutplane);\n            cutplane[3] = plane.constant;\n        }\n    }\n};\n","export const statusHexValues = {\n    /* Issues */\n\n    'issues-draft': '#819099',\n    'issues-draft-selected': '#819099',\n    'issues-draft-movable': '#819099',\n\n    'issues-open': '#ffba0c',\n    'issues-open-selected': '#ffba0c',\n    'issues-open-movable': '#ffba0c',\n\n    'issues-answered': '#087cd9',\n    'issues-answered-selected': '#087cd9',\n    'issues-answered-movable': '#087cd9',\n\n    'issues-closed': '#bcc9d1',\n    'issues-closed-selected': '#bcc9d1',\n    'issues-closed-movable': '#bcc9d1',\n\n    /* RFIs */\n\n    'rfis-draft': '#819099',\n    'rfis-draft-selected': '#819099',\n    'rfis-draft-movable': '#819099',\n\n    'rfis-submitted': '#7a77d9',\n    'rfis-submitted-selected': '#7a77d9',\n    'rfis-submitted-movable': '#7a77d9',\n\n    'rfis-open': '#ffba0c',\n    'rfis-open-selected': '#ffba0c',\n    'rfis-open-movable': '#ffba0c',\n\n    'rfis-answered': '#087cd9',\n    'rfis-answered-selected': '#087cd9',\n    'rfis-answered-movable': '#087cd9',\n\n    'rfis-rejected': '#ff495c',\n    'rfis-rejected-selected': '#ff495c',\n    'rfis-rejected-movable': '#ff495c',\n\n    'rfis-closed': '#bcc9d1',\n    'rfis-closed-selected': '#bcc9d1',\n    'rfis-closed-movable': '#bcc9d1',\n\n    'rfis-void': '#bcc9d1',\n    'rfis-void-selected': '#bcc9d1',\n    'rfis-void-movable': '#bcc9d1',\n\n\n    /* Field Issues */\n\n    'quality_issues-draft': '#819099',\n    'quality_issues-draft-selected': '#819099',\n    'quality_issues-draft-movable': '#819099',\n\n    'quality_issues-not_approved': '#ff495c',\n    'quality_issues-not_approved-selected': '#ff495c',\n    'quality_issues-not_approved-movable': '#ff495c',\n\n    'quality_issues-open': '#ffba0c',\n    'quality_issues-open-selected': '#ffba0c',\n    'quality_issues-open-movable': '#ffba0c',\n\n    'quality_issues-ready_to_inspect': '#7a77d9',\n    'quality_issues-ready_to_inspect-selected': '#7a77d9',\n    'quality_issues-ready_to_inspect-movable': '#7a77d9',\n\n    'quality_issues-void': '#bcc9d1',\n    'quality_issues-void-selected': '#bcc9d1',\n    'quality_issues-void-movable': '#bcc9d1',\n\n    'quality_issues-work_completed': '#087cd9',\n    'quality_issues-work_completed-selected': '#087cd9',\n    'quality_issues-work_completed-movable': '#087cd9',\n\n    // \"in_dispute\" pushpins are the same as \"not_approved\" ones\n    'quality_issues-in_dispute': '#ff495c',\n    'quality_issues-in_dispute-selected': '#ff495c',\n    'quality_issues-in_dispute-movable': '#ff495c',\n\n    // \"closed\" pushpins are the same as \"void\" ones\n    'quality_issues-closed': '#bcc9d1',\n    'quality_issues-closed-selected': '#bcc9d1',\n    'quality_issues-closed-movable': '#bcc9d1',\n\n    'quality_issues-answered': '#087cd9',\n    'quality_issues-answered-selected': '#087cd9',\n    'quality_issues-answered-movable': '#087cd9'\n};\n\nexport const moveableIcon = 'url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEsAAABMCAYAAAAlS0pSAAAA4UlEQVR42u3bSw7DIAwFwNz/zhXddNVuoPWHlHkHCGKUgG0p1yVyTMYrJGDFQwFbhAIGKw8KGKw8KGCLUMBg5UEdDQYrGeo4sBEUWLC0O7BgwYIFCxYsWLBgwYL1r1jRm8nGasPP3Ew2VhlY1Waqnl96ntwdKxytagjXifXzOtUTy26sr9YbMoeGaAIMywIaDm+Yc2sbKKVDcr2lKP1c6KHd0Ugb0WwxojH8M1aGBUtgwYIFCxYsgQUL1iYofkeB1Q/mcwQFqw3MzQgrHkwlOglGCJZ2B9YdwIhMgpGAJfKWJ1qioD8mrIWXAAAAAElFTkSuQmCC)';\n\nexport const cursorIcon = 'url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAiCAYAAAA6RwvCAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAIxJREFUeNpi/P//PwMlgJGR0QBIfQCa84ASc5gYKAcTgDiBUkOo4RCqgFGHjDpk1CGjDhl1yKhDRoxDGIFYgcJqPAVK3yHXAGBbxoEF1KgBYgcKHPIHiEHmHKCgcaXASIUWWgPIIyBfjSbWUYeMOmTUIaMOGXXIqEOGVMOICs0AUMNKAGjOBUrMAQgwAFWiHzqojsmJAAAAAElFTkSuQmCC)16 16, auto';\n\nexport const markerOffsets = {\n    markerOffsetWidth: 30, // .pushpin-billboard-marker height + (border*2)\n    selectedMarkerOffsetWidth: 38 // .pushpin-billboard-marker.selected height + (border*2)\n};\n\nexport const thumbnailOriginalPixelSize = 200; // Original crop size\nexport const thumbnailSize = 800; // Output size of the thumbnail\nexport const thumbnailZoom = thumbnailSize / thumbnailOriginalPixelSize;\nexport const thumbnailMarkerRadius = 10 * thumbnailZoom;\n\n// ATTRIBUTES_VERSION is used in order to track changes of the pushpin attributes.\n// Change this number only if there is a code change that requires a distinction between pushpins created before & after that change.\n//\n// V1: Legacy pushpins\n// V2: applyOffsetToCutplanes is being applied to pushpins' cutplanes. https://git.autodesk.com/A360/firefly.js/pull/3046\nexport const ATTRIBUTES_VERSION = 2;\n","const namespace = AutodeskNamespace('Autodesk.BIM360.Extension.PushPin');\n\nimport { transformViewerState } from './PushPins3D/PushPinViewerState';\nimport { ATTRIBUTES_VERSION } from './PushPinConstants';\n\nconst decodeUrn = (urn) => {\n    urn = urn.replace(/-/g, '+');         // Convert '-' (dash) to '+'\n    urn = urn.replace(/_/g, '/');         // Convert '_' (underscore) to '/'\n    while(urn.length % 4) { urn += '='; } // Add padding '='\n    return atob(urn);\n};\n\n// Extract the lineageID string from a base64-encoded version urn\n// Example: dXJuOmFkc2sud2lwc3RnOmZzLmZpbGU6dmYuM3Q4QlBZQXJSSkNpZkFZUnhOSnM0QT92ZXJzaW9uPTI \n//          => (decoded) \"urn:adsk.wipstg:fs.file:vf.3t8BPYArRJCifAYRxNJs4A?version=2\"\n//          => vf.3t8BPYArRJCifAYRxNJs4A\nconst getLineageId = (encodedUrn) => {\n    const decoded = decodeUrn(encodedUrn);\n    const start = decoded.indexOf('file:') + 'file:'.length; // skip prefix \"urn:adsk.wipstg:fs.file:\" resp. \"urn:adsk.wipprod:fs.file:\"\n    const end   = decoded.indexOf('?');\n    return decoded.substring(start, end);\n};\n\n// Returns the first visible model for which the lineageID is the same as for the given seedUrn.\n// The is usually not more than 1 anyway, but not guaranteed to be. In case there are more (e.g. for diff), \n// the first matching model determines the issue position.\nexport const findMatchingModel = (viewer, seedUrn) => {\n\n    // Extract decoded lineage urn from seedUrn\n    // We ignore the version part, so that the visible model is also found if it is another model version.\n    // Note: If the model is outside the version range of the issue, it will\n    //\t\t   not be displayed anyway, so that we don't have to check the version here again.\n    const issueLineageId = getLineageId(seedUrn);\n\n    // Find model with matching lineageId\n    const models = viewer.getVisibleModels();\n    for (let i=0; i<models.length; i++) {\n\n        // get lineageId of next model\n        const model     = models[i];\n        const urn       = model.myData.urn;\n        const lineageId = getLineageId(urn);\n\n        // return model if matching\n        if (lineageId === issueLineageId) {\n            return model;\n        }\n    }\n\n    // We didn't find any model that matches the given issue. This should not happen, because \n    // issues are not supposed to be displayed if it doesn't belong to any visible model. \n    // TODO: Investigate whether the assumption above might be temporarily broken due to async calls. E.g., if a model\n    //       was toggled off shortly before the issue was received.\n    console.error('Issue seedUrn does not match with any visible model urn.');\n};\n\n// Unique id for runtime-generated PushPinItems. Note that the id will be overwritten by actual GUIDs if issues are saved or loaded.\n// Note: It would be cleaner to consistently use guids in the first place. But, this requires some refactoring first to get rid\n//       of a hack in RenderHandler.createRenderItem (https://git.autodesk.com/fluent/lmv.js/blob/develop/extensions/Pushpins/PushPins3D/RenderHandler3D.js#L188),\n//       which uses the ID length to distinguish between loaded and newly created issues.\nlet _nextPushPinId = 1;\n\nexport default class PushPinItem {\n    constructor() {\n        this.itemData = {\n            id: (_nextPushPinId++).toString(),\n            attributesVersion: ATTRIBUTES_VERSION,\n            label: 'New',\n            status: 'issues-open',\n            position: { x: 0, y: 0, z: 0 },\n            type: 'issues',\n            objectId: null,\n            externalId: null,\n            viewerState: null,\n            objectData: null\n        };\n\n        // Params affect render or interaction\n        this.selected = false;\n        this.isVisible = true;\n        this.draggable = false;\n        this.selectable = true;\n    }\n\n    get data() {\n        return this.itemData;\n    }\n\n    get visible() {\n        return this.isVisible;\n    }\n\n    set visible(isVisible) {\n        if (!this.hasPosition()) {\n            this.isVisible = false;\n        } else {\n            this.isVisible = isVisible;\n        }\n    }\n\n    defaultAppearance() {\n        const normalSize = 40;\n        const selectedSize = 60;\n\n        return {\n            normalSize,\n            selectedSize,\n            draggableStatus: '-movable',\n            selectedStatus: '-selected'\n        };\n    }\n\n    set(data) {\n        this.itemData = Object.assign({}, this.itemData, data);\n        this.correctDataFormat();\n\n        return this;\n    }\n\n    // Like set, but performs a conversion of position and viewerState from model-local-coords to viewer-coords.\n    // PushPinItems store viewer coordinates, i.e., ready-to-render for the current viewer. Expected input is \n    // in model-local coordinates, i.e., excluding any load-time transforms.\n    //\n    // Note that the model of the Pushpin must be visible/loaded.\n    setLocal(data, viewer) {\n\n        this.set(data);\n\n        // Positions are specified relative to the model the issue belongs to. We have to find this model first.\n        const model = this.findModel(viewer);\n        if (!model) {\n            // If we ever see this message, we are trying to create an issue for a model that is not shown.\n            // If this actually happens, we need some additional fallback logic here, e.g.\n            // set position to undefined first and update on model-show events.\n            console.error('PushPin coordinate conversion failed: PushPin must belong to a visible model.');\n            return;\n        }\n\n        // Why creating a new vector here instead of converting in-place:\n        //  - this.itemData is only a shallow copy and we don't want to modify the src input data\n        //  - Original vectors cannot be assumed to be THREE types.\n        this.itemData.position = new THREE.Vector3().copy(this.itemData.position);\n\n        // Apply matrix that combines all transforms that have been applied to the model during loading.\n        // Note that modelTf may be undefined. This is no error, but just indicates that neither placement nor offset was applied to the model.\n        const modelTf = model.myData.placementWithOffset;\n        if (modelTf) {\n            this.itemData.position.applyMatrix4(modelTf);\n        }\n\n        // Apply this transforms to position. \n        \n        // Replace viewerState by transformed copy\n        // Note that we cannot use placementWithOffset here as we did for position. To make it more confusing,\n        // there is another legacy constraint: viewerState values are currently stored in world-coords, i.e., viewer-coords with added \n        // global offset. The current globalOffset is subtracted when applying the viewerState (see PushPinViewerState.js:restoreViewState).\n        // \n        // It would be easier and more consistent to store viewerState in viewer-coords as well. But this would currently break legacy code,\n        // e.g., older issue-UI versions that don't use createItemFromLocal() are working based on the assumption that viewerStates are in world-coords.\n        const placementTf = model.myData.placementTransform;\n        this.itemData.viewerState = JSON.parse(JSON.stringify(this.itemData.viewerState));\n\n        // Transform viewer state. Note that placementTf may be undefined if the model was loaded without any placement transform.\n        // This is okay and just means that we can skip the transform step.\n        if (placementTf) {\n            transformViewerState(this.itemData.viewerState, placementTf);\n        }\n    }\n\n    // Returns a copy of the PushPin itemData where position and viewerState are provided in model-local coords.\n    // The model that the issue is assigned to must be visible.\n    getLocal(viewer) {\n\n        // Find the model for which the issue was assigned\n        const model = this.findModel(viewer);\n        if (!model) {\n            console.error('PushPin coordinate conversion failed: PushPin must belong to a visible model.');\n            return;\n        }\n\n        let localData = Object.assign({}, this.itemData);\n\n        // Create copies of position and viewerState, so that they can be safely transformed and passed outside.\n        localData.position = new THREE.Vector3().copy(this.itemData.position);\n        localData.viewerState = JSON.parse(JSON.stringify(this.itemData.viewerState));\n\n        // Get matrices to convert between different coordinate spaces. \n        // Note that both matrices may be undefined. This is no error and just indicates that the two coordinate\n        // spaces are the same. \n        const modelLocalToViewer = model.myData.placementWithOffset;\n        const modelLocalToWorld   = model.myData.placementTransform;\n\n        // Convert position from viewer coords to model-local coords.\n        if (modelLocalToViewer) {\n            const viewerToModelLocal = new THREE.Matrix4().getInverse(modelLocalToViewer);\n            localData.position.applyMatrix4(viewerToModelLocal);\n        }\n\n        // Convert viewerState from world-coords to model-local coords.\n        if (modelLocalToWorld) {\n            // Create copy of the viewerState that is transformed from world-coords to model-local coords.\n            const worldToModelLocal  = new THREE.Matrix4().getInverse(modelLocalToWorld);\n            transformViewerState(localData.viewerState, worldToModelLocal);\n        }\n\n        return localData;\n    }\n\n    setObjectId(dbId) {\n        this.itemData.objectId = dbId;\n    }\n\n    setObjectData(res) {\n        const model = res.model;\n        if (!model) {\n            return;\n        }\n        const data = model.getData();\n        if (!data) {\n            return;\n        }\n        const documentNode = model.getDocumentNode();\n        if (!documentNode) {\n            return;\n        }\n        const docNodeData = documentNode.data;\n        if (!docNodeData) {\n            return;\n        }\n        this.itemData.objectData = {\n            guid: docNodeData.guid,\n            urn: data.urn,\n            viewableId: docNodeData.viewableID,\n            viewName: docNodeData.name\n        }\n    }\n\n    setExternalId(externalId) {\n        this.itemData.externalId = externalId;\n    }\n\n    setPosition(newPos) {\n        this.itemData.position = Object.assign({}, newPos);\n    }\n    \n    hasPosition() {\n        return this.itemData.position.x !== null && this.itemData.position.y !== null && this.itemData.position.z !== null;\n    }\n\n    // Finds the visible model whose lineageId matches the seedUrn stored for this issue.\n    // May return undefined if the model is currently not visible.\n    findModel(viewer) {\n        // TODO: Find out why for serialized issues, it is called \"seedUrn\" while for newly created PushPins it is called \"seedURN\". In LMV viewer states, it was \n        //       always \"seedURN\" since several years.\n        let seedUrn = this.itemData.viewerState.seedUrn || this.itemData.viewerState.seedURN;\n        return findMatchingModel(viewer, seedUrn);\n    }\n\n    setViewerState(state) {\n        this.itemData.viewerState = Object.assign({}, state);\n    }\n\n    setOriginalDocumentResolution(originalDocumentResolution) {\n        this.setViewerState({ originalDocumentResolution });\n    }\n\n    correctDataFormat() {\n        const defaultStatusNames = [\n            'draft', 'draft-selected', 'draft-movable', 'open', 'open-selected',\n            'open-movable', 'answered', 'answered-selected', 'answered-movable',\n            'closed', 'closed-selected', 'closed-movable'\n        ];\n\n        defaultStatusNames.forEach((status) => {\n            if (this.itemData.status === status) {\n                this.itemData.status = `${this.itemData.type || 'issues'}-${this.itemData.status}`;\n            }\n        });\n    }\n}\n\nnamespace.PushPinItem = PushPinItem;\n","// Compute the max level from leaflet max resolution texture.\nfunction computeMaxLevel(w, h) {\n    // compute maxLevel that we would get for 1x1 resolution at level 0\n    const lx = Math.ceil(Math.log2(w));\n    const ly = Math.ceil(Math.log2(h));\n    const maxLevel = Math.max(lx, ly);\n\n    // since the actual root tile has tileSize x tileSize, we subtract the skipped levels.\n    return maxLevel;\n}\n\nfunction _clientToWorld(viewer, x, y) {\n    const p = viewer.impl.clientToViewport(x, y);\n    const projMatrix = viewer.impl.camera.projectionMatrix;\n    const projMatrixIns = new THREE.Matrix4();\n    projMatrixIns.getInverse(projMatrix);\n    p.applyMatrix4(projMatrixIns);\n    p.applyMatrix4(viewer.impl.camera.matrixWorld);\n\n    return p;\n}\n\nexport function clientToWorldLeaflet(viewer, x, y) {\n    let loadOptions;\n    let bounds;\n\n    if (viewer.model.getData().isPdf) {\n        loadOptions = Autodesk.Viewing.PDFUtils.getLeafletLoadOptions(viewer);\n        bounds = Autodesk.Viewing.PDFUtils.getLeafletBoundingBox(viewer);\n    } else {\n        const modelData = viewer.model.getData();\n        loadOptions = modelData.loadOptions.loadOptions;\n        bounds = modelData.bbox;\n    }\n\n    const { texWidth, texHeight } = loadOptions;\n\n    const worldPos = _clientToWorld(viewer, x, y);\n    const worldTopLeft = new THREE.Vector3(bounds.min.x, bounds.max.y, 0);\n\n    worldPos.sub(worldTopLeft);\n    const newX = (worldPos.x * texWidth) / bounds.size().x;\n    const newY = (worldPos.y * texHeight) / bounds.size().y;\n\n    const point = new THREE.Vector3(newX, newY, 0);\n\n    const maxLevel = computeMaxLevel(texWidth, texHeight);\n    const scale = Math.pow(2, maxLevel);\n\n    const px = point.x / scale;\n    const py = point.y / scale;\n\n    // x & y are swapped for some reason. Can't change it now for backward compatibility.\n    return new THREE.Vector3(py, px, 0);\n}\n\nexport function clientToWorld(viewer, x, y) {\n    if (viewer.model.getData().isLeaflet) {\n        return clientToWorldLeaflet(viewer, x, y);\n    } else {\n        return _clientToWorld(viewer, x, y);\n    }\n};\n\nexport function applyPdfWorldScaling(viewer, itemData) {\n    if (viewer.model.getData().isLeaflet || viewer.model.getData().isPdf) {\n        const originalDocumentResolution = itemData.viewerState && itemData.viewerState.originalDocumentResolution;\n\n        // In case of leaflet - it changes to world coordinates.\n        const clientPos = worldToClient(viewer, itemData.position, originalDocumentResolution);\n        const worldPos = _clientToWorld(viewer, clientPos.x, clientPos.y);\n        return worldPos;\n    } else {\n        return itemData.position;\n    }\n}\n\nexport function worldToClient(viewer, point, originalDocumentResolution) {\n    if (!viewer.model.getData().isLeaflet && !viewer.model.getData().isPdf) {\n        return viewer.worldToClient(point);\n    }\n\n    let x = point.y;\n    let y = point.x;\n\n    let loadOptions;\n    let bounds;\n\n    if (viewer.model.getData().isPdf) {\n        loadOptions = Autodesk.Viewing.PDFUtils.getLeafletLoadOptions(viewer);\n        bounds = Autodesk.Viewing.PDFUtils.getLeafletBoundingBox(viewer);\n    } else {\n        const modelData = viewer.model.getData();\n        loadOptions = modelData.loadOptions.loadOptions;\n        bounds = modelData.bbox;\n    }\n\n    const { texWidth, texHeight } = loadOptions;\n\n    const maxLevel = computeMaxLevel(texWidth, texHeight);\n    const scale = Math.pow(2, maxLevel);\n    x *= scale;\n    y *= scale;\n\n    // https://jira.autodesk.com/browse/BLMV-2853\n    // In case that the DPI of the current document is different than the DPI of the document where the pushpin has originally created (or edited)\n    // We need to scale the ratio back in order that the pushpin will appear in the same place.\n    const originalDocumentWidth = (originalDocumentResolution && originalDocumentResolution[0]) || texWidth;\n    const dpiCorrection = texWidth / originalDocumentWidth;\n\n    const wx = (x / (texWidth / dpiCorrection)) * bounds.size().x;\n    const wy = (y / (texHeight / dpiCorrection)) * bounds.size().y;\n\n    const worldPos = new THREE.Vector3(bounds.min.x + wx, bounds.max.y + wy, 0);\n\n    if (viewer.model.getData().isPdf) {\n        Autodesk.Viewing.PDFUtils.leafletToPdfWorld(viewer, worldPos);\n    }\n\n    return viewer.impl.worldToClient(worldPos);\n}\n\n// Used for saving pushpins in the backend like they were created in Leaflet, instead of PDF.\nexport function convertPdfToLeaflet (viewer, itemData) {\n    const p = Autodesk.Viewing.PDFUtils.pdfToLeafletWorld(viewer, new THREE.Vector3().copy(itemData.position));\n    itemData.position = { x: p.y - 1, y: p.x, z: 0 }; // x & y are swapped for some reason. Can't change it now for backward compatibility.\n}\n","import PushPinItem from './PushPinItem';\nimport { PUSHPIN_EVENTS } from './PushPinEvents';\nimport { convertPdfToLeaflet, applyPdfWorldScaling, clientToWorld } from './PushPinUtils';\nimport { thumbnailSize, thumbnailOriginalPixelSize, thumbnailMarkerRadius } from './PushPinConstants';\n\nconst namespace = AutodeskNamespace('Autodesk.BIM360.Extension.PushPin');\n\nexport default class PushPinManager extends Autodesk.Viewing.EventDispatcher {\n    constructor(viewer, options = {}) {\n        super();\n\n        this.viewer = viewer;\n        this.options = options;\n\n        this.pushPinList = [];\n        this.selectedItem = null;\n        this.PushPinTypes = {\n            ISSUES: 'issues',\n            RFIS: 'rfis',\n            QUALITY_ISSUES: 'quality_issues'\n        };\n\n        this.pushPinsVisibilityByType = this.getInitialPushpinVisibilityByType();\n        this.pushpinsByType = this.getInitialPushpinsByType();\n        this.create = Promise.resolve();\n    }\n\n    items() {\n        return this.pushPinList;\n    }\n\n    getInitialPushpinsByType() {\n        const cache = {};\n\n        Object.keys(this.PushPinTypes).forEach((issueTypeKey) => {\n            cache[this.PushPinTypes[issueTypeKey]] = {};\n        });\n\n        return cache;\n    }\n\n    getInitialPushpinVisibilityByType() {\n        const cache = {};\n\n        Object.keys(this.PushPinTypes).forEach((typeKey) => {\n            cache[this.PushPinTypes[typeKey]] = true;\n        });\n\n        return cache;\n    }\n\n    shouldGenerateThumbnail(item) {\n        return (this.options.generateIssueThumbnail && (item.data.type === this.PushPinTypes.ISSUES || item.data.type === this.PushPinTypes.QUALITY_ISSUES)) ||\n                (this.options.generateRFIThumbnail && item.data.type === this.PushPinTypes.RFIS);\n    }\n\n    generateThumbnail(item) {\n        if (!this.shouldGenerateThumbnail(item)) {\n            return Promise.resolve(null);\n        }\n\n        return new Promise((resolve, reject) => {\n            const { x, y, z } = item.data.position; // Backup position.\n\n            if (this.viewer.model.getData().isPdf) {\n                convertPdfToLeaflet(this.viewer, item.data);\n            }\n\n            this.fireEvent({ type: PUSHPIN_EVENTS.PUSH_PIN_PREPARING_THUMBNAIL, value: item });\n\n            item.data.position = { x, y, z }; // Restore position.\n\n            let width, height, zoomRatio;\n            let pWorld;\n            let markerPos;\n\n            if (this.viewer.model.getData().isLeaflet) {\n                pWorld = applyPdfWorldScaling(this.viewer, item.data);\n            } else {\n                pWorld = item.data.position;\n            }\n\n            const canvasBounds = this.viewer.impl.getCanvasBoundingClientRect();\n            const ratio = canvasBounds.width / canvasBounds.height;\n\n            if (ratio > 1) {\n                height = Math.floor(Math.max(canvasBounds.height, thumbnailSize));\n                zoomRatio = (height / canvasBounds.height);\n                width = Math.floor(canvasBounds.width * zoomRatio);\n            } else {\n                width = Math.floor(Math.max(canvasBounds.width, thumbnailSize));\n                zoomRatio = (width / canvasBounds.width);\n                height = Math.floor(canvasBounds.height * zoomRatio);\n            }\n\n            const overlayRenderer = (viewer, options) => {\n                const { height, ctx, target, screenshotCamera, onRenderDone } = options;\n                const { canvas } = ctx.targetToCanvas(target);\n\n                markerPos = viewer.worldToClient(pWorld, screenshotCamera).multiplyScalar(zoomRatio);\n\n                const radius = thumbnailMarkerRadius;\n                var ctx2d = canvas.getContext(\"2d\");\n                ctx2d.fillStyle = \"#FF0000\";\n                ctx2d.beginPath();\n                ctx2d.arc(markerPos.x, height - markerPos.y, radius, 0, 2 * Math.PI);\n                ctx2d.closePath();\n                ctx2d.fill();\n\n                onRenderDone(canvas);\n            };\n\n            const getCropBounds = (viewer, camera) => {\n                let cropCenter = markerPos;\n\n                // Make sure crop won't exceed bounds.\n                if (cropCenter.x + thumbnailSize / 2 > width) {\n                    cropCenter.x -= cropCenter.x + thumbnailSize / 2 - width;\n                }\n\n                if (cropCenter.y + thumbnailSize / 2 > height) {\n                    cropCenter.y -= cropCenter.y + thumbnailSize / 2 - height;\n                }\n\n                const clientBounds = new THREE.Box3().expandByPoint(cropCenter);\n                clientBounds.expandByVector(new THREE.Vector3(thumbnailSize / 2, thumbnailSize / 2, 0));\n\n                return clientBounds;\n            };\n\n            let bounds;\n\n            // Zoom in with virtual camera to get the desired thumbnail size.\n            if (this.viewer.model.is2d()) {\n                const thumbnailSizeWorld = clientToWorld(this.viewer, thumbnailOriginalPixelSize, 0);\n                const zeroWorld = clientToWorld(this.viewer, 0, 0);\n                const size = thumbnailSizeWorld.distanceTo(zeroWorld);\n\n                bounds = new THREE.Box3().expandByPoint(pWorld);\n                bounds.expandByVector(new THREE.Vector3(size / 2, size / 2, 0));\n                bounds.min.z = 0;\n                bounds.max.z = 0;\n            }\n\n            const options = {\n                bounds,\n                getCropBounds,\n                overlayRenderer\n            };\n        \n            Autodesk.Viewing.ScreenShot.getScreenShotWithBounds(\n                this.viewer,\n                width,\n                height,\n                (blob, outputWidth, outputHeight) => {\n                    if (!blob) {\n                        return reject('Error while preparing pushpin thumbnail.');\n                    }\n            \n                    Autodesk.Viewing.ScreenShot.blobToImage(blob, outputWidth, outputHeight, (img) => {\n                        return resolve(img);\n                    });\n                },\n                options\n            );\n        }).catch((e) => {\n            // In case of an error in the screenshot creation, continue saving the pushpin with empty thumbnail.\n            console.error(e);\n            return null\n        });\n    }\n\n    // @param {Object} data                - Data to be copied to the PushPin. By default, it must contain a pushpin position.\n    // @param {bool}   [isTriggeringEvent] - Fire PUSH_PIN_CREATED event by default\n    // @param {bool}   [createFromLocal]   - By default, data.position is assumed to be in world-coords (ready-to-render for the viewer).\n    //                                       If true, the position is provided in model-local coordinates instead.\n    // @param {Viewer3D} [viewer}          - Only needed when createFromLocal is true: In this case, we need to find the model for this PushPin to convert the position.\n    createItem(data, isTriggeringEvent = true, createFromLocal = false, viewer = undefined) {\n\n        if (this.getItemById(data.id)) {\n            return null;\n        }\n\n        const newItem = new PushPinItem();\n        \n        if (createFromLocal) {\n            // Set pushPinData - assuming that position and viewerState are given in model-local coords.\n            // In this case, we have to convert them to viewer-coordinates first.\n            newItem.setLocal(data, viewer);\n        } else {\n            newItem.set(data);\n        }\n\n        this.addItem(newItem);\n\n        if (isTriggeringEvent) {\n            this.create(newItem)\n            .then(() => this.generateThumbnail(newItem))\n            .then((thumbnail) => {\n                const { x, y, z } = newItem.data.position; // Backup position.\n\n                if (this.viewer.model.getData().isPdf) {\n                    convertPdfToLeaflet(this.viewer, newItem.data);\n                }\n\n                this.fireEvent({ type: PUSHPIN_EVENTS.PUSH_PIN_CREATED_EVENT, value: newItem, thumbnail });\n\n                newItem.data.position = { x, y, z }; // Restore position.\n            });\n        }\n\n        return newItem;\n    }\n\n    addItems(dataArray, createFromLocal, viewer) {\n        dataArray.forEach((pushPinData) => {\n            if (this.viewer.model.getData().isPdf) {\n                const { x, y, z } = applyPdfWorldScaling(this.viewer, pushPinData);\n                pushPinData.position = { x, y, z };\n            }\n\n            this.createItem(pushPinData, false, createFromLocal, viewer);\n        });\n\n        this.fireEvent({ type: PUSHPIN_EVENTS.PUSH_PIN_ITEMS_LOADED, value: null });\n    }\n\n    removeAllItems() {\n        this.selectedItem = null;\n        this.pushPinList = [];\n\n        // Update local pushpins cache\n        this.pushpinsByType = this.getInitialPushpinsByType();\n\n        this.fireEvent({ type: PUSHPIN_EVENTS.PUSH_PIN_REMOVE_ALL_EVENT });\n    }\n\n    addItem(item) {\n        if (item.data && item.data.id) {\n            const idx = this.getItemIndexById(item.data.id);\n\n            if (idx > -1) {\n                return false;\n            }\n\n            let type = item.data.type;\n\n            if (type && this.pushPinsVisibilityByType) {\n                item.visible = this.pushPinsVisibilityByType[type];\n            }\n\n            type = type || this.PushPinTypes.ISSUES;\n\n            // Update local pushpins cache, handle only pushpins with supported type\n            if (this.pushpinsByType[type]) {\n                this.pushpinsByType[type][item.data.id] = item.data;\n            }\n\n            this.pushPinList.unshift(item);\n            return true;\n        }\n        return false;\n    }\n\n    removeItemById(id) {\n        if (this.selectedItem && this.selectedItem.data.id === id) {\n            this.selectedItem = null;\n        }\n        const idx = this.getItemIndexById(id);\n\n        if (idx > -1) {\n            const item = this.pushPinList.splice(idx, 1)[0];\n\n            const type = item.data.type;\n\n            // Update local pushpins cache, handle only pushpins with supported type\n            if (type && this.pushpinsByType[type]) {\n                delete this.pushpinsByType[type][id];\n            }\n\n            this.fireEvent({ type: PUSHPIN_EVENTS.PUSH_PIN_REMOVED_EVENT, value: item });\n            return item;\n        }\n\n        return null;\n    }\n\n    removeItemsByType(type) {\n        const pushPinTypeObject = this.pushpinsByType[type] || {};\n\n        Object.keys(pushPinTypeObject).forEach((id) => {\n            this.removeItemById(id);\n        });\n    }\n\n    updateItemById(id, data) {\n        // 1. validate data & create new one\n        const item = this.getItemById(id);\n        if (!item) {\n            return null;\n        }\n        const idx = this.getItemIndexById(item.data.id);\n\n        if (!data || !data.id || data.type !== item.data.type) {\n            return null;\n        }\n\n        if (this.viewer.model.getData().isPdf) {\n            const { x, y, z } = applyPdfWorldScaling(this.viewer, data);\n            data.position = { x, y, z };\n        }\n\n        // 2. update data\n        item.set(data);\n\n        // 3. update local pushpins cache, handle only pushpins with supported type\n        const type = item.data.type;\n\n        if (type && this.pushpinsByType[type]) {\n            delete this.pushpinsByType[type][id];\n            this.pushpinsByType[type][item.data.id] = item.data;\n        }\n        this.pushPinList[idx] = item;\n\n        this.fireEvent({ type: PUSHPIN_EVENTS.PUSH_PIN_UPDATE_EVENT, value: item });\n\n        return item;\n    }\n\n    getItemById(id) {\n        const idx = this.getItemIndexById(id);\n        return (idx > -1) ? this.pushPinList[idx] : null;\n    }\n\n    getItemIndexById(id) {\n        let idx = -1;\n        this.pushPinList.every((item, index) => {\n            if (item.data.id === id) {\n                idx = index;\n                return false;\n            }\n            return true;\n        });\n        return idx;\n    }\n\n    getItemCountByType(type) {\n        const pushPinTypeObject = this.pushpinsByType[type] || {};\n\n        return Object.keys(pushPinTypeObject).length;\n    }\n\n    getSelectedItem() {\n        return this.selectedItem;\n    }\n\n    selectOne(id) {\n        if (!this.selectedItem || (this.selectedItem.data.id !== id)) {\n            const oldOne = this.selectedItem;\n            this.selectedItem = this.getItemById(id);\n\n            if (oldOne !== this.selectedItem) {\n                oldOne && (oldOne.selected = false);\n                this.selectedItem && (this.selectedItem.selected = true);\n                this.fireEvent({ type: PUSHPIN_EVENTS.PUSH_PIN_SELECTED_EVENT, value: this.selectedItem });\n            }\n        }\n\n        return this.selectedItem;\n    }\n\n    selectNone() {\n        this.selectOne(null);\n    }\n\n    getVisibleByType(type) {\n        return this.pushPinsVisibilityByType[type];\n    }\n\n    setVisibleByType(type, isVisible) {\n        this.pushPinsVisibilityByType[type] = isVisible;\n        const pushPinTypeObject = this.pushpinsByType[type] || {};\n\n        Object.keys(pushPinTypeObject).forEach((id) => {\n            const item = this.getItemById(id);\n\n            if (item) {\n                item.visible = isVisible;\n            }\n        });\n\n        this.fireEvent({ type: PUSHPIN_EVENTS.PUSH_PIN_VISIBILITY_EVENT, value: { type, isVisible } });\n    }\n\n    addEventListener(event, func) {\n        if (!this.hasEventListener(event, func)) {\n            super.addEventListener(event, func);\n        }\n    }\n\n    setCreateFunction(func) {\n        this.create = func;\n    }\n\n    removeCreateFunction(func) {\n        if (func === this.create) {\n            this.create = Promise.resolve();\n        }\n    }\n}\n\nnamespace.PushPinManager = PushPinManager;\n","export default class HTMLPushPinLabel {\n    constructor() {\n        this.container = document.createElement('div');\n        this.container.className = 'leaflet-text-label';\n        this.text = '';\n        this.dirty = false;\n    }\n\n    setParent(parent) {\n        if (this.container.parentNode) {\n            this.container.parentNode.removeChild(this.container);\n        }\n\n        if (parent) {\n            parent.appendChild(this.container);\n        }\n    }\n\n    set(textString) {\n        if (this.text === textString) {\n            return;\n        }\n\n        this.container.innerHTML = '<span>' + textString + '</span>';\n        this.text = textString;\n\n        const textWidth = this.container.firstChild.clientWidth;\n        let bgWidth = textWidth + 20;\n\n        if (bgWidth < 60) {\n            bgWidth = 60;\n        }\n\n        this.container.style.width = bgWidth.toString() + 'px';\n\n        let top = 10;\n        let left = 0;\n\n        if (this.container.clientWidth !== 0) {\n            const containerHeight = this.container.parentNode.clientHeight;\n            top += containerHeight;\n\n            const containerWidth = this.container.parentNode.clientWidth;\n            left = (containerWidth - this.container.clientWidth) * 0.5;\n        } else {\n            // if label client width is null, need refresh label again.\n            return;\n        }\n\n        top = top.toString() + 'px';\n        left = left.toString() + 'px';\n\n        if (this.container.style.top !== top) {\n            this.container.style.top = top;\n        }\n\n        if (this.container.style.left !== left) {\n            this.container.style.left = left;\n        }\n        this.dirty = false;\n    }\n}\n\nconst namespace = AutodeskNamespace('Autodesk.BIM360.Extension.PushPin');\n\nnamespace.HTMLPushPinLabel = HTMLPushPinLabel;\n","import HTMLPushPinLabel from '../PushPinLabel/HTMLPushPinLabel';\n\nexport default class PushPinBillboardLabel extends HTMLPushPinLabel {\n    constructor(marker, labelText) {\n        super();\n\n        this.createLabel(marker, labelText);\n        this.visible = true;\n    }\n\n    createLabel(marker, labelText) {\n        super.setParent(marker);\n        this.update(labelText);\n    }\n\n    get isVisible() {\n        return this.visible;\n    }\n\n    set isVisible(isVisible) {\n        this.visible = isVisible;\n    }\n\n    update(labelText) {\n        super.set(labelText);\n\n        this.container.style.top = PushPinBillboardLabel.TOP_PADDING;\n        this.container.style.left = (this.container.style.width / 3) + 'px';\n    }\n\n    show() {\n        this.visible = true;\n        this.container.style.display = 'block';\n    }\n\n    hide() {\n        this.visible = false;\n        this.container.style.display = 'none';\n    }\n}\n\nPushPinBillboardLabel.TOP_PADDING = '50px';\n\nconst namespace = AutodeskNamespace('Autodesk.BIM360.Extension.PushPin');\n\nnamespace.PushPinBillboardLabel = PushPinBillboardLabel;\n","import PushPinBillboardLabel from '../PushPinLabel/PushPinBillboardLabel';\nimport { applyPdfWorldScaling } from '../PushPinUtils';\nimport { statusHexValues, moveableIcon, markerOffsets } from '../PushPinConstants';\n\nexport default class PushPinBillboardTool2D {\n    constructor(viewer) {\n        this.names = ['pushpinBillboard2D'];\n\n        this.viewer = viewer;\n        this.active = false;\n\n        this.pushpins = [];\n        this.selectedPushpin = null;\n        this.dirty = false;\n        this.camera = this.viewer.navigation.getCamera();\n        this.curCameraZ = 0;\n        this.curCameraRotationZ = 0;\n    }\n\n    getNames() {\n        return this.names;\n    }\n\n    getName() {\n        return this.names[0];\n    }\n\n    isActive() {\n        return this.active;\n    }\n\n    activate(name) {\n        if (name === this.getName()) {\n            this.active = true;\n\n            this.onCameraChangeBinded = e => this.onCameraChange(e);\n            this.handleResizeBinded = e => this.handleResize(e);\n\n            this.viewer.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT, this.onCameraChangeBinded);\n            this.viewer.addEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT, this.handleResizeBinded);\n\n            this.createMarkerContainer();\n        }\n    }\n\n    deactivate(name) {\n        if (name === this.getName()) {\n            this.active = false;\n\n            this.viewer.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT, this.onCameraChangeBinded);\n            this.viewer.removeEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT, this.handleResizeBinded);\n        }\n    }\n\n    onCameraChange(e) {\n        if (e.camera.position.z.toPrecision(5) !== this.curCameraZ.toPrecision(5) || e.camera.rotation.z.toPrecision(5) !== this.curCameraRotationZ.toPrecision(5)) {\n            this.updatePushpinsProjection();\n            this.curCameraZ = e.camera.position.z;\n            this.curCameraRotationZ = e.camera.rotation.z;\n        } else {\n            this.updateContainerProjection();\n        }\n    }\n\n    createMarkerContainer() {\n        if (!this.pushpinContainer) {\n            this.pushpinContainer = this.viewer.appendOrderedElementToViewer('pushpin-container');\n            this.pushpinContainer.className = 'pushpin-container';\n            this.pushpinContainer.position = new THREE.Vector3();\n        }\n    }\n\n    project(pushpin) {\n        const position = pushpin.marker.intersectPoint;\n        const containerBounds = this.viewer.navigation.getScreenViewport();\n        const p = new THREE.Vector3().copy(position);\n\n        const matrix = new THREE.Matrix4();\n\n        matrix.multiplyMatrices(this.camera.projectionMatrix, this.camera.matrixWorldInverse);\n\n        p.applyProjection(matrix);\n\n        return new THREE.Vector3(\n            Math.round(((p.x + 1) / 2) * containerBounds.width),\n            Math.round(((-p.y + 1) / 2) * containerBounds.height),\n            p.z\n        );\n    }\n\n    unproject(position) {\n        const containerBounds = this.viewer.navigation.getScreenViewport();\n        const p = new THREE.Vector3();\n\n        p.x = ((position.x / containerBounds.width) * 2) - 1;\n        p.y = -(((position.y / containerBounds.height) * 2) - 1);\n        p.z = position.z;\n        p.unproject(this.camera);\n\n        return p;\n    }\n\n    initNewPushpin(item) {\n        if (this.viewer.model.getData().isLeaflet) {\n            this.convertLeafletPosition(item);\n\n            // https://jira.autodesk.com/browse/BLMV-2918\n            // Update originalDocumentResolution when saving / updating a pushpin, in order to make sure that the pushpin will\n            // maintain the same position for different DPIs of the same document.\n            const modelData = this.viewer.model.getData();\n            const options = modelData.loadOptions.loadOptions;\n            item.setOriginalDocumentResolution([options.texWidth, options.texHeight]);\n        } else {\n            item.intersectPoint = item.data.position;\n        }\n\n        this.pushpins.push(item);\n\n        this.createMarker(item);\n\n        item.draggable ? this.enableDragging(item) : this.disableDragging(item);\n        item.visible ? this.showMarker(item.marker) : this.hideMarker(item.marker);\n    }\n\n    createPushpin(item) {\n        this.initNewPushpin(item);\n        this.selectPushpin(item);\n\n        return Promise.resolve();\n    }\n\n    convertLeafletPosition(item) {\n        const worldPos = applyPdfWorldScaling(this.viewer, item.data);\n        item.intersectPoint = { x: worldPos.x, y: worldPos.y, z: worldPos.z };\n    }\n\n    loadPushpin(item) {\n        this.initNewPushpin(item);\n\n        return Promise.resolve();\n    }\n\n    createMarker(pushpin) {\n        const marker = document.createElement('div');\n\n        const className = (pushpin.data.type === 'rfis') ? 'rfi-billboard-marker' : 'pushpin-billboard-marker';\n\n        marker.classList.add(className);\n        marker.style.backgroundColor = statusHexValues[pushpin.data.status];\n        marker.style.boxShadow = '0px 1px 6px rgba(0, 0, 0, 0.6)';\n\n        this.pushpinContainer.appendChild(marker);\n\n        marker.id = pushpin.data.id;\n        marker.intersectPoint = pushpin.intersectPoint;\n\n        pushpin.marker = marker;\n        this.setMarkerPosition(pushpin);\n\n        // first pushpin\n        if (this.pushpins.length === 1) {\n            this.setPushpinContainerPosition(pushpin);\n        } else {\n            const newPosX = pushpin.marker.position.x - this.pushpinContainer.position.x;\n            const newPosY = pushpin.marker.position.y - this.pushpinContainer.position.y;\n            pushpin.marker.style.transform = `translate(${newPosX}px, ${newPosY}px)`;\n        }\n    }\n\n    removePushpin(pushpin) {\n        this.pushpins = this.pushpins.filter((curPushpin) => {\n            if (this.selectedPushpin && this.selectedPushpin.data.id === pushpin.data.id) {\n                this.selectedPushpin = null;\n            }\n\n            return curPushpin.data.id !== pushpin.data.id;\n        });\n\n        this.destroyMarker(pushpin);\n    }\n\n    removeAll() {\n        this.pushpins.forEach((pushpin) => {\n            this.removePushpin(pushpin);\n        });\n    }\n\n    destroyMarker(pushpin) {\n        this.destroyLabel(pushpin);\n        this.pushpinContainer.removeChild(pushpin.marker);\n        pushpin.marker = undefined;\n    }\n\n    destroyLabel(pushpin) {\n        if (pushpin.label) {\n            pushpin.marker.removeChild(pushpin.label.container);\n            pushpin.label = undefined;\n        }\n    }\n\n    setPushpinContainerPosition(pushpin) {\n        const xTranslate = pushpin.marker.position.x - (markerOffsets.markerOffsetWidth / 2);\n        const yTranslate = pushpin.marker.position.y - (markerOffsets.markerOffsetWidth / 2);\n\n        this.pushpinContainer.initPos = pushpin.intersectPoint;\n        this.pushpinContainer.position.x = pushpin.marker.position.x;\n        this.pushpinContainer.position.y = pushpin.marker.position.y;\n        this.pushpinContainer.style.transform = `translate(${xTranslate}px, ${yTranslate}px)`;\n    }\n\n    setMarkerPosition(pushpin) {\n        pushpin.marker.position = this.project(pushpin);\n    }\n\n    updateStyle(status, size, hex) {\n        statusHexValues[status] = hex;\n        this.dirty = true;\n    }\n\n    updateContainerProjection() {\n        if (this.pushpins.length > 0) {\n            const newPosition = { marker: { intersectPoint: this.pushpinContainer.initPos } };\n            const updatedPosition = this.pushpinContainer.position = this.project(newPosition);\n            const offsetWidth = markerOffsets.markerOffsetWidth;\n\n            const xTranslate = updatedPosition.x - (offsetWidth / 2);\n            const yTranslate = updatedPosition.y - (offsetWidth / 2);\n\n            this.pushpinContainer.style.transform = `translate(${xTranslate}px, ${yTranslate}px)`;\n        }\n\n        // Update the DOM\n        this.pushpins.forEach((pushpin) => {\n            this.updatePushpin(pushpin);\n        });\n\n        this.dirty = false;\n    }\n\n    updatePushpinsProjection() {\n        this.redraw = true;\n        this.pushpins.forEach((pushpin) => {\n            this.setMarkerPosition(pushpin);\n        });\n\n        this.pushpins.forEach((pushpin) => {\n            if (this.redraw) {\n                this.setPushpinContainerPosition(pushpin);\n                this.redraw = false;\n            }\n\n            const xPos = pushpin.marker.position.x - this.pushpinContainer.position.x;\n            const yPos = pushpin.marker.position.y - this.pushpinContainer.position.y;\n            pushpin.marker.style.transform = `translate(${xPos}px, ${yPos}px)`;\n\n            this.updatePushpin(pushpin);\n        });\n\n        this.dirty = false;\n    }\n\n    updatePushpin(pushpin) {\n        if (this.dirty) {\n            if (pushpin.label) {\n                pushpin.label.update(pushpin.data.label);\n            }\n\n            pushpin.draggable ? this.enableDragging(pushpin) : this.disableDragging(pushpin);\n            pushpin.marker.style.backgroundColor = statusHexValues[pushpin.data.status];\n            pushpin.visible ? this.showMarker(pushpin.marker) : this.hideMarker(pushpin.marker);\n        }\n    }\n\n    setDirty() {\n        this.dirty = true;\n    }\n\n    selectPushpin(pushpin) {\n        this.deselect();\n        this.viewer.clearSelection();\n\n        pushpin.label = new PushPinBillboardLabel(pushpin.marker, pushpin.data.label);\n        pushpin.marker.classList.add('selected');\n\n        this.selectedPushpin = pushpin;\n        pushpin.draggable ? this.enableDragging(pushpin) : this.disableDragging(pushpin);\n    }\n\n    deselect() {\n        if (this.selectedPushpin) {\n            this.destroyLabel(this.selectedPushpin);\n            this.selectedPushpin.marker.style.pointerEvents = 'none';\n            this.selectedPushpin.marker.classList.remove('selected');\n            this.selectedPushpin = null;\n        }\n    }\n\n    enableDragging(item) {\n        if (this.selectedPushpin && this.selectedPushpin.data.id === item.data.id) {\n            item.marker.style.pointerEvents = 'auto';\n        }\n\n        item.marker.style.backgroundImage = moveableIcon;\n    }\n\n    disableDragging(item) {\n        const selectedItem = item || this.selectedPushpin;\n\n        selectedItem.marker.style.pointerEvents = 'none';\n        selectedItem.marker.style.backgroundImage = 'none';\n        selectedItem.draggable = false;\n    }\n\n    showMarker(marker) {\n        marker.style.display = '';\n    }\n\n    hideMarker(marker) {\n        marker.style.display = 'none';\n    }\n\n    showMarkers() {\n        this.pushpins.forEach((pushpin) => {\n            (pushpin.visible) ? this.showMarker(pushpin.marker) : this.hideMarker(pushpin.marker);\n        });\n    }\n\n    hideMarkers() {\n        this.pushpins.forEach((pushpin) => {\n            this.hideMarker(pushpin.marker);\n        });\n\n        if (this.selectedPushpin) {\n            this.destroyLabel(this.selectedPushpin);\n        }\n    }\n\n\n    handleButtonDown(event, button) {\n        return false;\n    }\n\n    handleButtonUp(event, button) {\n        return false;\n    }\n\n    handleResize() {\n        setTimeout(() => {\n            this.updatePushpinsProjection();\n        }, 1);\n    }\n}\n\nconst namespace = AutodeskNamespace('Autodesk.BIM360.Extension.PushPin');\n\nnamespace.PushPinBillboardTool2D = PushPinBillboardTool2D;\n","export default class PushPinInputHandler {\n    constructor(pushpinRenderer) {\n        this.pushpin = null;\n        this.pushpinRenderer = pushpinRenderer;\n        this.mousePosition = { x: 0, y: 0 };\n\n        this.onTouchDragBinded = this.onTouchDrag.bind(this);\n        this.onMouseMoveBinded = this.onMouseMove.bind(this);\n        this.onMouseUpBinded = this.onMouseUp.bind(this);\n        this.onMouseDownBinded = this.onMouseDown.bind(this);\n        this.onHammerInputBinded = this.onHammerInput.bind(this);\n\n        this.mouseEnabled = false;\n        this.mousePrevValue = false;\n        this.lock = false;\n    }\n\n    // Convert Hammer touch-event X,Y into mouse-event X,Y.\n    static convertEventHammerToMouse(event) {\n        event.shiftKey = false;\n        event.clientX = event.pointers[0].clientX;\n        event.clientY = event.pointers[0].clientY;\n    }\n\n    processMouseEvent(event) {\n        this.mousePosition.x = event.clientX;\n        this.mousePosition.y = event.clientY;\n    }\n\n    attachTo(pushpin) {\n        if (this.pushpin) {\n            this.detach();\n        }\n\n        this.pushpin = pushpin;\n\n        if (Autodesk.Viewing.isTouchDevice()) {\n            this.hammer = new Autodesk.Viewing.Hammer.Manager(pushpin, {\n                recognizers: [\n                    Autodesk.Viewing.GestureRecognizers.drag\n                ],\n                inputClass: Autodesk.Viewing.isIE11 ? Hammer.PointerEventInput : Hammer.TouchInput\n            });\n\n            this.hammer.on('dragstart dragmove dragend', this.onTouchDragBinded);\n            this.hammer.on('hammer.input', this.onHammerInputBinded);\n        }\n\n        if (!Autodesk.Viewing.isMobileDevice()) {\n            this.enableMouseButtons(true);\n        }\n    }\n\n    onHammerInput(event) {\n        this.setMouseDisabledWhenTouching(event);\n    }\n\n    setMouseDisabledWhenTouching(event) {\n        if (event.isFirst && !this.lock) {\n            this.enableMouseButtons(false);\n            this.lock = true;\n        } else if (event.isFinal) {\n            setTimeout(() => {\n                this.enableMouseButtons(this.mousePrevValue);\n                this.lock = false;\n            }, 10);\n        }\n    }\n\n    enableMouseButtons(state) {\n        if (state && !this.mouseEnabled) {\n            this.pushpin.addEventListener('mousedown', this.onMouseDownBinded);\n            this.pushpinRenderer.viewer.container.addEventListener('mousemove', this.onMouseMoveBinded);\n            this.pushpinRenderer.viewer.container.addEventListener('mouseup', this.onMouseUpBinded);\n        } else if (!state && this.mouseEnabled) {\n            this.pushpin.removeEventListener('mousedown', this.onMouseDownBinded);\n            this.pushpinRenderer.viewer.container.removeEventListener('mousemove', this.onMouseMoveBinded);\n            this.pushpinRenderer.viewer.container.removeEventListener('mouseup', this.onMouseUpBinded);\n        }\n\n        this.mousePrevValue = this.mouseEnabled;\n        this.mouseEnabled = state;\n    }\n\n    detach() {\n        if (this.hammer) {\n            this.hammer.destroy();\n        }\n\n        this.pushpinRenderer.viewer.container.removeEventListener('mousemove', this.onMouseMoveBinded);\n        this.pushpinRenderer.viewer.container.removeEventListener('mouseup', this.onMouseUpBinded);\n\n        if (this.pushpin) {\n            this.pushpin.removeEventListener('mousedown', this.onMouseDownBinded);\n\n            this.pushpin = null;\n        }\n\n        this.mouseEnabled = false;\n    }\n\n    onMouseMove(event) {\n        this.processMouseEvent(event);\n        this.pushpinRenderer.handleMouseMove(event);\n        event.preventDefault();\n    }\n\n    onMouseDown(event) {\n        this.processMouseEvent(event);\n        this.pushpinRenderer.handleMouseDown(event);\n        event.preventDefault();\n    }\n\n    onMouseUp(event) {\n        this.processMouseEvent(event);\n        this.pushpinRenderer.handleMouseUp(event);\n        event.preventDefault();\n    }\n\n    onTouchDrag(event) {\n        PushPinInputHandler.convertEventHammerToMouse(event);\n        switch (event.type) {\n            case 'dragstart':\n                this.onMouseDown(event);\n                break;\n            case 'dragmove':\n                this.onMouseMove(event);\n                break;\n            case 'dragend':\n                this.onMouseUp(event);\n                break;\n            default:\n                break;\n        }\n\n        event.preventDefault();\n    }\n}\n\nconst namespace = AutodeskNamespace('Autodesk.BIM360.Extension.PushPin');\nnamespace.PushPinInputHandler = PushPinInputHandler;\n","import PushPinBillboardTool2D from '../PushPins2D/PushPinBillboardTool2D';\nimport PushPinInputHandler from '../PushPinInputHandler';\nimport { clientToWorld, convertPdfToLeaflet } from '../PushPinUtils';\nimport { PUSHPIN_EVENTS } from '../PushPinEvents';\n\nexport default class RenderHandler2D {\n    constructor(viewerApi, pushPinManager) {\n        this.viewer = viewerApi;\n        this.pushPinManager = pushPinManager;\n        this.pushpinDirty = false;\n        this.selectedItem = null;\n\n        this.onSelectedChangedBind = e => this.onSelectedChanged(e);\n        this.onRemoveBind = e => this.onRemove(e);\n        this.onRemoveAllBind = e => this.onRemoveAll(e);\n        this.onModifyBind = e => this.onModify(e);\n        this.onUpdateBind = e => this.onUpdate(e);\n        this.createBind = e => this.create(e);\n        this.onVisibilityChangedBind = e => this.onVisibilityChanged(e);\n    }\n\n    register() {\n        this.pushpinBillboardTool = new PushPinBillboardTool2D(this.viewer);\n        this.viewer.toolController.registerTool(this.pushpinBillboardTool);\n    }\n\n    deregister() {\n        if (this.pushpinBillboardTool) {\n            this.viewer.toolController.deregisterTool(this.pushpinBillboardTool);\n            this.pushpinBillboardTool = null;\n        }\n    }\n\n    activate() {\n        if (!this.pushpinBillboardTool.isActive()) {\n            this.viewer.toolController.activateTool('pushpinBillboard2D');\n        }\n\n        this.inputHandler = new PushPinInputHandler(this);\n\n        this.pushPinManager.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_SELECTED_EVENT, this.onSelectedChangedBind);\n        this.pushPinManager.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_REMOVED_EVENT, this.onRemoveBind);\n        this.pushPinManager.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_REMOVE_ALL_EVENT, this.onRemoveAllBind);\n        this.pushPinManager.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_MODIFY_EVENT, this.onModifyBind);\n        this.pushPinManager.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_UPDATE_EVENT, this.onUpdateBind);\n        this.pushPinManager.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_VISIBILITY_EVENT, this.onVisibilityChangedBind);\n        this.pushPinManager.setCreateFunction(this.createBind);\n\n        return true;\n    }\n\n    deactivate() {\n        if (this.pushpinBillboardTool.isActive()) {\n            this.viewer.toolController.deactivateTool('pushpinBillboard2D');\n        }\n\n        this.inputHandler.detach();\n\n        this.pushPinManager.removeEventListener(PUSHPIN_EVENTS.PUSH_PIN_SELECTED_EVENT, this.onSelectedChangedBind);\n        this.pushPinManager.removeEventListener(PUSHPIN_EVENTS.PUSH_PIN_REMOVED_EVENT, this.onRemoveBind);\n        this.pushPinManager.removeEventListener(PUSHPIN_EVENTS.PUSH_PIN_REMOVE_ALL_EVENT, this.onRemoveAllBind);\n        this.pushPinManager.removeEventListener(PUSHPIN_EVENTS.PUSH_PIN_MODIFY_EVENT, this.onModifyBind);\n        this.pushPinManager.removeEventListener(PUSHPIN_EVENTS.PUSH_PIN_UPDATE_EVENT, this.onUpdateBind);\n        this.pushPinManager.removeEventListener(PUSHPIN_EVENTS.PUSH_PIN_VISIBILITY_EVENT, this.onVisibilityChangedBind);\n        this.pushPinManager.removeCreateFunction(this.createBind);\n\n    }\n\n    setPushpinDirty() {\n        this.pushpinDirty = true;\n    }\n\n    onSelectedChanged(event) {\n        if (event.value) {\n            this.selectedItem = event.value;\n\n            if (!this.selectedItem.marker) {\n                this.create(this.selectedItem);\n            }\n\n            this.pushpinBillboardTool.selectPushpin(this.selectedItem);\n            this.focusCameraOnSelectedItem(this.selectedItem);\n\n            if (this.selectedItem.draggable) {\n                this.enableItemDragging(this.selectedItem);\n            }\n\n            this.viewer.dispatchEvent({ type: PUSHPIN_EVENTS.PUSH_PIN_SELECTED_EVENT });\n        } else {\n            this.deselectItem();\n            this.pushpinBillboardTool.deselect();\n        }\n\n        this.setPushpinDirty();\n    }\n\n    deselectItem() {\n        this.selectedItem = null;\n        this.inputHandler.detach();\n    }\n\n    onRemove(event) {\n        if (this.selectedItem && event.value.data.id === this.selectedItem.data.id) {\n            this.deselectItem();\n        }\n\n        if (event.value && event.value.marker) {\n            this.pushpinBillboardTool.removePushpin(event.value);\n        }\n    }\n\n    onRemoveAll() {\n        this.deselectItem();\n        this.pushpinBillboardTool.removeAll();\n    }\n\n    onModify() {\n        this.pushpinDirty = true;\n    }\n\n    onVisibilityChanged() {\n        this.pushpinBillboardTool.showMarkers();\n    }\n\n    onUpdate() {\n        setTimeout(() => {\n            this.setPushpinDirty();\n\n            // it could happen that the extension was removed in the meantime\n            this.pushpinBillboardTool && this.pushpinBillboardTool.setDirty();\n            const selectedItem = this.pushPinManager ? this.pushPinManager.getSelectedItem() : null;\n\n            if (!selectedItem) {\n                return;\n            }\n\n            (selectedItem.draggable && selectedItem.marker) ?\n                this.enableItemDragging(selectedItem) :\n                this.disableItemDragging(selectedItem);\n        }, 1);\n    }\n\n    enableItemDragging(item) {\n        this.pushpinBillboardTool.enableDragging(item);\n        this.inputHandler.attachTo(item.marker);\n    }\n\n    disableItemDragging(item) {\n        this.pushpinBillboardTool.disableDragging(item);\n        this.inputHandler.detach();\n    }\n\n    create(item) {\n        // iOS have a special case where they already have the UUID, so we act like we are re-selecting an existing item\n        return this.createRenderItem(item, Autodesk.Viewing.isIOSDevice());\n    }\n\n    createRenderItem(item, reselect) {\n        // Make sure it's a uuid and not a growing counter\n        const isLoaded = (item.data.id.length > 20);\n\n        this.pushpinBillboardTool.deselect();\n\n        let promise;\n        if (isLoaded && !reselect) {\n            promise = this.pushpinBillboardTool.loadPushpin(item);\n        } else {\n            promise = this.pushpinBillboardTool.createPushpin(item);\n            this.pushPinManager.selectOne(item.data.id);\n        }\n\n        return promise;\n    }\n\n    updatePattern(status, size, hex) {\n        this.pushpinBillboardTool.updateStyle(status, size, hex);\n\n        this.setPushpinDirty();\n    }\n\n    focusCameraOnSelectedItem(item) {\n        if (item.marker) {\n            const padding = 0.2;\n\n            const modelBounds = this.viewer.utilities.getBoundingBox(true);\n            const modelWidth = (modelBounds.max.x - modelBounds.min.x) * padding;\n            const modelHeight = (modelBounds.max.y - modelBounds.min.y) * padding;\n\n            const min = new THREE.Vector3(item.marker.intersectPoint.x - modelWidth, item.marker.intersectPoint.y - modelHeight, 0);\n            const max = new THREE.Vector3(item.marker.intersectPoint.x + modelWidth, item.marker.intersectPoint.y + modelHeight, 0);\n            const bounds = new THREE.Box3(min, max);\n\n            this.viewer.navigation.fitBounds(false, bounds, true);\n        }\n    }\n\n    render() {\n        if (!this.pushPinManager || !this.viewer.model) {\n            return;\n        }\n\n        this.pushPinManager.items().reverse().forEach((item) => {\n            if (!item.marker) {\n                this.createRenderItem(item, false);\n            }\n        });\n\n        if (this.pushpinDirty) {\n            this.pushpinBillboardTool.updateContainerProjection();\n            this.pushpinDirty = false;\n        }\n    }\n\n    findIntersections(event) {\n        const mouseX = event.clientX;\n        const mouseY = event.clientY;\n\n        let hitItem = null;\n\n        this.pushPinManager.items().some((item) => {\n            if (item.selectable && item.marker) {\n                const bb = item.marker.getBoundingClientRect();\n                if (mouseX > bb.left && mouseX < bb.left + bb.width && mouseY > bb.top && mouseY < bb.top + bb.height) {\n                    hitItem = item;\n                    return true;\n                }\n            }\n            return false;\n        });\n\n        return hitItem;\n    }\n\n    handleMouseMove(e) {\n        function mouseCoords(ev) {\n            if (ev.pageX || ev.pageY) {\n                return { x: ev.pageX, y: ev.pageY };\n            }\n\n            return {\n                x: (ev.clientX + document.body.scrollLeft) - document.body.clientLeft,\n                y: (ev.clientY + document.body.scrollTop) - document.body.clientTop\n            };\n        }\n\n        if (this.selectedItem.marker && this.selectedItem.marker.startDragging) {\n            // only on first mouse movement\n            if (!this.newX) {\n                this.selectedItem.marker.style.transform = 'translate(0px, 0px)';\n            }\n\n            const mousePos = mouseCoords(e);\n\n            this.newX = mousePos.x - this.mouseOffset.x;\n            this.newY = mousePos.y - this.mouseOffset.y;\n\n            // Check left, top, right, bottom\n            const containerBounds = this.viewer.navigation.getScreenViewport();\n            const wi = this.selectedItem.marker.clientWidth;\n            const hi = this.selectedItem.marker.clientHeight;\n\n            if (this.newX < 5) {\n                this.newX = 0;\n            }\n            if (this.newY < 5) {\n                this.newY = 0;\n            }\n            if (containerBounds.width - 5 < this.newX + wi) {\n                this.newX = containerBounds.width - wi;\n            }\n            if (containerBounds.height - 5 < this.newY + hi) {\n                this.newY = containerBounds.height - hi;\n            }\n\n            const containerPosX = this.pushpinBillboardTool.pushpinContainer.position.x;\n            const containerPosY = this.pushpinBillboardTool.pushpinContainer.position.y;\n\n            this.selectedItem.marker.style.left = `${this.newX - containerPosX}px`;\n            this.selectedItem.marker.style.top = `${this.newY - containerPosY}px`;\n\n            this.selectedItem.marker.dragging = true;\n        }\n    }\n\n    handleMouseUp(e) {\n        if (this.selectedItem.marker) {\n            if (this.selectedItem.marker.dragging) {\n                const containerPosX = this.pushpinBillboardTool.pushpinContainer.position.x;\n                const containerPosY = this.pushpinBillboardTool.pushpinContainer.position.y;\n\n                this.selectedItem.marker.style.transform = `translate(${this.newX - containerPosX}px, ${this.newY - containerPosY}px)`;\n\n                const result = clientToWorld(this.viewer, this.newX, this.newY);\n\n                this.selectedItem.data.position = { x: result.x, y: result.y, z: result.z };\n                \n                this.pushPinManager.generateThumbnail(this.selectedItem).then((thumbnail) => {\n                    const { x, y, z } = this.selectedItem.data.position; // Backup position.\n\n                    if (this.viewer.model.getData().isPdf) {\n                        convertPdfToLeaflet(this.viewer, this.selectedItem.data);\n                    }\n\n                    this.pushPinManager.fireEvent({ type: PUSHPIN_EVENTS.PUSH_PIN_MODIFY_EVENT, value: this.selectedItem, thumbnail });\n\n                    this.selectedItem.data.position = { x, y, z }; // Restore position.\n                });\n\n                this.pushpinBillboardTool.removeAll();\n                this.render();\n                this.pushpinBillboardTool.selectPushpin(this.pushPinManager.selectedItem);\n                if (this.selectedItem.draggable) {\n                    this.enableItemDragging(this.selectedItem);\n                }\n            } else {\n                this.selectedItem.marker.startDragging = false;\n            }\n        }\n    }\n\n    handleMouseDown(event) {\n        function getOffset(e) {\n            let left = 0;\n            let top = 0;\n\n            while (e.offsetParent) {\n                left += e.offsetLeft;\n                top += e.offsetTop;\n                e = e.offsetParent;\n            }\n\n            left += e.offsetLeft;\n            top += e.offsetTop;\n            return { x: left, y: top };\n        }\n\n        if (this.selectedItem.marker) {\n            if (event.target.tagName.toLowerCase() === 'textarea') {\n                return;\n            }\n\n            this.mouseOffset = getOffset(this.viewer.container);\n\n            this.newX = null;\n            this.newY = null;\n\n            this.selectedItem.marker.startDragging = true;\n        }\n    }\n}\n","import PushPinBillboardLabel from '../PushPinLabel/PushPinBillboardLabel';\nimport { statusHexValues, moveableIcon, markerOffsets } from '../PushPinConstants';\nimport { generateMetadata } from '../PushPins3D/PushPinViewerState';\n\nexport default class PushPinBillboardTool3D {\n    constructor(viewer, options = {}) {\n        this.names = ['pushpinBillboard3D'];\n\n        this.viewer = viewer;\n\n        this.active = false;\n\n        this.pushpins = [];\n        this.selectedPushpin = null;\n        this.dirty = false;\n        this.camera = this.viewer.navigation.getCamera();\n\n        const raycastLimitPerSecond = 200; // execute at most once every x milliseconds.\n        this.maxMsPerRayCastCycle = 20;\n        this.updateTimestamp = 0;\n\n        if (!options.disableOcclusionTest) {\n            // Ray-casts for occlusion tests. The only purpose is to change the opacity of occluded PushPins, at the costs of:\n            //  - Memory: Loading the externalID file (may be huge for large projects)\n            //  - Performance: Repeatedly firing lots of raytests and worker tasks (#PushPins separate queries per camera change)\n            this.raycastThrottle = this.throttle(() => {\n                this.continueRayCasts();\n            }, raycastLimitPerSecond);\n        } else {\n            // Bypass raycasts for occlusion checks.\n            this.raycastThrottle = () => {};\n        }\n    }\n\n    continueRayCasts() {\n        const stamp = performance.now();\n        let i = 0;\n        for (; i < this.pushpins.length; i++) {\n            const pushpin = this.pushpins[i];\n            if (!pushpin.visible) {\n                continue;\n            }\n            if (pushpin.updateTimestamp !== this.updateTimestamp) {\n                pushpin.updateTimestamp = this.updateTimestamp;\n                this.castRay(pushpin);\n                if (performance.now() > stamp + this.maxMsPerRayCastCycle) {\n                    break;\n                }\n            }\n        }\n\n        // Make sure that we continue if we couldn't do them all\n        if (i < this.pushpins.length) {\n            this.raycastThrottle();\n        }\n    }\n\n    getNames() {\n        return this.names;\n    }\n\n    getName() {\n        return this.names[0];\n    }\n\n    isActive() {\n        return this.active;\n    }\n\n    activate(name) {\n        if (name === this.getName()) {\n            this.active = true;\n\n            this.onCameraChangeBinded = e => this.onCameraChange(e);\n            this.handleResizeBinded = e => this.handleResize(e);\n\n            this.viewer.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT, this.onCameraChangeBinded);\n            this.viewer.addEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT, this.handleResizeBinded);\n        }\n    }\n\n    throttle(callback, wait, context = this) {\n        let timeout = null;\n        let callbackArgs = null;\n\n        const later = () => {\n            timeout = null;\n            callback.apply(context, callbackArgs);\n        };\n\n        return function () {\n            if (!timeout) {\n                callbackArgs = arguments;\n                timeout = setTimeout(later, wait);\n            }\n        };\n    }\n\n    deactivate(name) {\n        if (name === this.getName()) {\n            this.active = false;\n\n            this.viewer.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT, this.onCameraChangeBinded);\n            this.viewer.removeEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT, this.handleResizeBinded);\n        }\n    }\n\n    onCameraChange() {\n        this.updatePushpins();\n    }\n\n    project(pushpin) {\n        const position = pushpin.marker.intersectPoint;\n        const containerBounds = this.viewer.navigation.getScreenViewport();\n        const p = new THREE.Vector3().copy(position);\n\n        const matrix = new THREE.Matrix4();\n        const frustum = new THREE.Frustum();\n\n        matrix.multiplyMatrices(this.camera.projectionMatrix, this.camera.matrixWorldInverse);\n\n        // We don't change visibility if pushpin is hidden anyway\n        if (pushpin.visible) {\n            frustum.setFromMatrix(matrix);\n            (!frustum.containsPoint(p)) ? this.hideMarker(pushpin.marker) : this.showMarker(pushpin.marker);\n        }\n\n        p.applyProjection(matrix);\n\n        return new THREE.Vector3(\n            Math.round(((p.x + 1) / 2) * containerBounds.width),\n            Math.round(((-p.y + 1) / 2) * containerBounds.height),\n            p.z\n        );\n    }\n\n    unproject(position) {\n        const containerBounds = this.viewer.navigation.getScreenViewport();\n        const p = new THREE.Vector3();\n\n        p.x = ((position.x / containerBounds.width) * 2) - 1;\n        p.y = -(((position.y / containerBounds.height) * 2) - 1);\n        p.z = position.z;\n        p.unproject(this.camera);\n\n        return p;\n    }\n\n    initNewPushpin(item) {\n        item.intersectPoint = item.data.position;\n\n        this.pushpins.push(item);\n\n        this.createMarker(item);\n\n        item.draggable ? this.enableDragging(item) : this.disableDragging(item);\n        item.visible ? this.showMarker(item.marker) : this.hideMarker(item.marker);\n    }\n\n    fetchExternalId(model, dbId, callback) {\n        return new Promise((resolve, reject) => {\n            const onSuccessCallback = (props) => {\n                let externalId = props.externalId;\n\n                // For some files (i.e. STEP) the externalId is an array that contains the whole hierarchy of the element\n                // Since we need only a string in the end we take the last element (the hierarchy is concatenated anyway,\n                // so each element contains the whole information needed to identify it)\n                if (externalId.startsWith('[') && externalId.endsWith(']')) {\n                    try {\n                        const parsedExternalId = JSON.parse(externalId);\n                        if (Array.isArray(parsedExternalId)) {\n                            externalId = parsedExternalId[parsedExternalId.length - 1];\n                        }\n                    } catch(e) {\n                        console.error('Error ' + e + ' parsing externalId ', externalId);\n                    }\n                }\n\n                if (model.getData().loadOptions.fileExt === 'ifc') {\n                    const ifcId = props.properties.find(el => el.displayName === 'IfcGUID' || (el.displayName === 'GLOBALID' && el.displayCategory === 'IFC'));\n                    if (ifcId) {\n                        externalId = ifcId.displayValue;\n                    } else { // If there's no IFC id, look at the parent\n                        const parentDbId = props.properties.find(el => el.displayName === 'parent' && el.displayValue > -1);\n                        if (parentDbId) {\n                            resolve(this.fetchExternalId(model, parentDbId.displayValue, callback));\n                            return;\n                        }\n                    }\n                }\n                callback(externalId);\n                resolve();\n            };\n\n            const onErrorCallback = (status, message, data) => {\n                Autodesk.Viewing.Private.logger.warn(message);\n                resolve(); // Log the message but don't fail\n            };\n\n            model.getProperties2(dbId, onSuccessCallback, onErrorCallback, { needsExternalId: true });\n        });\n    }\n\n    createPushpin(item) {\n        this.initNewPushpin(item);\n\n        const globalOffset = this.viewer.model ? this.viewer.model.getData().globalOffset : null;\n        item.setViewerState(generateMetadata(this.viewer.getState(), globalOffset));\n\n        this.selectPushpin(item);\n\n        const vpVec = this.viewer.impl.clientToViewport(item.marker.position.x, item.marker.position.y);\n        const res = this.viewer.impl.castRayViewport(vpVec, false);\n\n        if (res) {\n            item.setObjectId(res.dbId);\n            item.setObjectData(res);\n\n            const model = item.findModel(this.viewer);\n            if (!model) {\n                console.error('Failed to assign externalId: The model for this PushPin is not loaded.');\n                return Promise.resolve();\n            }\n\n            return this.fetchExternalId(model, res.dbId, externalId => item.setExternalId(externalId));\n        } else {\n            return Promise.resolve();\n        }\n    }\n\n    loadPushpin(item) {\n        this.initNewPushpin(item);\n\n        return Promise.resolve();\n    }\n\n    createMarker(pushpin) {\n        const marker = document.createElement('div');\n        pushpin.marker = marker;\n        \n        marker.id = pushpin.data.id;\n        marker.intersectPoint = pushpin.intersectPoint;\n\n        if (pushpin.hasPosition()) {\n            const className = (pushpin.data.type === 'rfis') ? 'rfi-billboard-marker' : 'pushpin-billboard-marker';\n\n            marker.classList.add(className);\n            marker.style.backgroundColor = statusHexValues[pushpin.data.status];\n\n            this.viewer.container.appendChild(marker);\n            \n            this.setMarkerPosition(pushpin);\n\n            const xTranslate = pushpin.marker.position.x - (markerOffsets.markerOffsetWidth / 2);\n            const yTranslate = pushpin.marker.position.y - (markerOffsets.markerOffsetWidth / 2);\n\n            pushpin.marker.style.transform = `translate(${xTranslate}px, ${yTranslate}px)`;\n        } else {\n            // Imported issues (such as from BCF) can arrive without a position. They just store the camera state\n            // In that case create a dummy marker (since the extension assumes it exists in many places) and don't \n            // add it to the viewer.container\n            this.hideMarker(marker);\n            pushpin.visible = false;\n        }\n    }\n\n    removePushpin(pushpin) {\n        this.pushpins = this.pushpins.filter((curPushpin) => {\n            if (this.selectedPushpin && this.selectedPushpin.data.id === pushpin.data.id) {\n                this.selectedPushpin = null;\n            }\n\n            return curPushpin.data.id !== pushpin.data.id;\n        });\n\n        this.destroyMarker(pushpin);\n    }\n\n    removeAll() {\n        this.pushpins.forEach((pushpin) => {\n            this.removePushpin(pushpin);\n        });\n    }\n\n    destroyMarker(pushpin) {\n        this.destroyLabel(pushpin);\n        this.viewer.container.removeChild(pushpin.marker);\n        pushpin.marker = undefined;\n    }\n\n    destroyLabel(pushpin) {\n        if (pushpin.label) {\n            pushpin.marker.removeChild(pushpin.label.container);\n            pushpin.label = undefined;\n        }\n    }\n\n    setMarkerPosition(pushpin) {\n        pushpin.marker.position = this.project(pushpin);\n    }\n\n    updateStyle(status, size, hex) {\n        statusHexValues[status] = hex;\n        this.dirty = true;\n    }\n\n    castRay(pushpin) {\n        const objectId = parseInt(pushpin.data.objectId, 10);\n        if (isNaN(objectId) || objectId === -1) { // no check needed\n            return;\n        }\n\n        const vpVec = this.viewer.impl.clientToViewport(pushpin.marker.position.x, pushpin.marker.position.y);\n        const res = this.viewer.impl.castRayViewport(vpVec, false); \n        if (res && res.dbId) {\n            if (pushpin.data.externalId) {\n                return this.fetchExternalId(res.model, res.dbId, (externalId) => {\n                    // it could happen that the pushpin was removed in the meantime\n                    if (pushpin && pushpin.marker && pushpin.data) {\n                        pushpin.marker.style.opacity = (externalId === pushpin.data.externalId) ? '1.0' : '0.15';\n                    }\n                });\n            }\n            if (pushpin.data.objectId && parseInt(pushpin.data.objectId, 10) !== -1) {\n                pushpin.marker.style.opacity = (res.dbId === parseInt(pushpin.data.objectId, 10)) ? '1.0' : '0.15';\n            }\n        } else { // no object was hit\n            pushpin.marker.style.opacity = '0.15';\n        }\n    }\n\n    updatePushpins() {\n        // Calc new position\n        this.updateTimestamp++;\n        this.raycastThrottle();\n\n        this.pushpins.forEach((pushpin) => {\n            this.setMarkerPosition(pushpin);\n        });\n\n        // Update the DOM\n        this.pushpins.forEach((pushpin) => {\n            const offsetWidth = pushpin.selected ? markerOffsets.selectedMarkerOffsetWidth : markerOffsets.markerOffsetWidth;\n\n            const xTranslate = pushpin.marker.position.x - (offsetWidth / 2);\n            const yTranslate = pushpin.marker.position.y - (offsetWidth / 2);\n\n            pushpin.marker.style.transform = `translate(${xTranslate}px, ${yTranslate}px)`;\n\n            if (this.dirty) {\n                if (pushpin.label) {\n                    pushpin.label.update(pushpin.data.label);\n                }\n\n                pushpin.draggable ? this.enableDragging(pushpin) : this.disableDragging(pushpin);\n                pushpin.marker.style.backgroundColor = statusHexValues[pushpin.data.status];\n                pushpin.visible ? this.showMarker(pushpin.marker) : this.hideMarker(pushpin.marker);\n            }\n        });\n\n        this.dirty = false;\n    }\n\n    setDirty() {\n        this.dirty = true;\n    }\n\n    selectPushpin(pushpin) {\n        this.deselect();\n        this.viewer.clearSelection();\n\n        pushpin.label = new PushPinBillboardLabel(pushpin.marker, pushpin.data.label);\n        pushpin.marker.classList.add('selected');\n\n        this.selectedPushpin = pushpin;\n    }\n\n    deselect() {\n        if (this.selectedPushpin) {\n            this.destroyLabel(this.selectedPushpin);\n            this.selectedPushpin.marker.style.pointerEvents = 'none';\n            this.selectedPushpin.marker.classList.remove('selected');\n            this.selectedPushpin = null;\n        }\n    }\n\n    enableDragging(item) {\n        if (this.selectedPushpin && this.selectedPushpin.data.id === item.data.id) {\n            item.marker.style.pointerEvents = 'auto';\n        }\n        item.marker.style.backgroundImage = moveableIcon;\n    }\n\n    disableDragging(item) {\n        const selectedItem = item || this.selectedPushpin;\n\n        selectedItem.marker.style.pointerEvents = 'none';\n        selectedItem.marker.style.backgroundImage = 'none';\n        selectedItem.draggable = false;\n    }\n\n    hideLabel() {\n        if (this.selectedPushpin) {\n            this.selectedPushpin.label.hide();\n        }\n    }\n\n    showMarker(marker) {\n        marker.style.display = '';\n    }\n\n    hideMarker(marker) {\n        marker.style.display = 'none';\n    }\n\n    showMarkers() {\n        this.pushpins.forEach((pushpin) => {\n            (pushpin.visible) ? this.project(pushpin) : this.hideMarker(pushpin.marker);\n        });\n    }\n\n    hideMarkers() {\n        this.pushpins.forEach((pushpin) => {\n            this.hideMarker(pushpin.marker);\n        });\n\n        if (this.selectedPushpin) {\n            this.destroyLabel(this.selectedPushpin);\n        }\n    }\n\n\n    handleButtonDown(event, button) {\n        return false;\n    }\n\n    handleButtonUp(event, button) {\n        return false;\n    }\n\n    handleResize() {\n        this.updatePushpins();\n    }\n}\n\nconst namespace = AutodeskNamespace('Autodesk.BIM360.Extension.PushPin');\n\nnamespace.PushPinBillboardTool3D = PushPinBillboardTool3D;\n","import PushPinBillboardTool3D from '../PushPins3D/PushPinBillboardTool3D';\nimport PushPinInputHandler from '../PushPinInputHandler';\nimport { PUSHPIN_EVENTS } from '../PushPinEvents';\nimport { restoreViewState } from '../PushPins3D/PushPinViewerState';\nimport { markerOffsets } from '../PushPinConstants';\n\nexport default class RenderHandler3D {\n    constructor(viewerApi, pushPinManager) {\n        this.viewer = viewerApi;\n        this.pushPinManager = pushPinManager;\n        this.pushpinDirty = false;\n        this.selectedItem = null;\n\n        this.onExplodeBind = e => this.onExplode(e);\n        this.onSectionBind = e => this.onSection(e);\n\n        this.onSelectedChangedBind = e => this.onSelectedChanged(e);\n        this.onRemoveBind = e => this.onRemove(e);\n        this.onRemoveAllBind = e => this.onRemoveAll(e);\n        this.onModifyBind = e => this.onModify(e);\n        this.onUpdateBind = e => this.onUpdate(e);\n        this.createBind = e => this.create(e);\n        this.onVisibilityChangedBind = e => this.onVisibilityChanged(e);\n    }\n\n    register() {\n        this.pushpinBillboardTool = new PushPinBillboardTool3D(this.viewer, this.pushPinManager.options);\n        this.viewer.toolController.registerTool(this.pushpinBillboardTool);\n    }\n\n    deregister() {\n        if (this.pushpinBillboardTool) {\n            this.viewer.toolController.deregisterTool(this.pushpinBillboardTool);\n            this.pushpinBillboardTool = null;\n        }\n    }\n\n    activate() {\n        if (!this.pushpinBillboardTool.isActive()) {\n            this.viewer.toolController.activateTool('pushpinBillboard3D');\n        }\n\n        this.inputHandler = new PushPinInputHandler(this);\n\n        this.viewer.addEventListener(Autodesk.Viewing.EXPLODE_CHANGE_EVENT, this.onExplodeBind);\n        this.viewer.addEventListener(Autodesk.Viewing.CUTPLANES_CHANGE_EVENT, this.onSectionBind);\n\n        this.pushPinManager.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_SELECTED_EVENT, this.onSelectedChangedBind);\n        this.pushPinManager.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_REMOVED_EVENT, this.onRemoveBind);\n        this.pushPinManager.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_REMOVE_ALL_EVENT, this.onRemoveAllBind);\n        this.pushPinManager.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_MODIFY_EVENT, this.onModifyBind);\n        this.pushPinManager.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_UPDATE_EVENT, this.onUpdateBind);\n        this.pushPinManager.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_VISIBILITY_EVENT, this.onVisibilityChangedBind);\n        this.pushPinManager.setCreateFunction(this.createBind);\n\n        return true;\n    }\n\n    deactivate() {\n        if (this.pushpinBillboardTool.isActive()) {\n            this.viewer.toolController.deactivateTool('pushpinBillboard3D');\n        }\n\n        this.inputHandler.detach();\n\n        this.viewer.removeEventListener(Autodesk.Viewing.EXPLODE_CHANGE_EVENT, this.onExplodeBind);\n        this.viewer.removeEventListener(Autodesk.Viewing.CUTPLANES_CHANGE_EVENT, this.onSectionBind);\n\n        this.pushPinManager.removeEventListener(PUSHPIN_EVENTS.PUSH_PIN_SELECTED_EVENT, this.onSelectedChangedBind);\n        this.pushPinManager.removeEventListener(PUSHPIN_EVENTS.PUSH_PIN_REMOVED_EVENT, this.onRemoveBind);\n        this.pushPinManager.removeEventListener(PUSHPIN_EVENTS.PUSH_PIN_REMOVE_ALL_EVENT, this.onRemoveAllBind);\n        this.pushPinManager.removeEventListener(PUSHPIN_EVENTS.PUSH_PIN_MODIFY_EVENT, this.onModifyBind);\n        this.pushPinManager.removeEventListener(PUSHPIN_EVENTS.PUSH_PIN_UPDATE_EVENT, this.onUpdateBind);\n        this.pushPinManager.removeEventListener(PUSHPIN_EVENTS.PUSH_PIN_VISIBILITY_EVENT, this.onVisibilityChangedBind);\n        this.pushPinManager.removeCreateFunction(this.createBind);\n    }\n\n    setPushpinDirty() {\n        this.pushpinDirty = true;\n    }\n\n    onSelectedChanged(event) {\n        if (event.value) {\n            this.selectedItem = event.value;\n\n            if (!this.selectedItem.marker) {\n                this.create(this.selectedItem);\n            }\n\n            this.pushpinBillboardTool.selectPushpin(this.selectedItem);\n            restoreViewState(this.viewer, this.selectedItem);\n\n            if (this.selectedItem.draggable) {\n                this.enableItemDragging(this.selectedItem);\n            }\n\n            this.viewer.dispatchEvent({ type: PUSHPIN_EVENTS.PUSH_PIN_SELECTED_EVENT });\n        } else {\n            this.deselectItem();\n            this.pushpinBillboardTool.deselect();\n\n            const sectionExt = this.viewer.getExtension('Autodesk.Section');\n           \n            if (sectionExt && sectionExt.getSectionPlanes().length === 1) {\n                sectionExt.setSectionFromPlane(null);\n            } else {\n                this.viewer.impl.setCutPlaneSet('__set_view', undefined);\n            }\n        }\n\n        this.setPushpinDirty();\n    }\n\n    deselectItem() {\n        this.selectedItem = null;\n        this.inputHandler.detach();\n    }\n\n    onRemove(event) {\n        if (this.selectedItem && event.value.data.id === this.selectedItem.data.id) {\n            this.deselectItem();\n        }\n\n        if (event.value && event.value.marker) {\n            this.pushpinBillboardTool.removePushpin(event.value);\n        }\n    }\n\n    onRemoveAll() {\n        this.deselectItem();\n        this.pushpinBillboardTool.removeAll();\n    }\n\n    onModify() {\n        this.pushpinDirty = true;\n    }\n\n    onVisibilityChanged() {\n        this.pushpinBillboardTool.showMarkers();\n    }\n\n    onUpdate() {\n        setTimeout(() => {\n            this.setPushpinDirty();\n\n            // it could happen that the extension was removed in the meantime\n            this.pushpinBillboardTool && this.pushpinBillboardTool.setDirty();\n            const selectedItem = this.pushPinManager ? this.pushPinManager.getSelectedItem() : null;\n\n            if (!selectedItem) {\n                return;\n            }\n\n            (selectedItem.draggable && selectedItem.marker) ?\n                this.enableItemDragging(selectedItem) :\n                this.disableItemDragging(selectedItem);\n        }, 1);\n    }\n\n    enableItemDragging(item) {\n        this.pushpinBillboardTool.enableDragging(item);\n        this.inputHandler.attachTo(item.marker);\n    }\n\n    disableItemDragging(item) {\n        this.pushpinBillboardTool.disableDragging(item);\n        this.inputHandler.detach();\n    }\n\n    onExplode(e) {\n        if (e.scale * 1.0 === 0) {\n            this.pushpinBillboardTool.showMarkers();\n        } else {\n            this.pushpinBillboardTool.hideMarkers();\n        }\n    }\n\n    onSection() {\n    }\n\n    create(item) {\n        // iOS have a special case where they already have the UUID, so we act like we are re-selecting an existing item\n        return this.createRenderItem(item, Autodesk.Viewing.isIOSDevice());\n    }\n\n    createRenderItem(item, reselect) {\n        // Make sure it's a uuid and not a growing counter\n        const isLoaded = (item.data.id.length > 20);\n\n        this.pushpinBillboardTool.deselect();\n\n        let promise;\n        if (isLoaded && !reselect) {\n            promise = this.pushpinBillboardTool.loadPushpin(item);\n        } else {\n            promise = this.pushpinBillboardTool.createPushpin(item);\n            this.pushPinManager.selectOne(item.data.id);\n        }\n\n        return promise;\n    }\n\n    updatePattern(status, size, hex) {\n        this.pushpinBillboardTool.updateStyle(status, size, hex);\n\n        this.setPushpinDirty();\n    }\n\n    render() {\n        if (!this.pushPinManager || !this.viewer.model) {\n            return;\n        }\n\n        this.pushPinManager.items().reverse().forEach((item) => {\n            if (!item.marker) {\n                this.createRenderItem(item, false);\n            }\n        });\n\n        if (this.pushpinDirty) {\n            this.pushpinBillboardTool.updatePushpins();\n            this.pushpinDirty = false;\n        }\n    }\n\n    findIntersections(event) {\n        const mouseX = event.clientX;\n        const mouseY = event.clientY;\n\n        let hitItem = null;\n\n        this.pushPinManager.items().some((item) => {\n            if (item.selectable && item.marker) {\n                const bb = item.marker.getBoundingClientRect();\n                if (mouseX > bb.left && mouseX < bb.left + bb.width && mouseY > bb.top && mouseY < bb.top + bb.height) {\n                    hitItem = item;\n                    return true;\n                }\n            }\n            return false;\n        });\n\n        return hitItem;\n    }\n\n    handleMouseMove(e) {\n        function mouseCoords(ev) {\n            if (ev.pageX || ev.pageY) {\n                return { x: ev.pageX, y: ev.pageY };\n            }\n\n            return {\n                x: (ev.clientX + document.body.scrollLeft) - document.body.clientLeft,\n                y: (ev.clientY + document.body.scrollTop) - document.body.clientTop\n            };\n        }\n\n        if (this.selectedItem.marker.startDragging) {\n            // only on first mouse movement\n            if (!this.newX) {\n                this.selectedItem.marker.style.transform = 'translate(0px, 0px)';\n            }\n\n            const mousePos = mouseCoords(e);\n\n            this.newX = mousePos.x - this.mouseOffset.x;\n            this.newY = mousePos.y - this.mouseOffset.y;\n\n            // Check left, top, right, bottom\n            const containerBounds = this.viewer.navigation.getScreenViewport();\n            const wi = this.selectedItem.marker.clientWidth;\n            const hi = this.selectedItem.marker.clientHeight;\n\n            if (this.newX < 5) {\n                this.newX = 0;\n            }\n            if (this.newY < 5) {\n                this.newY = 0;\n            }\n            if (containerBounds.width - 5 < this.newX + wi) {\n                this.newX = containerBounds.width - wi;\n            }\n            if (containerBounds.height - 5 < this.newY + hi) {\n                this.newY = containerBounds.height - hi;\n            }\n\n            this.selectedItem.marker.style.left = `${this.newX}px`;\n            this.selectedItem.marker.style.top = `${this.newY}px`;\n\n            const vpVec = this.viewer.impl.clientToViewport(this.newX + (this.offsetWidth / 2), this.newY + (this.offsetWidth / 2));\n            const res = this.viewer.impl.castRayViewport(vpVec, false);\n\n            (!res) ? this.selectedItem.marker.classList.add('grey-out') : this.selectedItem.marker.classList.remove('grey-out');\n\n            this.selectedItem.marker.dragging = true;\n        }\n    }\n\n    handleMouseUp(e) {\n        if (this.selectedItem.marker.dragging) {\n            this.selectedItem.marker.style.left = '0px';\n            this.selectedItem.marker.style.top = '0px';\n            this.selectedItem.marker.style.transform = `translate(${this.newX}px, ${this.newY}px)`;\n\n            this.newX += this.offsetWidth / 2;\n            this.newY += this.offsetWidth / 2;\n\n            const result = this.viewer.impl.clientToWorld(this.newX, this.newY);\n\n            if (result) {\n                this.selectedItem.data.position = { x: result.point.x, y: result.point.y, z: result.point.z };\n            }\n\n            this.pushpinBillboardTool.removePushpin(this.selectedItem);\n            const promise = this.createRenderItem(this.selectedItem, true);\n\n            if (result) {\n                promise.then(() => this.pushPinManager.generateThumbnail(this.selectedItem))\n                .then((thumbnail) => {\n                    this.pushPinManager.fireEvent({ type: PUSHPIN_EVENTS.PUSH_PIN_MODIFY_EVENT, value: this.selectedItem, thumbnail });\n                });\n            }\n\n            this.selectedItem.marker.startDragging = false;\n            this.selectedItem.marker.dragging = false;\n\n            this.onUpdate();\n        } else {\n            this.selectedItem.marker.startDragging = false;\n        }\n    }\n\n    handleMouseDown(event) {\n        function getPosition(e) {\n            let left = 0;\n            let top = 0;\n\n            while (e.offsetParent) {\n                left += e.offsetLeft;\n                top += e.offsetTop;\n                e = e.offsetParent;\n            }\n\n            left += e.offsetLeft;\n            top += e.offsetTop;\n            return { x: left, y: top };\n        }\n\n        function getMouseOffset(target, offsetWidth) {\n            const docPos = getPosition(target);\n\n            docPos.x += offsetWidth / 2;\n            docPos.y += offsetWidth / 2;\n            return { x: docPos.x, y: docPos.y };\n        }\n\n        if (event.target.tagName.toLowerCase() === 'textarea') {\n            return;\n        }\n\n        this.offsetWidth = this.selectedItem.selected ? markerOffsets.selectedMarkerOffsetWidth : markerOffsets.markerOffsetWidth;\n\n        this.mouseOffset = getMouseOffset(this.viewer.container, this.offsetWidth);\n\n        this.selectedItem.marker.style.opacity = '1.0';\n\n        this.newX = null;\n        this.newY = null;\n\n        this.selectedItem.marker.startDragging = true;\n    }\n}\n","import { PUSHPIN_EVENTS } from './PushPinEvents';\nimport { clientToWorld } from './PushPinUtils';\nimport { cursorIcon } from './PushPinConstants';\nimport RenderHandler2D from './PushPins2D/RenderHandler2D';\nimport RenderHandler3D from './PushPins3D/RenderHandler3D';\n\nexport default class PushPinTool {\n    constructor(viewer, pushPinManager, options = {}) {\n        this.names = ['pushpin'];\n        this.priority = 65;\n        this.pushpinCursor = cursorIcon;\n\n        this.isActive = false;\n        this.pushPinInitData = null;\n        this.viewer = viewer;\n        this.pushPinManager = pushPinManager;\n        this.createMode = false;\n\n        // This is for test\n        this.testId = '1111122222333334444455555';\n        this.autoCreate = false;\n        // test end\n\n        this.is2D = this.viewer.model && this.viewer.model.is2d();\n\n        // In case the 3d model has no thickness, consider it as a 'pseudo 2D' model.\n        // It will disable the occlusion test. And when creating new pushpins it will not interact with the objects, but with the ground. \n        if (!this.is2D) {\n            const modelBB = this.viewer.model.getBoundingBox();\n            const worldUp = this.viewer.impl.worldUpName();\n            this.isPseudo2D = modelBB.max[worldUp] - modelBB.min[worldUp] === 0;\n            this.pushPinManager.options.disableOcclusionTest = true;\n        }\n    }\n\n    getNames() {\n        return this.names;\n    }\n\n    getName() {\n        return this.names[0];\n    }\n\n    getPriority() {\n        return this.priority;\n    }\n\n    setAutoCreate(auto) {\n        this.autoCreate = auto;\n    }\n\n    getCursor() {\n        if (this.createMode) {\n            return this.pushpinCursor;\n        }\n        return this.isHover ? 'pointer' : null;\n    }\n\n    register() {\n        // Init render tool\n        if (!this.renderTool) {\n            if (this.is2D) {\n                this.renderTool = new RenderHandler2D(this.viewer, this.pushPinManager);\n            } else {\n                this.renderTool = new RenderHandler3D(this.viewer, this.pushPinManager);\n            }\n\n            this.renderTool.register();\n        }\n    }\n\n    deregister() {\n        if (this.renderTool) {\n            this.renderTool.deregister();\n            this.renderTool = null;\n        }\n    }\n\n    activate(name, viewerApi) {\n        if (name === this.getName()) {\n            this.renderTool.activate();\n            this.isActive = true;\n        }\n    }\n\n    deactivate(name) {\n        if (name === this.getName()) {\n            this.show(false);\n            this.isActive = false;\n        }\n    }\n\n    update() {\n        if (this.isActive) {\n            if (this.duringShowing && this.renderTool) {\n                this.renderTool.render();\n            }\n        }\n\n        // return false, because push pin render doesn't affect LMV model.\n        return false;\n    }\n\n    show(duringShowing) {\n        this.duringShowing = duringShowing;\n    }\n\n    enablePushPinSelect(enable) {\n        this.pushPinManager.items().forEach((item) => {\n            item.selectable = enable;\n        });\n    }\n\n    // Each time client initiate push pin create with default info and one at a time\n    startCreateItem(data) {\n        if (this.isActive) {\n            const controller = this.viewer.toolController;\n            if (controller && controller.getActiveToolName() !== this.getName()) {\n                controller.deactivateTool(this.getName());\n                controller.activateTool(this.getName());\n            }\n\n            if (!this.duringShowing) {\n                this.show(true);\n            }\n\n            this.pushPinInitData = data;\n            this.createMode = true;\n            this.enablePushPinSelect(false);\n        }\n\n        this.viewer.dispatchEvent({ type: PUSHPIN_EVENTS.PUSH_PIN_SELECTED_EVENT });\n    }\n\n    endCreateItem() {\n        this.pushPinInitData = null;\n\n        if (this.createMode) {\n            this.createMode = false;\n            this.enablePushPinSelect(true);\n        }\n    }\n\n    createThreePushPin(event) {\n        let pushPin = null;\n        const clientX = event.canvasX;\n        const clientY = event.canvasY;\n        let result;\n        if (!this.isPseudo2D) {\n            result = this.viewer.impl.clientToWorld(clientX, clientY);\n        } else {\n            result = {\n                point: this.viewer.impl.intersectGround(clientX, clientY)\n            }\n        }\n         \n        if (result && this.pushPinInitData) {\n            this.pushPinInitData.position = { x: result.point.x, y: result.point.y, z: result.point.z };\n\n            pushPin = this.pushPinManager.createItem(this.pushPinInitData);\n            // Clear pin pin init data, as it is a one time data for creating only one push pin.\n            this.pushPinInitData = null;\n        }\n\n        return pushPin;\n    }\n\n    createTwoPushPin(event) {\n        let pushPin = null;\n        const clientX = event.canvasX;\n        const clientY = event.canvasY;\n        const result = clientToWorld(this.viewer, clientX, clientY);\n\n        if (result && this.pushPinInitData) {\n            this.pushPinInitData.position = { x: result.x, y: result.y, z: result.z };\n\n            pushPin = this.pushPinManager.createItem(this.pushPinInitData);\n            // Clear pin pin init data, as it is a one time data for creating only one push pin.\n            this.pushPinInitData = null;\n        }\n\n        return pushPin;\n    }\n\n    createPushPin(event) {\n        if (this.autoCreate && !this.pushPinInitData) {\n            // Fake push pin data for auto create.\n            this.pushPinInitData = { id: (this.testId + '1'), status: 'issues-open', type: 'issues' };\n        }\n\n        if (this.pushPinInitData) {\n            return this.viewer.model.is2d() ? this.createTwoPushPin(event) : this.createThreePushPin(event);\n        }\n\n        return false;\n    }\n\n    // Below is the standard input handler, so far only care about single click for creating push pins.\n    handleSingleTap(event) {\n        PushPinTool.convertEventHammerToMouse(event);\n\n        return this.handleSingleClick(event, 0);\n    }\n\n    triggerPushpinClick(item) {\n        this.pushPinManager.selectOne(item.data.id);\n        this.pushPinManager.fireEvent({\n            type: PUSHPIN_EVENTS.PUSH_PIN_CLICKED_EVENT,\n            value: this.pushPinManager.getSelectedItem()\n        });\n    }\n\n    checkPushpinClick(event) {\n        return this.renderTool.findIntersections(event);\n    }\n\n    handleSingleClick(event, button) {\n        const pressedItem = this.checkPushpinClick(event);\n        let triggered = false;\n\n        if (!this.createMode) {\n            // Trigger selection only when createMode is false\n            if (pressedItem) {\n                this.triggerPushpinClick(pressedItem);\n                triggered = true;\n            } else if (this.pushPinManager.selectedItem) {\n                this.pushPinManager.selectNone();\n                this.pushPinManager.fireEvent({ type: PUSHPIN_EVENTS.PUSH_PIN_SELECT_NONE, value: null });\n            }\n        }\n\n        if (this.isActive && button === 0) {\n            if (pressedItem) {\n                if (!triggered) {\n                    this.triggerPushpinClick(pressedItem);\n                }\n            } else {\n                return this.createPushPin(event);\n            }\n        }\n\n        if (pressedItem) {\n            // Prevent from other listeners to be alerted for this current click.\n            // This is necessary for a scenario when there is a pushpin on top of a callout rectangle for example.\n            document.addEventListener('click',\n                function handler(e) {\n                    e.stopPropagation();\n                    document.removeEventListener('click', handler, true);\n                }, true);\n        }\n\n        return !!pressedItem;\n    }\n\n    handleMouseMove(event) {\n        const hoveredItem = this.checkPushpinClick(event);\n\n        this.isHover = !!hoveredItem;\n        return false;\n    }\n\n    static convertEventHammerToMouse(event) {\n        // Convert Hammer touch-event X,Y into mouse-event X,Y.\n        event.shiftKey = false;\n        event.clientX = event.pointers[0].clientX;\n        event.clientY = event.pointers[0].clientY;\n    }\n\n}\n\nconst namespace = AutodeskNamespace('Autodesk.BIM360.Extension.PushPin');\n\nnamespace.PushPinTool = PushPinTool;\n","import { PUSHPIN_EVENTS } from '../PushPinEvents';\n\nexport default class PushPinVisButton {\n    constructor(viewer, extension, initiallyHidePushpins) {\n        this.viewer = viewer;\n        this.extension = extension;\n        this.pushpinVisBtn = null;\n        this.initiallyHidePushpins = initiallyHidePushpins;\n\n        this.setButtonConstants();\n    }\n\n    setButtonConstants() {\n        this.buttonConstants = {\n            btnClass: '',\n            btnLabel: '',\n            noPushpinLabel: '',\n            hidePushpinLabel: '',\n            showPushpinLabel: '',\n            pushpinNormalIcon: '',\n            pushpinHideIcon: ''\n        };\n\n        this.type = '';\n    }\n\n    get pushPinButton() {\n        return this.pushpinVisBtn;\n    }\n\n    createButton() {\n        const btn = new Autodesk.Viewing.UI.Button(this.buttonConstants.btnClass);\n\n        btn.setToolTip(Autodesk.Viewing.i18n.translate(this.buttonConstants.btnLabel));\n        btn.setIcon(this.buttonConstants.pushpinNormalIcon);\n\n        btn.onClick = () => {\n            const state = btn.getState();\n            if (state === PushPinVisButton.DISABLED) {\n                return;\n            }\n\n            btn.setState(state === PushPinVisButton.INACTIVE ? PushPinVisButton.ACTIVE : PushPinVisButton.INACTIVE);\n        };\n\n        return btn;\n    }\n\n    onPushpinVisBtnStateChange(e) {\n        if (e.state === PushPinVisButton.DISABLED) {\n            this.pushpinVisBtn.setToolTip(Autodesk.Viewing.i18n.translate(this.buttonConstants.noPushpinLabel));\n            return;\n        }\n\n        let showAll = e.state === PushPinVisButton.ACTIVE && !this.initiallyHidePushpins;\n        if (this.initiallyHidePushpins) {\n            this.pushpinVisBtn.setState(PushPinVisButton.INACTIVE);\n            this.initiallyHidePushpins = false;\n        }\n\n        // Toggle the vis button\n        if (showAll) {\n            this.extension.tool.show(true);\n            this.extension.showByType(this.type);\n            this.pushpinVisBtn.setToolTip(Autodesk.Viewing.i18n.translate(this.buttonConstants.hidePushpinLabel));\n            this.pushpinVisBtn.setIcon(this.buttonConstants.pushpinNormalIcon);\n        } else {\n            this.extension.hideByType(this.type);\n            this.pushpinVisBtn.setToolTip(Autodesk.Viewing.i18n.translate(this.buttonConstants.showPushpinLabel));\n            this.pushpinVisBtn.setIcon(this.buttonConstants.pushpinHideIcon);\n        }\n    }\n\n    addButton() {\n        if (this.pushpinVisBtn || !this.viewer.getToolbar) {\n            return;\n        }\n\n        const toolbar = this.viewer.getToolbar();\n\n        if (!toolbar) {\n            return;\n        }\n\n        let modelTools = toolbar.getControl(Autodesk.Viewing.TOOLBAR.MODELTOOLSID);\n\n        if (!modelTools) {\n            // insert model tool below navgiation tool\n            const navigationBar = toolbar.getControl(Autodesk.Viewing.TOOLBAR.NAVTOOLSID);\n            const toolbarOptions = {};\n\n            toolbarOptions.index = (navigationBar) ? toolbar.indexOf(navigationBar) + 1 : 0;\n\n            modelTools = new Autodesk.Viewing.UI.ControlGroup(Autodesk.Viewing.TOOLBAR.MODELTOOLSID);\n            toolbar.addControl(modelTools, toolbarOptions);\n        }\n\n        this.pushpinVisBtn = this.createButton();\n\n        // Add button to the toolbar\n        this.pushpinVisBtn.addEventListener(Autodesk.Viewing.UI.Button.Event.STATE_CHANGED, (e) => {\n            this.onPushpinVisBtnStateChange(e);\n        });\n        this.updateButtonStatus();\n        modelTools.addControl(this.pushpinVisBtn);\n\n        // add event listener to update visual button status\n        this.extension.pushPinManager.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_REMOVED_EVENT, () => {\n            this.updateButtonStatus();\n        });\n        this.extension.pushPinManager.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_REMOVE_ALL_EVENT, () => {\n            this.updateButtonStatus();\n        });\n        this.extension.pushPinManager.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_CREATED_EVENT, () => {\n            this.updateButtonStatus();\n        });\n        this.extension.pushPinManager.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_ITEMS_LOADED, () => {\n            this.updateButtonStatus();\n        });\n        this.extension.pushPinManager.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_PREPARING_THUMBNAIL, () => {\n            this.updateButtonStatus();\n        });\n        this.extension.pushPinManager.addEventListener(PUSHPIN_EVENTS.PUSH_PIN_ITEMS_LOADED, () => {\n            this.updateButtonStatus();\n        });\n    }\n\n    updateButtonStatus() {\n        if (!this.pushpinVisBtn) {\n            return;\n        }\n\n        // during push pin is creating, show all push pins and disable show/hide button\n        if (this.extension.tool.createMode) {\n            if (this.pushpinVisBtn.getState() !== PushPinVisButton.DISABLED) {\n                this.pushpinVisBtn.setState(PushPinVisButton.DISABLED);\n            }\n        } else {\n            const issuePushpinCount = this.extension.pushPinManager.getItemCountByType(this.type);\n            const issueButtonDisable = this.pushpinVisBtn.getState() === PushPinVisButton.DISABLED;\n\n            if (issuePushpinCount > 0 && issueButtonDisable) {\n                this.pushpinVisBtn.setState(PushPinVisButton.ACTIVE);\n            } else if (issuePushpinCount === 0 && !issueButtonDisable) {\n                this.pushpinVisBtn.setState(PushPinVisButton.DISABLED);\n            }\n        }\n    }\n\n    destroyButton() {\n        if (!this.pushpinVisBtn) {\n            return;\n        }\n\n        this.extension.pushPinManager.removeEventListener(PUSHPIN_EVENTS.PUSH_PIN_REMOVED_EVENT, this.updateButtonStatus);\n        this.extension.pushPinManager.removeEventListener(PUSHPIN_EVENTS.PUSH_PIN_REMOVE_ALL_EVENT, this.updateButtonStatus);\n        this.extension.pushPinManager.removeEventListener(PUSHPIN_EVENTS.PUSH_PIN_CREATED_EVENT, this.updateButtonStatus);\n\n        const toolbar = this.viewer.getToolbar();\n\n        if (toolbar) {\n            this.pushpinVisBtn.removeFromParent();\n        }\n\n        this.pushpinVisBtn.removeEventListener(Autodesk.Viewing.UI.Button.Event.STATE_CHANGED, this.onPushpinVisBtnStateChange);\n        this.pushpinVisBtn = null;\n    }\n}\n\nPushPinVisButton.ACTIVE = Autodesk.Viewing.UI.Button.State.ACTIVE;\nPushPinVisButton.DISABLED = Autodesk.Viewing.UI.Button.State.DISABLED;\nPushPinVisButton.INACTIVE = Autodesk.Viewing.UI.Button.State.INACTIVE;\n\n","import PushPinVisButton from '../PushPinUi/PushPinVisButtonBase';\n\nexport default class IssuePushPinVisButton extends PushPinVisButton {\n    constructor(viewer, extension, initiallyHidePushpins) {\n        super(viewer, extension, initiallyHidePushpins);\n        this.viewer = viewer;\n        this.extension = extension;\n        this.pushpinVisBtn = null;\n\n        this.setButtonConstants();\n    }\n\n    setButtonConstants() {\n        this.buttonConstants = {\n            btnClass: 'toolbar-pushpinVis',\n            btnLabel: 'Show all pushpins',\n            noPushpinLabel: 'No issue in current doc',\n            hidePushpinLabel: 'Hide all issues',\n            showPushpinLabel: 'Show all issues',\n            pushpinNormalIcon: 'issueicon-issue_normal',\n            pushpinHideIcon: 'issueicon-issue_hide',\n        };\n\n        this.type = this.extension.pushPinManager.PushPinTypes.ISSUES;\n    }\n}\n","import PushPinVisButton from '../PushPinUi/PushPinVisButtonBase';\n\nexport default class RfiPushPinVisButton extends PushPinVisButton {\n    constructor(viewer, extension, initiallyHidePushpins) {\n        super(viewer, extension, initiallyHidePushpins);\n        this.viewer = viewer;\n        this.extension = extension;\n        this.pushpinVisBtn = null;\n\n        this.setButtonConstants();\n    }\n\n    setButtonConstants() {\n        this.buttonConstants = {\n            btnClass: 'toolbar-pushpinRfisVis',\n            btnLabel: 'Show all rfis',\n            noPushpinLabel: 'No RFI in current doc',\n            hidePushpinLabel: 'Hide all RFIs',\n            showPushpinLabel: 'Show all RFIs',\n            pushpinNormalIcon: 'rfiicon-rfi_normal',\n            pushpinHideIcon: 'rfiicon-rfi_hide',\n        };\n\n        this.type = this.extension.pushPinManager.PushPinTypes.RFIS;\n    }\n}\n","import PushPinVisButton from '../PushPinUi/PushPinVisButtonBase';\n\nexport default class QualityIssuePushPinVisButton extends PushPinVisButton {\n    constructor(viewer, extension, initiallyHidePushpins) {\n        super(viewer, extension, initiallyHidePushpins);\n        this.viewer = viewer;\n        this.extension = extension;\n        this.pushpinVisBtn = null;\n\n        this.setButtonConstants();\n    }\n\n    setButtonConstants() {\n        this.buttonConstants = {\n            btnClass: 'toolbar-pushpinFieldIssuesVis',\n            btnLabel: 'Show all field pushpins',\n            noPushpinLabel: 'No field issue in current doc',\n            hidePushpinLabel: 'Hide all field issues',\n            showPushpinLabel: 'Show all field issues',\n            pushpinNormalIcon: 'fieldissueicon-issue_normal',\n            pushpinHideIcon: 'fieldissueicon-issue_hide'\n        };\n\n        this.type = this.extension.pushPinManager.PushPinTypes.QUALITY_ISSUES;\n    }\n}\n","export default class PushPinMobileObserver {\n    constructor(pushpinExtension) {\n        this.pushpinExtension = pushpinExtension;\n\n        this.addListeners();\n    }\n\n    addListeners() {\n        if (!this.pushpinExtension) {\n            return;\n        }\n\n        this.pushpinExtension.addEventListener(Autodesk.BIM360.Extension.PushPin.PUSH_PIN_CREATED_EVENT, function (event) {\n            PushPinMobileObserver.postMessage('onPushPinCreated', event);\n        });\n\n        this.pushpinExtension.addEventListener(Autodesk.BIM360.Extension.PushPin.PUSH_PIN_PREPARING_THUMBNAIL , function (event) {\n            PushPinMobileObserver.postMessage('onPushPinPreparingThumbnail', event);\n        });\n\n        this.pushpinExtension.addEventListener(Autodesk.BIM360.Extension.PushPin.PUSH_PIN_CLICKED_EVENT, function (event) {\n            PushPinMobileObserver.postMessage('onPushPinActived', event);\n        });\n\n        this.pushpinExtension.addEventListener(Autodesk.BIM360.Extension.PushPin.PUSH_PIN_MODIFY_EVENT, function (event) {\n            PushPinMobileObserver.postMessage('onPushPinMoved', event);\n        });\n\n        this.pushpinExtension.addEventListener(Autodesk.BIM360.Extension.PushPin.PUSH_PIN_SELECT_NONE, function (event) {\n            PushPinMobileObserver.postMessage('onPushPinSelectNone', event);\n        });\n\n        this.pushpinExtension.addEventListener(Autodesk.BIM360.Extension.PushPin.PUSH_PIN_UPDATE_EVENT, function (event) {\n            PushPinMobileObserver.postMessage('onPushPinUpdated', event);\n        });\n\n        this.pushpinExtension.addEventListener(Autodesk.BIM360.Extension.PushPin.PUSH_PIN_ITEMS_LOADED, function (event) {\n            PushPinMobileObserver.postMessage('onPushPinItemsLoaded', event);\n        });\n\n        PushPinMobileObserver.postMessage('onPushPinToolLoaded', {});\n    }\n\n    static postMessage(messageName, event) {\n        const pushPinItem = event.value;\n        const thumbnail = event.thumbnail || '';\n\n        let metadata = {};\n\n        if (pushPinItem) {\n            metadata = {\n                id: pushPinItem.data.id,\n                label: pushPinItem.data.label,\n                status: pushPinItem.data.status,\n                position: {\n                    x: pushPinItem.data.position.x,\n                    y: pushPinItem.data.position.y,\n                    z: pushPinItem.data.position.z\n                },\n                type: pushPinItem.data.type,\n                objectId: pushPinItem.data.objectId,\n                externalId: pushPinItem.data.externalId,\n                viewerState: pushPinItem.data.viewerState,\n                attributesVersion: pushPinItem.data.attributesVersion,\n            };\n        }\n\n        if (window.webkit !== undefined) {\n            // New iOS SDK uses a standard callback method with the pattern of \"command\" and \"data\", just like MobileCallbacks.js\n            window.webkit.messageHandlers.callbackHandler.postMessage({ command: messageName, data: { metadata, thumbnail } });\n        } else if (window.JSINTERFACE) {\n            // Android\n            if (!pushPinItem) {\n                window.JSINTERFACE[messageName]();\n            } else {\n                window.JSINTERFACE[messageName](metadata.id, metadata.type, metadata.label, metadata.status,\n                    metadata.position.x, metadata.position.y, metadata.position.z, metadata.objectId,\n                    JSON.stringify(metadata.viewerState), metadata.externalId, metadata.attributesVersion, thumbnail);\n            }\n        }\n    }\n}\n","import { transformViewerState } from './PushPins3D/PushPinViewerState';\nimport { findMatchingModel } from './PushPinItem';\n\n// Helper function used for saving viewerStates in PushPin attributes:\n// For backward compatibility, the globalOffset of the viewerState is always equal to the center of the model bbox. Here 'model'\n// is the model that the issue has been created for.\n// This corresponds to the default globalOffset when using globalOffset=undefined and applyRefPoint=false in the model options.\n//  @param {av.Model} model for which the PushPin was created\nconst getLegacyGlobalOffset = model => {\n    // The goal here is to reproduce the default globalOffset that LMV would choose for the case\n    // globalOffset=undefined and applyRefPoint=false.\n    //\n    // It is essential NOT to use model.getBoundingBox(): Only the box in the metadata is unaffected by\n    // any lmv load-time transforms.\n    const boxData = model && model.myData.metadata['world bounding box'];\n    const pMin = boxData.minXYZ;\n    const pMax = boxData.maxXYZ;\n    return {\n        x: 0.5 * (pMin[0] + pMax[0]),\n        y: 0.5 * (pMin[1] + pMax[1]),\n        z: 0.5 * (pMin[2] + pMax[2])\n    };\n};\n\n// For legacy reasons, location and viewerState from issue-backend are stored in viewer-coordinates assuming that a single\n// model has been loaded with default load-options in LMV, i.e.,\n//  - Global offset is at the center of the model for which the issue was created.\n//  - No refPointTransform or custom transform/scaling was applied in loadOptions\n//\n// These conditions are true in single-model viewers like BIM360Docs Viewer,\n// but not in aggregated viewers like ModelCoordination and DesignCollaboration.\n// To make it for all viewers in the same way, we convert position and viewerState\n// in model-local coords - which are independent of load-time transforms.\n// \n// @param {Object} pushPinData - pushPin data with position and viewerState. Conversion works in-place.\nexport const legacyToLocalPushPinData = (pushPinData, viewer) => {\n\n    // Get globalOffset\n    let offset = pushPinData.viewerState.globalOffset;\n\n    // Legacy-fallback: (consider removal of this section in April 2020)\n    //   Older Issues may not have stored the globalOffset attribute, so some information is lost.\n    //   For these, we have to 'recover' it using some guesswork. To avoid regression, we assume here\n    //   that the issue has been created with the same globalOffset as it is viewed. The old code had\n    //   made this assumption implicitly too - so it will keep the scenarios working that had worked before.\n    if (!offset) {\n        // Note that consistent model placement requires globalOffset to be the same for all models.\n        // So, it's okay to just use viewer.model - even for aggregated views.\n        offset = viewer.model && viewer.model.myData.globalOffset;\n    }\n\n    // Convert position to model-local coords\n    if (offset) {\n        pushPinData.position.x += offset.x;\n        pushPinData.position.y += offset.y;\n        pushPinData.position.z += offset.z;\n    }\n\n    // Note: Unlike position, the viewerState (eye, target, up etc.) is already in model-local coordinates, so we don't need to add anything here.\n};\n\n// Converts PushPinData from local coordinates to legacy format - to ensure compatibility with issues that were saved before introducing model-local coordinates.\nconst localToLegacyPushPinData = (pushPinData, model) => {\n\n    // For backward compatibility, the globalOffset is always at the center of the model. (see getLegacyGlobalOffset for details)\n    pushPinData.viewerState.globalOffset = getLegacyGlobalOffset(model);\n\n    // For backward compatibility, the model-local coords are not stored directly in position. Instead the convention is\n    // model-local position is obtained by 'data.position + data.viewerState.globalOffset'. Therefore, we must subtract the globalOffset\n    // before saving.\n    pushPinData.position.x -= pushPinData.viewerState.globalOffset.x;\n    pushPinData.position.y -= pushPinData.viewerState.globalOffset.y;\n    pushPinData.position.z -= pushPinData.viewerState.globalOffset.z;\n};\n\nconst getModelLocalBox = (model) => {\n    const boxData = model && model.myData.metadata['world bounding box'];\n    let box = new THREE.Box3();\n    box.min.fromArray(boxData.minXYZ);\n    box.max.fromArray(boxData.maxXYZ);\n    return box;\n};\n\n// Heuristic to detect PushPins that were written while in DesignCollaboration before the positions were fixed.\n// For these, position and camera will be far outside the actual model and need some auto-correction to keep correct.\nconst isOldDCPushPin = (model, data) => {\n\n    // For new issues or old ones from Docs viewer, the pushpin position is given in model-local\n    // coords and is usually inside the model box.\n    // For old issues from Design Collaboration, the position will be far outside of the model-local box     \n    const localBox = getModelLocalBox(model);\n    const dist = localBox.distanceToPoint(data.position) * model.getUnitScale();\n    \n    // If the point is more than 100m outside, consider it as an old design collaboration issue.\n    // A valid issue should always be within the model box. The length of 100m is just some heuristic choice\n    // to identify \"clearly far outside\".\n    if (dist < 100) {\n        return false;\n    }\n    \n    // Verify that the fallback would actually provide a valid position: If the issue was actually written\n    // by design-collaboration before we fixed the positions, the position should be valid when interpreted \n    // as world coords.\n    const viewerBox = model.getBoundingBox();\n    const pWorld = new THREE.Vector3().copy(data.position).sub(data.viewerState.globalOffset);\n    return viewerBox.containsPoint(pWorld);\n};\n\nconst fixOldDCPushPin = (model, data) => {\n\n    // get matrix to convert position from world coords to model-local coords\n    const modelLocalToWorld = model.myData.placementTransform;\n    const worldToModelLocal = modelLocalToWorld && new THREE.Matrix4().getInverse(modelLocalToWorld);\n\n    // If there is a placement transform, transform pos and viewerState from world to model-local coords.\n    // If there is no placement transform, there is nothing todo.\n    if (modelLocalToWorld) {\n        // transform pos\n        data.position = new THREE.Vector3().copy(data.position).applyMatrix4(worldToModelLocal);\n\n        // transform viewer state\n        data.viewerState = JSON.parse(JSON.stringify(data.viewerState));\n        transformViewerState(data.viewerState, worldToModelLocal);\n    }\n};\n\n// Gets the in-memory reporesentation of a PushPinItem and returns the data in a way that is compatible with the \n// issues saved to issues-backend. For 2D, it is just the original PushPinData. For 3D, we have to apply some coordinate transforms.\nexport const getLegacyPushPinData = (pushPin, viewer) => {\n\n    // Check whether we are editing in 2D or 3D. Actually it would be safer to check this on the pushPin, \n    // but they don't contain any information about this.\n    const is3d = viewer.model && viewer.model.is3d();\n    if (!is3d) {\n        // For 2D, we are done here (no modifications needed).\n        return pushPin.data;\n    }\n\n    // Internally, PushPinItem stores positions in viewer-coords and viewer states in world-coords.\n    // Both depend on the model-load options used in the current viewer application, i.e., would not allow issues\n    // between different viewing applications.\n    //\n    // In the PushPinAttributes, we store everything in model-local coords. These coordinates are not affected by any load-time transform.\n    // Therefore, they are always the same for different LMV clients - no matter which loadOptions they are using. Also, it\n    // ensures that the issues automatically \"follows\" the model in case the refPointTransform changed.\n    let data = pushPin.getLocal(viewer);\n\n    // When using getLocal(), position and viewerState (eye, target, ..) are consistently given in model-local coords. In a perfect world, we were done now.\n    // But, for backwards compatibility with previously existing issues, we need some legacy conversions before storing the data.\n\n    // For backward compatibility, the globalOffset is always at the center of the model. (see getLegacyGlobalOffset for details)\n    const model = pushPin.findModel(viewer);\n    if (!model) {\n        console.error('Saving issue attributes failed: Issue must be assigned to a visible model.');\n        return pushPin.data;\n    }\n\n    // Convert from model-local coords to legacy PushPins: For backward compatility, they PushPin position must match with the viewer\n    // position when viewing a single model with default loadOptions (default globalOffset, no transforms).\n    localToLegacyPushPinData(data, model);\n\n    return data;\n};\n\n//\n// The purpose of this function is to avoid regressions for issues that have been created...\n//  - using Design Collaboration\n//  - written before we made the issue positions and viewerStates compatible with BIM360Docs viewer.\n//\n// For these issues, PushPin positions and viewerState will be world-coords. In the past, they had worked - but only under\n// the assumption that an issue is viewed under exactly the same conditions (globalOffset, model placement etc.) in which it was created.\n//\n// The heuristic in this section is making sure that this case keeps working - by converting position and viewerState to model-local coordinates.\n//\n// Note: This fallback is not needed for viewers that use LMV default loadOptions like BIM360Docs viewer.\n//\n// @param {Object} data - PushPinData. Same as in PushPinExtension.createItem(..). Will be modified in-place if needed.\n// @param {Viewer3D} viewer\nexport const applyLegacyFallback = (data, viewer) => {\n\n    // find model that the pushpin belongs to\n    const model = findMatchingModel(viewer, data.viewerState.seedUrn);\n    if (!model) {\n        return;\n    }\n    \n    // Apply fallback only if we know for sure that the PushPin position would be broken otherwise.\n    if (!isOldDCPushPin(model, data)) {\n        return;\n    }\n\n    // Transform position and viewerState\n    fixOldDCPushPin(model, data);\n};\n","import { PUSHPIN_EVENTS } from './PushPinEvents';\nimport PushPinManager from './PushPinManager';\nimport PushPinTool from './PushPinTools';\nimport IssuePushPinVisButton from './PushPinUi/IssuePushPinVisButton';\nimport RfiPushPinVisButton from './PushPinUi/RfiPushPinVisButton';\nimport QualityIssuePushPinVisButton from './PushPinUi/QualityIssuePushPinVisButton';\nimport PushPinMobileObserver from './PushPinObserver';\nimport { applyLegacyFallback, legacyToLocalPushPinData, getLegacyPushPinData } from './PushPinLegacyFallback';\n\nimport CSS from './PushPinExtension.css'; // REQUIRED!!\n\nconst namespace = AutodeskNamespace('Autodesk.BIM360.Extension.PushPin');\n\nexport default class PushPinExtension extends Autodesk.Viewing.Extension {\n    constructor(viewer, options = {}) {\n        super(viewer, options);\n        this.viewer = viewer;\n        this.options = options;\n    }\n\n    load() {\n        this.pushPinManager = new PushPinManager(this.viewer, this.options);\n\n        this.tool = new PushPinTool(this.viewer, this.pushPinManager, this.options);\n        this.pushpinsByType = this.pushPinManager.getInitialPushpinsByType();\n\n        if (Autodesk.Viewing.isMobileDevice()) {\n            this.observer = new PushPinMobileObserver(this);\n        }\n\n        if (this.viewer.toolController) {\n            this.viewer.toolController.registerTool(this.tool);\n            this.viewer.toolController.activateTool(this.tool.getName());\n\n            this.createUI();\n            return true;\n        }\n\n        return false;\n    }\n\n    unload() {\n        this.destroyUI();\n\n        if (this.pushPinManager) {\n            this.pushPinManager.selectNone();\n            this.pushPinManager.removeAllItems();\n            this.pushPinManager = null;\n        }\n\n        if (this.tool) {\n            this.viewer.toolController.deregisterTool(this.tool);\n            this.tool = null;\n        }\n\n        return true;\n    }\n\n    /**\n     * Public interfaces routing to tool for clients to call\n     */\n    startCreateItem(data) {\n        this.tool.startCreateItem(data);\n        this.updateButtonsStatus();\n    }\n\n    endCreateItem() {\n        this.tool.endCreateItem();\n        this.updateButtonsStatus();\n    }\n\n    showAll() {\n        for (var type in this.pushPinManager.PushPinTypes) {\n            this.showByType(this.pushPinManager.PushPinTypes[type]);\n        }\n    }\n\n    hideAll() {\n        for (var type in this.pushPinManager.PushPinTypes) {\n            this.hideByType(this.pushPinManager.PushPinTypes[type]);\n        }\n    }\n\n    enableItemSelect(enable) {\n        this.tool.enablePushPinSelect(enable);\n    }\n\n    updatePattern(id, size, res) {\n        this.tool.renderTool.updatePattern(id, size, res);\n    }\n\n    // public interfaces routing to push pin manager for clients to call\n    loadItems(pushPinDatas) {\n        this.tool.show(true);\n        this.pushPinManager.addItems(pushPinDatas);\n    }\n\n    loadItemFromLocal(pushPinData) {\n        this.pushPinManager.addItems([pushPinData], true, this.viewer);\n    }\n\n    updateItemById(id, data) {\n        return this.pushPinManager.updateItemById(id, data);\n    }\n\n    getItemById(id) {\n        const item = this.pushPinManager.getItemById(id);\n\n        if (item) {\n            return item.data;\n        }\n\n        return null;\n    }\n\n    setDraggableById(id, isDraggable, cancelPositionChange) {\n        const item = this.pushPinManager.getItemById(id);\n\n        if (item) {\n            if (cancelPositionChange) {\n                item.setPosition(this.origItemPosition);\n            }\n\n            item.draggable = isDraggable;\n            this.pushPinManager.fireEvent({ type: PUSHPIN_EVENTS.PUSH_PIN_UPDATE_EVENT, value: item });\n            this.origItemPosition = Object.assign({}, item.data.position);\n        }\n    }\n\n    setVisibleById(id, isVisible) {\n        const item = this.pushPinManager.getItemById(id);\n        if (item) {\n            item.visible = isVisible;\n            this.pushPinManager.fireEvent({ type: PUSHPIN_EVENTS.PUSH_PIN_UPDATE_EVENT, value: item });\n        }\n    }\n\n    selectOne(id) {\n        this.pushPinManager.selectOne(id);\n    }\n\n    selectNone() {\n        this.pushPinManager.selectNone();\n    }\n\n    removeItemById(id) {\n        const item = this.pushPinManager.getItemById(id);\n\n        if (!item) {\n            return;\n        }\n\n        this.pushPinManager.removeItemById(id);\n    }\n\n    removeItemsByType(type) {\n        this.pushPinManager.removeItemsByType(type);\n    }\n\n    removeAllItems() {\n        this.pushPinManager.removeAllItems();\n    }\n\n    addEventListener(event, func) {\n        this.pushPinManager.addEventListener(event, func);\n    }\n\n    removeEventListener(event, func) {\n        this.pushPinManager.removeEventListener(event, func);\n    }\n\n    hasEventListener(event, func) {\n        this.pushPinManager.hasEventListener(event, func);\n    }\n\n    createUI() {\n        this.uiButtons = [];\n\n        if (!this.options.hideIssuesButton) {\n            this.uiButtons.push(new IssuePushPinVisButton(this.viewer, this, this.options.initiallyHideIssuesPushpins));\n        }\n\n        if (!this.options.hideFieldIssuesButton) {\n            this.uiButtons.push(new QualityIssuePushPinVisButton(this.viewer, this, this.options.initiallyHideFieldIssuesPushpins));\n        }\n\n        if (!this.options.hideRfisButton) {\n            this.uiButtons.push(new RfiPushPinVisButton(this.viewer, this, this.options.initiallyHideRfisPushpins));\n        }\n\n        if (this.viewer.model) {\n            // If model is already loaded, then check.\n            this.uiButtons.forEach((uiButton) => {\n                uiButton.addButton();\n            });\n            return;\n        }\n\n        const self = this;\n\n        function enableVisButton() {\n            if (self.viewer.model) {\n                self.uiButtons.forEach((uiButton) => {\n                    uiButton.addButton();\n                });\n            }\n            self.viewer.removeEventListener(Autodesk.Viewing.MODEL_ROOT_LOADED_EVENT, enableVisButton);\n        }\n\n        // Otherwise, watch model loaded event.\n        this.viewer.addEventListener(Autodesk.Viewing.MODEL_ROOT_LOADED_EVENT, enableVisButton);\n    }\n\n    destroyUI() {\n        this.uiButtons.forEach((uiButton) => {\n            uiButton.destroyButton();\n        });\n    }\n\n    updateButtonsStatus() {\n        this.uiButtons.forEach((uiButton) => {\n            uiButton.updateButtonStatus();\n        });\n    }\n\n    hideByType(type) {\n        this.pushPinManager && this.pushPinManager.setVisibleByType(type, false);\n    }\n\n    showByType(type) {\n        this.pushPinManager && this.pushPinManager.setVisibleByType(type, true);\n    }\n\n    // Convert legacy 3D pushPinData in-place to make sure that positions and viewerState are consistently in model-local coords.\n    legacyToLocalPushPinData(pushPinData) {\n\n        legacyToLocalPushPinData(pushPinData, this.viewer);\n\n        // Usually, this will be a no-op. It will just detect and auto-repair some previously saved\n        // PushPins that would be broken otherwise.\n        if (this.options.useLegacyFallback) {\n            applyLegacyFallback(pushPinData, this.viewer);\n        }\n    }\n\n    // Takes a PushPinItem and returns its PushPinData - transformed in a way that it is compatible with the PushPins as stored in issues-backend. For this, pushPin position\n    // must match with viewer coordinates when using a single model with default loadOptions (default globalOffset and no transforms).\n    getLegacyPushPinData(pushPin) {\n        return getLegacyPushPinData(pushPin, this.viewer);\n    }\n}\n\nnamespace.PUSH_PIN_EXT_NAME = 'Autodesk.BIM360.Extension.PushPin';\nObject.assign(namespace, PUSHPIN_EVENTS);\nAutodesk.Viewing.theExtensionManager.registerExtension(namespace.PUSH_PIN_EXT_NAME, PushPinExtension);\n"],"sourceRoot":""}