/*!
 * LMV v7.1.1
 * 
 * Copyright 2019 Autodesk, Inc.
 * All rights reserved.
 * 
 * This computer source code and related instructions and comments are the
 * unpublished confidential and proprietary information of Autodesk, Inc.
 * and are protected under Federal copyright and state trade secret law.
 * They may not be disclosed to, copied or used by any third party without
 * the prior written consent of Autodesk, Inc.
 * 
 * Autodesk Forge Viewer Usage Limitations:
 * 
 * The Autodesk Forge viewer can only be used to view files generated by
 * Autodesk Forge services. The Autodesk Forge Viewer JavaScript must be
 * delivered from an Autodesk hosted URL.
 */
Autodesk.Extensions.OMV=function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=371)}({170:function(e){e.exports={"@@locale":"en","@@context":"On-Machine Verification extension","On-Machine Verification":"On-Machine Verification",Probing:"Probing","Inspection Points":"Inspection Points","Confetti diameter":"Confetti diameter"}},171:function(e){e.exports={"@@locale":"cs","@@context":"Rozšíření ověření na stroji","On-Machine Verification":"Ověření na stroji",Probing:"Sondování","Inspection Points":"Kontrolní body","Confetti diameter":"Průměr konfety"}},172:function(e){e.exports={"@@locale":"de","@@context":"Prüfungen an der Maschine selbst Extension","On-Machine Verification":"Prüfungen an der Maschine",Probing:"Antasten","Inspection Points":"Inspektionspunkte","Confetti diameter":"Durchmesser Konfetti"}},173:function(e){e.exports={"@@locale":"es","@@context":"Ampliación de la verificación en la máquina","On-Machine Verification":"Verificación en la máquina",Probing:"Sondeo","Inspection Points":"Puntos de inspección","Confetti diameter":"Diámetro de confeti"}},174:function(e){e.exports={"@@locale":"fr","@@context":"Extension de vérification sur la machine","On-Machine Verification":"Vérification sur la machine",Probing:"Palpage","Inspection Points":"Points d'inspection","Confetti diameter":"Diamètre des confettis"}},175:function(e){e.exports={"@@locale":"fr-CA","@@context":"Extension de vérification sur la machine","On-Machine Verification":"Vérification sur la machine",Probing:"Palpage","Inspection Points":"Points d'inspection","Confetti diameter":"Diamètre des confettis"}},176:function(e){e.exports={"@@locale":"it","@@context":"Estensione verifica sulla macchina","On-Machine Verification":"Verifica sulla macchina",Probing:"Sonda","Inspection Points":"Punti di ispezione","Confetti diameter":"Diametro ravvicinati"}},177:function(e){e.exports={"@@locale":"ja","@@context":"機上検証エクステンション","On-Machine Verification":"機上検証",Probing:"検出中","Inspection Points":"検査点","Confetti diameter":"紙吹雪の直径"}},178:function(e){e.exports={"@@locale":"ko","@@context":"켜기-기계 검증 확장","On-Machine Verification":"켜기-기계 검증",Probing:"프로브","Inspection Points":"검사 점","Confetti diameter":"색종이 지름"}},179:function(e){e.exports={"@@locale":"pl","@@context":"Rozszerzenie On-Machine Verification","On-Machine Verification":"On-Machine Verification",Probing:"Sondowanie","Inspection Points":"Punkty kontrolne","Confetti diameter":"Średnica confetti"}},180:function(e){e.exports={"@@locale":"pt","@@context":"Extensão Verificação na máquina","On-Machine Verification":"Verificação na máquina",Probing:"Sondagem","Inspection Points":"Pontos de inspeção","Confetti diameter":"Diâmetro do confete"}},181:function(e){e.exports={"@@locale":"ru","@@context":"Расширение «Контроль на станке»","On-Machine Verification":"Контроль на станке",Probing:"Измерение щупом","Inspection Points":"Контрольные точки","Confetti diameter":"Диаметр конфетти"}},182:function(e){e.exports={"@@locale":"tr","@@context":"Makine Üzerinde Doğrulama uzantısı","On-Machine Verification":"Makine Üzerinde Doğrulama",Probing:"Problama","Inspection Points":"Denetim Noktaları","Confetti diameter":"Konfeti çapı"}},183:function(e){e.exports={"@@locale":"zh-Hans","@@context":"计算机验证扩展","On-Machine Verification":"计算机验证",Probing:"正在探测","Inspection Points":"检验点","Confetti diameter":"彩色纸屑直径"}},184:function(e){e.exports={"@@locale":"zh-Hant","@@context":"在機驗證延伸","On-Machine Verification":"在機驗證",Probing:"正在探測","Inspection Points":"檢測點","Confetti diameter":"五色點直徑"}},185:function(e){e.exports={"@@locale":"nl","@@context":"Extensie voor verificatie op machine","On-Machine Verification":"Verificatie op machine",Probing:"Zoeken","Inspection Points":"Inspectiepunten","Confetti diameter":"Confettidiameter"}},186:function(e){e.exports={"@@locale":"sv","@@context":"On-Machine Verification-tillägg","On-Machine Verification":"On-Machine Verification",Probing:"Sondering","Inspection Points":"Inspektionspunkter","Confetti diameter":"Konfettidiameter"}},187:function(e){e.exports={"@@locale":"da","@@context":"Udvidelse af verificering på maskine","On-Machine Verification":"Verificering på maskine",Probing:"Tester","Inspection Points":"Inspektionpunkter","Confetti diameter":"Confetti-diameter"}},371:function(e,t,i){"use strict";i.r(t);function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o="configTab",r=function(e,t,i){var n="adsk_omv_panel_"+e.id;Autodesk.Viewing.UI.SettingsPanel.call(this,e.container,n,i,{heightAdjustment:90}),this.container.classList.add("viewer-settings-panel"),this.viewer=e,this.confettiController=t,this._onSetConfettiDiameter=this._onSetConfettiDiameter.bind(this),this.addTab(o,"Probing",{className:"config"}),this.selectTab(o),this.inspectionSettingsLabel=this.addLabel(o,"Inspection Points"),this.sliderId=this.addSlider(o,"Confetti diameter",.5,40,1,this._onSetConfettiDiameter),this.confettiSizeSlider=this.getControl(this.sliderId),this.confettiSizeSlider.sliderElement.step=this.confettiSizeSlider.stepperElement.step=.1,this.createFooter()};(r.prototype=Object.create(Autodesk.Viewing.UI.SettingsPanel.prototype)).constructor=r,r.prototype.syncUI=function(){this.confettiSizeSlider.setValue(this.confettiController.diameter)},r.prototype._onSetConfettiDiameter=function(e){var t=null,i=n(e);"object"===i&&e.detail&&e.detail.value?t=parseFloat(e.detail.value):"number"===i&&(t=e),t&&this.confettiController.resizeConfetti(t)};var a={en:i(170),cs:i(171),de:i(172),es:i(173),fr:i(174),"fr-CA":i(175),it:i(176),ja:i(177),ko:i(178),pl:i(179),"pt-BR":i(180),ru:i(181),tr:i(182),"zh-HANS":i(183),"zh-HANT":i(184),nl:i(185),sv:i(186),da:i(187)};i.d(t,"OMV",function(){return s});function s(e,t){Autodesk.Viewing.Extension.call(this,e,t),this._configButtonId=null,this._default_geom_diameter=void 0,this._panel=null,this.confettiController=null,this.hasUI=Autodesk.Viewing.GuiViewer3D&&e instanceof Autodesk.Viewing.GuiViewer3D,this.openPanel=this.openPanel.bind(this),this._initialiseConfetti=this._initialiseConfetti.bind(this),this._initButtonConfig=this._initButtonConfig.bind(this)}s.prototype=Object.create(Autodesk.Viewing.Extension.prototype),s.prototype.constructor=s,s.prototype.load=function(){return!!this.hasUI&&(this.extendLocalization(a),this.viewer.model&&this.viewer.model.isLoadDone()?this._initialiseConfetti():this.viewer.addEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,this._initialiseConfetti,{once:!0}),!0)},s.prototype.unload=function(){return this.viewer.removeEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,this._initialiseConfetti),null!==this._configButtonId&&(this.viewer.viewerSettingsPanel.removeConfigButton(this._configButtonId),this._configButtonId=null),this._panel&&(this._panel.uninitialize(),this._panel=null),this.confettiController=null,!0},s.prototype._initialiseConfetti=function(){var e=this;this.confettiController=new function(e){var t=this;function i(e){var i=t.viewer.model.getFragmentList().getGeometry(e).vb,o=n(e),r=new THREE.Vector3(i[3],i[4],i[5]),a=2*o.distanceTo(r);return parseFloat(a.toFixed(1))}function n(e){var i=t.viewer.model.getFragmentList().getGeometry(e).vb;return new THREE.Vector3(i[0],i[1],i[2])}function o(e,o){var r=t.viewer,a=r.impl.getFragmentProxy(r.model,e);a.getAnimTransform();var s=o/i(e),c=new THREE.Matrix4;a.getOriginalWorldMatrix(c),c.getInverse(c);var f=n(e);a.scale=new THREE.Vector3(s,s,s),a.position.x=c.elements[12]*(s-1)-f.x*(s-1),a.position.y=c.elements[13]*(s-1)-f.y*(s-1),a.position.z=c.elements[14]*(s-1)-f.z*(s-1),a.updateAnimTransform()}this.viewer=e,this.diameter=null,this.resizeConfetti=function(e){if(e!==this.diameter){var t=this.viewer,i=t.model.getData().instanceTree;this.diameter=e,this.findMeasuredPoints(function(n){for(var r=0;r<n.length;r++)i.enumNodeFragments(n[r],function(i){o(i,e),r===n.length-1&&t.impl.sceneUpdated(!0)},!1)})}},this.getDiameterFromGeom=function(e){var t=this.viewer,n=t.model.getData().instanceTree;t.model.isLoadDone(),this.findMeasuredPoints(function(t){n.enumNodeFragments(t[0],function(t){var n=i(t);e(n)},!1)})},this.findMeasuredPoints=function(e){var t=this.viewer;this.findInspectionPoints(function(i){var n={propFilter:["Surface Inspection Point"],ignoreHidden:!1};t.model.getBulkProperties(i,n,function(t){var i=t.filter(function(e){return"projected"===function(e,t){for(var i=0;i<e.length;++i){var n=e[i];if(n.displayName===t)return n.displayValue}return null}(e.properties,"Surface Inspection Point")});e(i)})})},this.findInspectionPoints=function(e){this.viewer.model.findProperty("Surface Inspection Point").then(function(t){e(t)})}}(this.viewer),this.confettiController.getDiameterFromGeom(function(t){e.viewer&&(e._default_geom_diameter=t,e.setConfettiDiameter(t),e._initButtonConfig())})},s.prototype.setConfettiDiameter=function(e){return void 0===e&&(e=this._default_geom_diameter),void 0!==e&&(this.confettiController.resizeConfetti(e),this._panel&&this._panel.syncUI(),!0)},s.prototype.openPanel=function(){this._panel||(this._panel=new r(this.viewer,this.confettiController,"On-Machine Verification")),this._panel.setVisible(!0)},s.prototype._initButtonConfig=function(){var e=this.viewer.getSettingsPanel();e?this._configButtonId=e.addConfigButton("On-Machine Verification",this.openPanel):this.addEventListener(av.TOOLBAR_CREATED_EVENT,this._initButtonConfig,{once:!0})},Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.OMV",s)}});
//# sourceMappingURL=OMV.min.js.map